<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.23">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jihong Zhang">
<meta name="dcterms.date" content="2023-06-20">
<title>Jihong Z. - Play Harder and Learn Harder – A Conversation between R and Python on Data Analysis and Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-149871707-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><script src="../../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="../../site_libs/vega-5.22.0/vega@5.22.0.min.js"></script><script src="../../site_libs/vega-lite-5.5.0/vega-lite@5.5.0.min.js"></script><link href="../../site_libs/vega-embed-6.20.8/vega-embed.css" rel="stylesheet">
<script src="../../site_libs/vega-embed-6.20.8/vega-embed@6.20.8.min.js"></script><script src="../../site_libs/vegawidget-vl5-binding-0.4.3/vegawidget-vl5.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/key-buttons.min.js" defer=""></script><link href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/key-buttons.min.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="../../assets/rwds.css">
<meta property="og:title" content="Jihong Z. - Play Harder and Learn Harder - A Conversation between R and Python on Data Analysis and Machine Learning">
<meta property="og:description" content="Technical and Statistical but Fun">
<meta property="og:site_name" content="Jihong Z. - Play Harder and Learn Harder">
<meta name="twitter:title" content="Jihong Z. - Play Harder and Learn Harder - A Conversation between R and Python on Data Analysis and Machine Learning">
<meta name="twitter:description" content="Technical and Statistical but Fun">
<meta name="twitter:creator" content="@jihongzgamma">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><span class="icon-line"></span>JZ<span class="icon-line"></span></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> <i class="bi bi-bi bi-house" role="img">
</i> 
<span class="menu-text"><span class="menutext-home">Home</span><span class="text-line"></span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> <i class="bi bi-bi bi-pencil-square" role="img">
</i> 
<span class="menu-text"><span class="menutext-blog">Blog</span><span class="text-line-blog"></span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../dashboards/template.html"> <i class="bi bi-bi bi-speedometer2" role="img">
</i> 
<span class="menu-text"><span class="menutext-db">Dashboard</span><span class="text-line-db"></span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../uploads/Curriculum_Vitae.pdf"> <i class="bi bi-bi bi-person" role="img">
</i> 
<span class="menu-text"><span class="menutext-cv">C.V.</span><span class="text-line-cv"></span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> <i class="bi bi-bi bi-three-dots" role="img">
</i> 
<span class="menu-text"><span class="menutext-pj">Projects</span><span class="text-line-pj"></span></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">A Conversation between R and Python on Data Analysis and Machine Learning</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/jihonglogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">ESRM6553-Adv.Multivariate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture01/Lecture01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture02/Lecture02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture03/Lecture03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture04/Lecture04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture05/Lecture05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture06/Lecture06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 06</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#pytorch-tensor" id="toc-pytorch-tensor" class="nav-link active" data-scroll-target="#pytorch-tensor"><span class="header-section-number">1</span> PyTorch Tensor</a>
  <ul class="collapse">
<li><a href="#arithmetic-operations" id="toc-arithmetic-operations" class="nav-link" data-scroll-target="#arithmetic-operations"><span class="header-section-number">1.1</span> Arithmetic operations</a></li>
  <li><a href="#more-examples-of-the-matrix-operations" id="toc-more-examples-of-the-matrix-operations" class="nav-link" data-scroll-target="#more-examples-of-the-matrix-operations"><span class="header-section-number">1.2</span> More examples of the matrix operations:</a></li>
  <li><a href="#listwise-computation" id="toc-listwise-computation" class="nav-link" data-scroll-target="#listwise-computation"><span class="header-section-number">1.3</span> listwise computation</a></li>
  </ul>
</li>
  <li><a href="#import-tensor-to-r" id="toc-import-tensor-to-r" class="nav-link" data-scroll-target="#import-tensor-to-r"><span class="header-section-number">2</span> Import tensor to R</a></li>
  <li><a href="#mixture-of-r-and-python-visualization" id="toc-mixture-of-r-and-python-visualization" class="nav-link" data-scroll-target="#mixture-of-r-and-python-visualization"><span class="header-section-number">3</span> Mixture of R and Python: visualization</a></li>
  <li><a href="#pure-r-torch-for-r" id="toc-pure-r-torch-for-r" class="nav-link" data-scroll-target="#pure-r-torch-for-r"><span class="header-section-number">4</span> Pure R: torch for R</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">A Conversation between R and Python on Data Analysis and Machine Learning</h1>
  <div class="quarto-categories">
    <div class="quarto-category">blog</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">PyTorch</div>
    <div class="quarto-category">Deep Learning</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jihong Zhang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header><blockquote class="blockquote">
<p>When I play with machine learning using python and R, I keep wondering whether I can combine R and Python code in a better way, such as using R for data cleaning/visualization and Python for machine learning. Online resources for PyTorch are basically written using python code. However, I always struggle with pandas and numpy but prefer tidyverse for data cleaning, and data manipulation. That’s why I write this blog. I will start with the Pytorch tensor manipulation and import Pytorch tensor into R, then talk about mixing R/python data analysis with R/python visualization.</p>
</blockquote>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="reticulated_python.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="reticulate package logo"><img src="reticulated_python.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="reticulate package logo"></a></p>
</figure>
</div>
<figcaption class="margin-caption">reticulate package logo</figcaption></figure>
</div>
<section id="pytorch-tensor" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="pytorch-tensor">
<span class="header-section-number">1</span> PyTorch Tensor</h2>
<p>Let’s first get familiar with data manipulation using <em>PyTorch</em>. First, <code>torch.zeors(R, C)</code> function can create a zero tensor with the size of R by C.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a><span class="in">```{python, echo = "fenced"}</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="in">import torch</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="in">z = torch.zeros(5, 3)</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="in">print(z)</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[0., 0., 0.],
&gt;&gt;         [0., 0., 0.],
&gt;&gt;         [0., 0., 0.],
&gt;&gt;         [0., 0., 0.],
&gt;&gt;         [0., 0., 0.]])</code></pre>
</div>
</div>
<p>Similarly, <code>torch.ones(R, C)</code> creates a tensor filled with ones with the size of R by C with <code>dtype=torch.int16</code> argument can coverting elements into integer.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1"></a><span class="in">```{python}</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="in">i = torch.ones((5,3), dtype=torch.int16)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="in">print(i)</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[1, 1, 1],
&gt;&gt;         [1, 1, 1],
&gt;&gt;         [1, 1, 1],
&gt;&gt;         [1, 1, 1],
&gt;&gt;         [1, 1, 1]], dtype=torch.int16)</code></pre>
</div>
</div>
<p>We can generate random numbers to tensor using <code>torch.rand(R, C)</code>. It’s recommended to set up a random seed using <code>torch.manual_seed(seed_num)</code> to make sure we can replicate our random tensor.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1"></a><span class="in">```{python}</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="in">torch.manual_seed(1729)</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="in">r1 = torch.rand(2, 2)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="in">print(f'A random tensor:\n {r1}')</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; &lt;torch._C.Generator object at 0x10b69d210&gt;
&gt;&gt; A random tensor:
&gt;&gt;  tensor([[0.3126, 0.3791],
&gt;&gt;         [0.3087, 0.0736]])</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1"></a><span class="in">```{python}</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="in">b = torch.arange(4 * 5 * 6).view(4, 5, 6)</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="in">print(f"A sequence of number arraged to 4 matrix of the size 5 X 6: \n{b}\n" )</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; A sequence of number arraged to 4 matrix of the size 5 X 6: 
&gt;&gt; tensor([[[  0,   1,   2,   3,   4,   5],
&gt;&gt;          [  6,   7,   8,   9,  10,  11],
&gt;&gt;          [ 12,  13,  14,  15,  16,  17],
&gt;&gt;          [ 18,  19,  20,  21,  22,  23],
&gt;&gt;          [ 24,  25,  26,  27,  28,  29]],
&gt;&gt; 
&gt;&gt;         [[ 30,  31,  32,  33,  34,  35],
&gt;&gt;          [ 36,  37,  38,  39,  40,  41],
&gt;&gt;          [ 42,  43,  44,  45,  46,  47],
&gt;&gt;          [ 48,  49,  50,  51,  52,  53],
&gt;&gt;          [ 54,  55,  56,  57,  58,  59]],
&gt;&gt; 
&gt;&gt;         [[ 60,  61,  62,  63,  64,  65],
&gt;&gt;          [ 66,  67,  68,  69,  70,  71],
&gt;&gt;          [ 72,  73,  74,  75,  76,  77],
&gt;&gt;          [ 78,  79,  80,  81,  82,  83],
&gt;&gt;          [ 84,  85,  86,  87,  88,  89]],
&gt;&gt; 
&gt;&gt;         [[ 90,  91,  92,  93,  94,  95],
&gt;&gt;          [ 96,  97,  98,  99, 100, 101],
&gt;&gt;          [102, 103, 104, 105, 106, 107],
&gt;&gt;          [108, 109, 110, 111, 112, 113],
&gt;&gt;          [114, 115, 116, 117, 118, 119]]])</code></pre>
</div>
</div>
<section id="arithmetic-operations" class="level3" data-number="1.1"><h3 data-number="1.1" class="anchored" data-anchor-id="arithmetic-operations">
<span class="header-section-number">1.1</span> Arithmetic operations</h3>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1"></a><span class="in">```{python}</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="in">ones = torch.ones(2, 3)</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="in">print(f"First tensor: \n{ones}\n")</span></span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="in">twos = torch.ones(2, 3) * 2 # multiple each element by 2</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="in">print(f"Second tensor: \n{twos}\n")</span></span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="in">threes = ones + twos # addition allowed when shapes of two tensors are similar</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="in">print(f"Third tensor: \n{threes}\n")</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; First tensor: 
&gt;&gt; tensor([[1., 1., 1.],
&gt;&gt;         [1., 1., 1.]])
&gt;&gt; 
&gt;&gt; Second tensor: 
&gt;&gt; tensor([[2., 2., 2.],
&gt;&gt;         [2., 2., 2.]])
&gt;&gt; 
&gt;&gt; Third tensor: 
&gt;&gt; tensor([[3., 3., 3.],
&gt;&gt;         [3., 3., 3.]])</code></pre>
</div>
</div>
</section><section id="more-examples-of-the-matrix-operations" class="level3" data-number="1.2"><h3 data-number="1.2" class="anchored" data-anchor-id="more-examples-of-the-matrix-operations">
<span class="header-section-number">1.2</span> More examples of the matrix operations:</h3>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1"></a><span class="in">```{python}</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="in">torch.manual_seed(1729)</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="in">a = (torch.rand(2, 2) - 0.5) * 2</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="in">print(f'A random matrix: \n{a}\n')</span></span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="in">a_abs = torch.abs(a) # Absolute values for elements</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="in">print(f'A absolute matrix: \n{a_abs}\n')</span></span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="in">a_asin = torch.asin(a) # trigonometric functions</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="in">print(f'Inverse sine of r: \n{a_asin}\n')</span></span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="in">a_det = torch.det(a) # Determinant and singular value decomposition</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="in">print(f'Determinant of r: \n{a_det}\n')</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="in">a_svd = torch.svd(a) </span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="in">print(f'Singlular value decomposition of r: \n{a_svd}\n')</span></span>
<span id="cb11-16"><a href="#cb11-16"></a></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="in">a_std_mean = torch.std_mean(a) # Statistical and aggregate operations:</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="in">print(f'Average and standard deviation of r: \n{a_std_mean}\n')</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="in">a_max = torch.max(a)</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="in">print(f'Maximum value of r: \n{a_max}\n')</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; &lt;torch._C.Generator object at 0x10b69d210&gt;
&gt;&gt; A random matrix: 
&gt;&gt; tensor([[-0.3748, -0.2418],
&gt;&gt;         [-0.3827, -0.8528]])
&gt;&gt; 
&gt;&gt; A absolute matrix: 
&gt;&gt; tensor([[0.3748, 0.2418],
&gt;&gt;         [0.3827, 0.8528]])
&gt;&gt; 
&gt;&gt; Inverse sine of r: 
&gt;&gt; tensor([[-0.3842, -0.2442],
&gt;&gt;         [-0.3927, -1.0214]])
&gt;&gt; 
&gt;&gt; Determinant of r: 
&gt;&gt; 0.22711339592933655
&gt;&gt; 
&gt;&gt; Singlular value decomposition of r: 
&gt;&gt; torch.return_types.svd(
&gt;&gt; U=tensor([[-0.3909, -0.9204],
&gt;&gt;         [-0.9204,  0.3909]]),
&gt;&gt; S=tensor([1.0111, 0.2246]),
&gt;&gt; V=tensor([[ 0.4933,  0.8699],
&gt;&gt;         [ 0.8699, -0.4933]]))
&gt;&gt; 
&gt;&gt; Average and standard deviation of r: 
&gt;&gt; (tensor(0.2678), tensor(-0.4630))
&gt;&gt; 
&gt;&gt; Maximum value of r: 
&gt;&gt; -0.24180912971496582</code></pre>
</div>
</div>
</section><section id="listwise-computation" class="level3" data-number="1.3"><h3 data-number="1.3" class="anchored" data-anchor-id="listwise-computation">
<span class="header-section-number">1.3</span> listwise computation</h3>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1"></a><span class="in">```{python}</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="in">a_totalSum = torch.sum(a)</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="in">print(f'global sum of r: \n{a_totalSum}\n')</span></span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="in">a_rowSum = torch.sum(a, dim=1, keepdim=True)</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="in">print(f'row sums of r: \n{a_rowSum}\n')</span></span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="in">a_colSum = torch.sum(a, dim=0, keepdim=True)</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="in">print(f'column sums of r: \n{a_colSum}\n')</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; global sum of r: 
&gt;&gt; -1.852110505104065
&gt;&gt; 
&gt;&gt; row sums of r: 
&gt;&gt; tensor([[-0.6166],
&gt;&gt;         [-1.2355]])
&gt;&gt; 
&gt;&gt; column sums of r: 
&gt;&gt; tensor([[-0.7575, -1.0946]])</code></pre>
</div>
</div>
</section></section><section id="import-tensor-to-r" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="import-tensor-to-r">
<span class="header-section-number">2</span> Import tensor to R</h2>
<p>If you install <code>torch</code> package in R. You probably found that Pytorch’s tensor object can be called directly in R as <code>torch.Tensor</code>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1"></a><span class="in">```{r}</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="in">a_inR = py$a</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="in">class(a_inR)</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; [1] "torch.Tensor"          "torch._C.TensorBase"   "python.builtin.object"</code></pre>
</div>
</div>
<p>Unfortunately, it does not allow you to manipulate this tensor object directly using R function. For example, if you do matrix operation, it will pop up error message.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="in">a_inR * 2</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in a_inR * 2: non-numeric argument to binary operator</code></pre>
</div>
</div>
<p>However, you can use python method in R style (change <code>.</code> to <code>$</code>) as long as you load <code>reticulate</code> package. Like:</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="in">a_inR$shape</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="in">a_inR$data</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; torch.Size([2, 2])
&gt;&gt; tensor([[-0.3748, -0.2418],
&gt;&gt;         [-0.3827, -0.8528]])</code></pre>
</div>
</div>
<p>Can we import PyTorch tensor to R and employ R to do some dirty works, and then export it back to python? The answer is Yes (partially). We can try out this workflow: tensor -&gt; np.ndarray -&gt; R matrix -&gt; …(some manipulation) -&gt; np.ndarray -&gt; tensor (see diagram below). I’m not sure if it is worthy nor it is even plausible for more complicated tensor class. Note that it may make the memory stores at least three copies of the data. More experiments needed for such work. For more information about arrays in R and python, please refer to the <a href="https://rstudio.github.io/reticulate/articles/arrays.html">reticulate manual</a>.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR;
    tensor--&gt;|np$array|np.ndarray;
    np.ndarray--&gt;|py_to_r|R.matrix;
    R.matrix --&gt;|some data manipulation|R.matrix;
    R.matrix--&gt;|r_to_py|np.ndarray;
    np.ndarray--&gt;|torch$from_numpy|tensor;
</pre>
</div>
<p></p>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1"></a><span class="in">```{r}</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="in">np &lt;- import("numpy", convert=FALSE)</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="in">a_data_inR = py_to_r(np$array(a_inR$data))</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="in">a_data_inR_revised = a_data_inR * 2</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="in">a_inR # original python object in R</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="in">a_data_inR_revised # revised matrix in R</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[-0.3748, -0.2418],
&gt;&gt;         [-0.3827, -0.8528]])
&gt;&gt;            [,1]       [,2]
&gt;&gt; [1,] -0.7496002 -0.4836183
&gt;&gt; [2,] -0.7653229 -1.7056797</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="in">torch &lt;- import("torch", convert=FALSE)</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="in">a_inR$data = torch$from_numpy(a_data_inR_revised)</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="in">a_inR</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[-0.7496, -0.4836],
&gt;&gt;         [-0.7653, -1.7057]], dtype=torch.float64)</code></pre>
</div>
</div>
</section><section id="mixture-of-r-and-python-visualization" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="mixture-of-r-and-python-visualization">
<span class="header-section-number">3</span> Mixture of R and Python: visualization</h2>
<p>As mentioned above, the <code>reticulate</code> R package provides an R interface to Python modules, classes, and functions, which allows us to extend our graphical toolbox to all packages/modules of R and Python. Currently, we can use three methods of data visualization via mixing R code and Python code:</p>
<ul>
<li>R data + Python <code>matlibplot</code> module</li>
<li>Python data + Python <code>Vega-Altair</code> module + R output</li>
<li>Python data + R <code>ggplot2</code> package</li>
</ul>
<p>Let’s try them out one by one. First, take <code>iris</code> data in R for example:</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1"></a><span class="in">```{r}</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="in">library(tidyverse)</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="in">library(kableExtra)</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="in">iris_dat = iris[1:3]</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="in">iris_mat = matrix(unlist(iris_dat), nrow = nrow(iris), ncol = ncol(iris_dat))</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="in">dim(iris_mat)</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; [1] 150   3</code></pre>
</div>
</div>
<p>The column sums of iris are <code>c(876.5, 458.6, 564.7)</code> and the row sums of first 5 rows of iris are <code>c(10, 9.3, 9.2, 9.2, 10)</code>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1"></a><span class="in">```{r}</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="in">glue::glue('Columns Sums: {colSums(iris_mat)}')</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="in">glue::glue('Row Sums: {rowSums(iris_mat[1:5, ])}')</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; Columns Sums: 876.5
&gt;&gt; Columns Sums: 458.6
&gt;&gt; Columns Sums: 563.7
&gt;&gt; Row Sums: 10
&gt;&gt; Row Sums: 9.3
&gt;&gt; Row Sums: 9.2
&gt;&gt; Row Sums: 9.2
&gt;&gt; Row Sums: 10</code></pre>
</div>
</div>
<p>In Python chunk code of Rmarkdown, we can call data in R using <code>r.{dataname}</code>, in which <code>{dataname}</code> is the object name in R. Note that do not define <code>r</code> in python, otherwise <code>r</code> not longer become the R environment. Now we can load the R data frame in python. Please check <a href="https://rstudio.github.io/reticulate/">reticulate package</a> for more information about the rules of conversation between R and Python.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1"></a><span class="in">```{python}</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="in">import torch</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="in">import numpy as np</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="in">iris_ndarray = np.array(r.iris_mat)</span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="in">iris_tensor = torch.from_numpy(iris_ndarray)</span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="in">torch.sum(iris_tensor, dim=0, keepdim=True)</span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="in">torch.sum(iris_tensor[:5,], dim=1, keepdim=True)</span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[876.5000, 458.6000, 563.7000]], dtype=torch.float64)
&gt;&gt; tensor([[10.0000],
&gt;&gt;         [ 9.3000],
&gt;&gt;         [ 9.2000],
&gt;&gt;         [ 9.2000],
&gt;&gt;         [10.0000]], dtype=torch.float64)</code></pre>
</div>
</div>
<p>In Edgar Anderson’s <code>Iris</code> data, we can model a prediction model given the measurements in centimeters of sepal length/width, petal length/width and the three types of species: Iris <mark style="background-color:lightblue">setosa</mark>, <mark style="background-color:lightblue">versicolor</mark>, and <mark style="background-color:lightblue">virginica</mark>. Each type contains 50 samples. The very first question is then “can we train a machine learning algorithm to predict whether one belongs to Setosa/Versicolor/Virginica given four characteristics?” We can fit a multinomial regression to test statistical hypotheses of the characteristics’ differences among three species:</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1"></a><span class="in">```{r}</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="in">#| label: tbl-coef</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="in">#| tbl-cap: Coefficients of multinominal logistic regression</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="in">library(nnet)</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="in">library(MASS)</span></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="in">library(broom)</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="in">library(kableExtra)</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="in">iris_new = iris |&gt; </span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="in">  mutate(Species = relevel(Species, "virginica"))</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="in">## A multinominal logistic regression with Species-setosa as reference group</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="in">capture.output(multinomial_fit &lt;- nnet::multinom(Species ~ . + 0, data = iris_new, </span></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="in">                                                 model = TRUE),file ="/dev/null")</span></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="in">## Print the coefficient table</span></span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="in">kbl(tidy(multinomial_fit, exponentiate = FALSE), digits = 2, </span></span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="in">    booktabs = TRUE, align = "c",</span></span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="in">    col.names = c("DV", "IV", "b(logit)", "SE", "t.value", "p.value")) |&gt;</span></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="in">  kable_styling(bootstrap_options = c("condensed", "hover"), html_font = "Maven Pro")</span></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-coef" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-coef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Coefficients of multinominal logistic regression
</figcaption><div aria-describedby="tbl-coef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<table class="table table-condensed table-hover do-not-create-environment cell table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">DV</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">IV</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">b(logit)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t.value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Sepal.Length</td>
<td style="text-align: center;">8.11</td>
<td style="text-align: center;">106.99</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.94</td>
</tr>
<tr class="even">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Sepal.Width</td>
<td style="text-align: center;">13.13</td>
<td style="text-align: center;">157.28</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.93</td>
</tr>
<tr class="odd">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Petal.Length</td>
<td style="text-align: center;">-18.55</td>
<td style="text-align: center;">76.14</td>
<td style="text-align: center;">-0.24</td>
<td style="text-align: center;">0.81</td>
</tr>
<tr class="even">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Petal.Width</td>
<td style="text-align: center;">-13.70</td>
<td style="text-align: center;">34.79</td>
<td style="text-align: center;">-0.39</td>
<td style="text-align: center;">0.69</td>
</tr>
<tr class="odd">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Sepal.Length</td>
<td style="text-align: center;">6.33</td>
<td style="text-align: center;">2.48</td>
<td style="text-align: center;">2.55</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Sepal.Width</td>
<td style="text-align: center;">6.62</td>
<td style="text-align: center;">2.53</td>
<td style="text-align: center;">2.62</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Petal.Length</td>
<td style="text-align: center;">-8.44</td>
<td style="text-align: center;">3.47</td>
<td style="text-align: center;">-2.43</td>
<td style="text-align: center;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Petal.Width</td>
<td style="text-align: center;">-10.28</td>
<td style="text-align: center;">3.46</td>
<td style="text-align: center;">-2.97</td>
<td style="text-align: center;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>As shown in <a href="#tbl-coef" class="quarto-xref">Table&nbsp;1</a> , it seems that multinominal logistic regression suggests none of the four features can significantly differentiate species but this could be misleading. This is because there are underlying correlations between sepal width/length and petal width/length. Next step is we can use <code>matplotlib</code> module to explore the relationships among four characteristics.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1"></a><span class="in">```{python, out.width = "80%", out.height = "100%", dpi = 200, fig.retina = 1, error = TRUE}</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="in">import numpy as np</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="in">import matplotlib.pyplot as plt</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="in">import matplotlib.cm as cm</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="in">import random</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="in">import seaborn</span></span>
<span id="cb32-7"><a href="#cb32-7"></a></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="in">seaborn.set(style='whitegrid'); seaborn.set_context('talk')</span></span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="in">from sklearn.datasets import load_iris</span></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="in">iris_data = load_iris()</span></span>
<span id="cb32-12"><a href="#cb32-12"></a></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="in">n_samples, n_features = iris_data.data.shape</span></span>
<span id="cb32-14"><a href="#cb32-14"></a></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="in">def Show_Diagram(x_label,y_label,title):</span></span>
<span id="cb32-16"><a href="#cb32-16"></a><span class="in">    plt.figure(figsize=(10,8))</span></span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="in">    plt.scatter(iris_data.data[:,x_label], iris_data.data[:,y_label], c=iris_data.target, cmap=cm.viridis, alpha = 0.5, label = iris_data.target_names)</span></span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="in">    plt.xlabel(iris_data.feature_names[x_label]); plt.ylabel(iris_data.feature_names[y_label]); plt.title(title)</span></span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="in">    plt.legend(('setosa', 'versicolor', 'virginica'))</span></span>
<span id="cb32-20"><a href="#cb32-20"></a><span class="in">    plt.show();x_label = 2;y_label=3;title='Petal'</span></span>
<span id="cb32-21"><a href="#cb32-21"></a></span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="in">Show_Diagram(0,1,'Sepal')</span></span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="in">Show_Diagram(2,3,'Petal')</span></span>
<span id="cb32-24"><a href="#cb32-24"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in py_call_impl(callable, dots$args, dots$keywords): ImportError: dlopen(/Users/jihong/venv-metal/lib/python3.11/site-packages/PIL/_imaging.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_jpeg_resync_to_restart'</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in py_call_impl(callable, dots$args, dots$keywords): ImportError: dlopen(/Users/jihong/venv-metal/lib/python3.11/site-packages/PIL/_imaging.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_jpeg_resync_to_restart'</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in py_call_impl(callable, dots$args, dots$keywords): ImportError: dlopen(/Users/jihong/venv-metal/lib/python3.11/site-packages/PIL/_imaging.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_jpeg_resync_to_restart'</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in py_call_impl(callable, dots$args, dots$keywords): NameError: name 'seaborn' is not defined</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in py_call_impl(callable, dots$args, dots$keywords): NameError: name 'plt' is not defined</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in py_call_impl(callable, dots$args, dots$keywords): NameError: name 'plt' is not defined</code></pre>
</div>
</div>
<p>Alternatively, we can use python data and module <code>Vega-Altair</code> to compile a interactive graphical object to a json file (<code>.to_json()</code>). Then we can plot it in R using <code>as_vegaspec</code> function.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1"></a><span class="in">```{python compile}</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="in"># import altair with an abbreviated alias</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="in">import altair as alt</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="in">import pandas as pd</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="in">label_dict = {0: 'setosa', 1: 'versicolor', 2: 'virginica'}</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="in">        </span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="in">iris = pd.DataFrame(</span></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="in">    data= np.c_[iris_data['data'], iris_data['target']],</span></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="in">    columns= iris_data['feature_names'] + ['target']</span></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="in">    )</span></span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="in">iris['target'] = iris['target'].replace(label_dict)</span></span>
<span id="cb39-12"><a href="#cb39-12"></a></span>
<span id="cb39-13"><a href="#cb39-13"></a><span class="in">chart1 = alt.Chart(iris).mark_point().encode(</span></span>
<span id="cb39-14"><a href="#cb39-14"></a><span class="in">  alt.X('sepal length (cm):Q').scale(domain=(4,9)),</span></span>
<span id="cb39-15"><a href="#cb39-15"></a><span class="in">  alt.Y('sepal width (cm):Q').scale(domain=(1.5,5)),</span></span>
<span id="cb39-16"><a href="#cb39-16"></a><span class="in">  alt.Color('target:N').scale(scheme='dark2'),</span></span>
<span id="cb39-17"><a href="#cb39-17"></a><span class="in">  alt.Shape('target:N')</span></span>
<span id="cb39-18"><a href="#cb39-18"></a><span class="in">).interactive()</span></span>
<span id="cb39-19"><a href="#cb39-19"></a><span class="in">vw = chart1.to_json()</span></span>
<span id="cb39-20"><a href="#cb39-20"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fig-cap-location-top">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb40" data-cap-location="top"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1"></a><span class="in">```{r display}</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="in">#| label: fig-vega1</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="in">#| fig-cap: An interactive plot using python altair</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="in">#| fig-cap-location: top</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="in">#| results: asis</span></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="in">as_vegaspec(py$vw)</span></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="htmlwidget-6aed2002f671a3a2cf38" style="width:auto;height:auto;" class="vegawidget-vl5 html-widget"></div>
<script type="application/json" data-for="htmlwidget-6aed2002f671a3a2cf38">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json",
    "config": {
      "view": {
        "continuousHeight": 300,
        "continuousWidth": 300
      }
    },
    "data": {
      "name": "data-efc8798eb98fb6669c53b4eb56ce3b24"
    },
    "datasets": {
      "data-efc8798eb98fb6669c53b4eb56ce3b24": [
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.9,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.7,
          "sepal width (cm)": 3.2,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.6,
          "sepal width (cm)": 3.1,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.6,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.4,
          "sepal length (cm)": 5.4,
          "sepal width (cm)": 3.9,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.3,
          "sepal length (cm)": 4.6,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.4,
          "sepal width (cm)": 2.9,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.1,
          "sepal length (cm)": 4.9,
          "sepal width (cm)": 3.1,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.4,
          "sepal width (cm)": 3.7,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.8,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.1,
          "sepal length (cm)": 4.8,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.1,
          "petal width (cm)": 0.1,
          "sepal length (cm)": 4.3,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.2,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.8,
          "sepal width (cm)": 4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.4,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 4.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.4,
          "sepal length (cm)": 5.4,
          "sepal width (cm)": 3.9,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.3,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.3,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 3.8,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.3,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.8,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.4,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.4,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.7,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.6,
          "sepal width (cm)": 3.6,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.5,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.9,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.8,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6,
          "petal width (cm)": 0.4,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.2,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.2,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.7,
          "sepal width (cm)": 3.2,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.8,
          "sepal width (cm)": 3.1,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.4,
          "sepal length (cm)": 5.4,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.1,
          "sepal length (cm)": 5.2,
          "sepal width (cm)": 4.1,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 4.2,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.9,
          "sepal width (cm)": 3.1,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.2,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.2,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.1,
          "sepal length (cm)": 4.9,
          "sepal width (cm)": 3.6,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.4,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.3,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.3,
          "sepal length (cm)": 4.5,
          "sepal width (cm)": 2.3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.4,
          "sepal width (cm)": 3.2,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6,
          "petal width (cm)": 0.6,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.9,
          "petal width (cm)": 0.4,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.8,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.3,
          "sepal length (cm)": 4.8,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 3.8,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 4.6,
          "sepal width (cm)": 3.2,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5.3,
          "sepal width (cm)": 3.7,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.4,
          "petal width (cm)": 0.2,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 4.7,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 7,
          "sepal width (cm)": 3.2,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.4,
          "sepal width (cm)": 3.2,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.9,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.9,
          "sepal width (cm)": 3.1,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.6,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 2.8,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 2.8,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7,
          "petal width (cm)": 1.6,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 3.3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.3,
          "petal width (cm)": 1,
          "sepal length (cm)": 4.9,
          "sepal width (cm)": 2.4,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.6,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.6,
          "sepal width (cm)": 2.9,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.9,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 5.2,
          "sepal width (cm)": 2.7,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.5,
          "petal width (cm)": 1,
          "sepal length (cm)": 5,
          "sepal width (cm)": 2,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 5.9,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.2,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 6.1,
          "sepal width (cm)": 2.9,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.6,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.6,
          "sepal width (cm)": 2.9,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 3.1,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 5.6,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.1,
          "petal width (cm)": 1,
          "sepal length (cm)": 5.8,
          "sepal width (cm)": 2.7,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.2,
          "sepal width (cm)": 2.2,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.9,
          "petal width (cm)": 1.1,
          "sepal length (cm)": 5.6,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.8,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 5.9,
          "sepal width (cm)": 3.2,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.1,
          "sepal width (cm)": 2.8,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.9,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 6.1,
          "sepal width (cm)": 2.8,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.3,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.4,
          "sepal width (cm)": 2.9,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 6.6,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.8,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 6.8,
          "sepal width (cm)": 2.8,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 1.7,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.9,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.5,
          "petal width (cm)": 1,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 2.6,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.8,
          "petal width (cm)": 1.1,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.4,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.7,
          "petal width (cm)": 1,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.4,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.9,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.8,
          "sepal width (cm)": 2.7,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 1.6,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.7,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 5.4,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.6,
          "sepal length (cm)": 6,
          "sepal width (cm)": 3.4,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 3.1,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 2.3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.1,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.6,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.6,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.6,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 6.1,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.8,
          "sepal width (cm)": 2.6,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.3,
          "petal width (cm)": 1,
          "sepal length (cm)": 5,
          "sepal width (cm)": 2.3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.6,
          "sepal width (cm)": 2.7,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 2.9,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.3,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.2,
          "sepal width (cm)": 2.9,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3,
          "petal width (cm)": 1.1,
          "sepal length (cm)": 5.1,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.1,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 2.8,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 6,
          "petal width (cm)": 2.5,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 3.3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 1.9,
          "sepal length (cm)": 5.8,
          "sepal width (cm)": 2.7,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.9,
          "petal width (cm)": 2.1,
          "sepal length (cm)": 7.1,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.6,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 2.9,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.8,
          "petal width (cm)": 2.2,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.6,
          "petal width (cm)": 2.1,
          "sepal length (cm)": 7.6,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.7,
          "sepal length (cm)": 4.9,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.3,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 7.3,
          "sepal width (cm)": 2.9,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.8,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.1,
          "petal width (cm)": 2.5,
          "sepal length (cm)": 7.2,
          "sepal width (cm)": 3.6,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 2,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3.2,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.3,
          "petal width (cm)": 1.9,
          "sepal length (cm)": 6.4,
          "sepal width (cm)": 2.7,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5,
          "petal width (cm)": 2.1,
          "sepal length (cm)": 6.8,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 2,
          "sepal length (cm)": 5.7,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 2.4,
          "sepal length (cm)": 5.8,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.3,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 6.4,
          "sepal width (cm)": 3.2,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.7,
          "petal width (cm)": 2.2,
          "sepal length (cm)": 7.7,
          "sepal width (cm)": 3.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.9,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 7.7,
          "sepal width (cm)": 2.6,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.2,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 6.9,
          "sepal width (cm)": 3.2,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.9,
          "petal width (cm)": 2,
          "sepal length (cm)": 5.6,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.7,
          "petal width (cm)": 2,
          "sepal length (cm)": 7.7,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.9,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 2.7,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7,
          "petal width (cm)": 2.1,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 3.3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 7.2,
          "sepal width (cm)": 3.2,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.8,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.2,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.9,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.1,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.6,
          "petal width (cm)": 2.1,
          "sepal length (cm)": 6.4,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.8,
          "petal width (cm)": 1.6,
          "sepal length (cm)": 7.2,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.1,
          "petal width (cm)": 1.9,
          "sepal length (cm)": 7.4,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.4,
          "petal width (cm)": 2,
          "sepal length (cm)": 7.9,
          "sepal width (cm)": 3.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.6,
          "petal width (cm)": 2.2,
          "sepal length (cm)": 6.4,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 2.8,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.6,
          "petal width (cm)": 1.4,
          "sepal length (cm)": 6.1,
          "sepal width (cm)": 2.6,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.1,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 7.7,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.6,
          "petal width (cm)": 2.4,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 3.4,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.4,
          "sepal width (cm)": 3.1,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.8,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.4,
          "petal width (cm)": 2.1,
          "sepal length (cm)": 6.9,
          "sepal width (cm)": 3.1,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.6,
          "petal width (cm)": 2.4,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 3.1,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 6.9,
          "sepal width (cm)": 3.1,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 1.9,
          "sepal length (cm)": 5.8,
          "sepal width (cm)": 2.7,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.9,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 6.8,
          "sepal width (cm)": 3.2,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7,
          "petal width (cm)": 2.5,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 3.3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.2,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 6.7,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 1.9,
          "sepal length (cm)": 6.3,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.2,
          "petal width (cm)": 2,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.4,
          "petal width (cm)": 2.3,
          "sepal length (cm)": 6.2,
          "sepal width (cm)": 3.4,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.1,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 5.9,
          "sepal width (cm)": 3,
          "target": "virginica"
        }
      ]
    },
    "encoding": {
      "color": {
        "field": "target",
        "scale": {
          "scheme": "dark2"
        },
        "type": "nominal"
      },
      "shape": {
        "field": "target",
        "type": "nominal"
      },
      "x": {
        "field": "sepal length (cm)",
        "scale": {
          "domain": [
            4,
            9
          ]
        },
        "type": "quantitative"
      },
      "y": {
        "field": "sepal width (cm)",
        "scale": {
          "domain": [
            1.5,
            5
          ]
        },
        "type": "quantitative"
      }
    },
    "mark": {
      "type": "point"
    },
    "params": [
      {
        "bind": "scales",
        "name": "param_1",
        "select": {
          "encodings": [
            "x",
            "y"
          ],
          "type": "interval"
        }
      }
    ]
  },
  "embed_options": {
    "renderer": "canvas",
    "defaultStyle": true
  }
},"evals":[],"jsHooks":[]}</script><p>An interactive plot using python altair</p>
</div>
<p>Alternatively, we can use <code>ggplot2</code> R package + python data to plot the scatter plots, which I prefer.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1"></a><span class="in">```{r}</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="in">library(ggplot2)</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="in">library(RColorBrewer)</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="in">library(dplyr)</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="in">## A function to convert python iris to R version of iris</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="in">tidy_python_data &lt;- function(iris_from_python) {</span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="in">  dat &lt;- iris_from_python$data</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="in">  dat &lt;- apply(dat, 2, as.numeric)</span></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="in">  colnames(dat) &lt;- iris_from_python$feature_names</span></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="in">  Species = as.character(factor(iris_from_python$target, labels = iris_from_python$target_names))</span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="in">  dat = as.data.frame(cbind(dat, Species = Species))</span></span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="in">  dat &lt;- dat |&gt; </span></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="in">    mutate(across(-Species, \(x) as.numeric(x)))</span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="in">  dat</span></span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="in">}</span></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1"></a><span class="in">```{r}</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="in">library(emojifont)</span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="in">iris_from_python = tidy_python_data(iris_from_python = py$iris_data)</span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="in">ggplot(iris_from_python) +</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="in">  geom_point(aes(x = `sepal length (cm)`, y = `sepal width (cm)`, color = Species, shape = Species), size = 2, alpha = 0.8) +</span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="in">  labs(title = 'Sepal', caption = 'Love you Melody  ♥ !') +</span></span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="in">  scale_color_brewer(palette = 'Dark2')</span></span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1"></a><span class="in">```{r}</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="in">ggplot(iris_from_python) +</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="in">  geom_point(aes(x = `petal length (cm)`, y = `petal width (cm)`, color = Species, shape = Species), size = 2, alpha = 0.8) +</span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="in">  labs(title = 'Petal', caption = 'Love you Melody  ♥ !') +</span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="in">  scale_color_brewer(palette = 'Dark2')</span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>It appears that its hard to differentiate versicolor with verginica in terms of sepal and petal but setosa is more smaller in petal width/length and sepal length but relative long sepal width.</p>
</section><section id="pure-r-torch-for-r" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="pure-r-torch-for-r">
<span class="header-section-number">4</span> Pure R: torch for R</h2>
<p>Alternatively, there is a R package called <a href="https://torch.mlverse.org/start/guess_the_correlation/"><code>torch</code></a>, which is built directly on top of libtorch, a C++ library that provides the tensor-computation and automatic-differentiation capabilities. However, to the date I wrote this post, the version of torch is 0.11.0, which suggests that the package is still far from well developed.</p>
<div class="cell">
<details open="" class="code-fold"><summary>⌘+C</summary><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1"></a><span class="in">```{r}</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="in">library(torch)</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="in">library(luz)</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="in">library(torchvision)</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="in"># torch_tensor(1, device = 'cpu')</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.jihongzhang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="JihongZ/quarto-academic-jihong" data-repo-id="R_kgDOJz3gyg" data-category="General" data-category-id="DIC_kwDOJz3gys4CXdYE" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2015-2024, JihongZhang</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"descPosition":"bottom","loop":false,"selector":".lightbox","openEffect":"zoom","closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>