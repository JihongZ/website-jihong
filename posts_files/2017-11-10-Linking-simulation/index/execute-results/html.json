{
  "hash": "9b7079755585ad87fd8b5f30d709b335",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Simulation Study of Linking Using Mirt\nauthor: Jihong Zhang\ndate: '2017-11-10'\ncategories:\n  - R\n  - mirt\n  - linking\nformat: \n  html:\n    toc: true\n    code-fold: true\n    code-summary: ' R Code'\n    code-line-numbers: true\n    number-sections: true\n    number-offset: 1\n---\n\n\n\n\n> This simulation study is to show how to do IRT Linking Process using mirt R Package. The simulation data includes 2 forms - Form A and Form B. These 2 forms are simulated based on 2 groups of individual, one group has 0 mean trait, another has 0.25 mean trait. Both groups have same sd. <!--more-->\n\n# Introduction\n\nThe means and sds of simulated Form A and B are like:\n\n$$\n\\theta_{A} = \\theta_{B} - 0.25 \\\\\n\\sigma_A^2 = \\sigma_B^2\n$$\n\n# Calibration of Form A\n\nThe mean of $\\theta$ for individuals administrated with form A is 0, the standard deviation (SD=1). In the dataset, X is ID, V1 is true trait ($\\theta$), V3 to V52 is unique items, V54 to V63 are common items.\n\n## Look at the data\n\nFirst of all, have a look at the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mirt)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.2.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'stringr' was built under R version 4.2.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(knitr)\n### Read in Raw data from Form A:\ndat <- read.csv(file=\"FormA.csv\")\nglimpse(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 5,000\nColumns: 64\n$ X   <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,…\n$ V1  <dbl> -0.79498, -0.05589, 0.62650, -1.26832, 0.74921, 1.00922, -0.19147,…\n$ V2  <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ V3  <int> 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, …\n$ V4  <int> 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, …\n$ V5  <int> 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, …\n$ V6  <int> 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, …\n$ V7  <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, …\n$ V8  <int> 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, …\n$ V9  <int> 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, …\n$ V10 <int> 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, …\n$ V11 <int> 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, …\n$ V12 <int> 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, …\n$ V13 <int> 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, …\n$ V14 <int> 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, …\n$ V15 <int> 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, …\n$ V16 <int> 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, …\n$ V17 <int> 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ V18 <int> 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, …\n$ V19 <int> 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, …\n$ V20 <int> 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, …\n$ V21 <int> 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ V22 <int> 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …\n$ V23 <int> 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, …\n$ V24 <int> 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, …\n$ V25 <int> 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, …\n$ V26 <int> 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, …\n$ V27 <int> 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, …\n$ V28 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, …\n$ V29 <int> 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, …\n$ V30 <int> 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, …\n$ V31 <int> 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, …\n$ V32 <int> 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, …\n$ V33 <int> 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, …\n$ V34 <int> 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, …\n$ V35 <int> 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, …\n$ V36 <int> 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, …\n$ V37 <int> 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, …\n$ V38 <int> 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, …\n$ V39 <int> 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, …\n$ V40 <int> 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, …\n$ V41 <int> 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, …\n$ V42 <int> 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …\n$ V43 <int> 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, …\n$ V44 <int> 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, …\n$ V45 <int> 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, …\n$ V46 <int> 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, …\n$ V47 <int> 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, …\n$ V48 <int> 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, …\n$ V49 <int> 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, …\n$ V50 <int> 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, …\n$ V51 <int> 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, …\n$ V52 <int> 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, …\n$ V53 <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ V54 <int> 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, …\n$ V55 <int> 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, …\n$ V56 <int> 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, …\n$ V57 <int> 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, …\n$ V58 <int> 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, …\n$ V59 <int> 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, …\n$ V60 <int> 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, …\n$ V61 <int> 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, …\n$ V62 <int> 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, …\n$ V63 <int> 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, …\n```\n\n\n:::\n:::\n\n\n## Plot the density of true $\\theta$ of Group A\n\nFrom the density function, $mu_{\\theta}$ is 0, $sd_{\\theta}$ is 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(density(dat$V1), main = \"Group A True Trait Density\", \n     xlab=expression(theta) )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/theta-1.png){width=672}\n:::\n:::\n\n\n## CTT Table\n\nCTT table could provide a brief description of table. 2 key valables in the table is item difficulty (*item.diff*) calculated by item means $P(y=1)$ and item discrimination (item.disc), which is item-total correlation.\n\n### Clean data\n\nBy cleaning, data has 60 items including 50 unique item (from item1 to item50) and 10 common items (from item51 to item60). The sample size is 5000.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_cali <- dat %>% select(V3:V52, V54:V63)\ncolnames(dat_cali) <- paste0(\"item\",1:60)\nN <- nrow(dat_cali)\nn <- ncol(dat_cali)\n```\n:::\n\n\n### Classical Test Theory\n\nThen calculate the CTT table for Form A. The item discrimination and difficulty could be compared between Form A and Form B. Because the relationship between trait and total score is non-linear, so there is effect of shrinkage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# item stats\n## item discrimnation\nitem.disc <- apply(dat_cali, 2, function(x) cor(x, rowSums(dat_cali, na.rm = TRUE)))\n\n## item difficulty\nitem.diff <- colMeans(dat_cali)\n\n## item response frequency\nitem.freq <- reduce(lapply(dat_cali, table), bind_rows)\n\nCTT <- cbind(item.disc, item.diff, item.freq)\n\nkable(CTT, digits = 3, caption = \"CTT Table for Form A\")\n```\n\n::: {.cell-output-display}\n\n\nTable: CTT Table for Form A\n\n|       | item.disc| item.diff|    0|    1|\n|:------|---------:|---------:|----:|----:|\n|item1  |     0.365|     0.761| 1197| 3803|\n|item2  |     0.464|     0.833|  835| 4165|\n|item3  |     0.457|     0.539| 2305| 2695|\n|item4  |     0.471|     0.524| 2380| 2620|\n|item5  |     0.385|     0.221| 3893| 1107|\n|item6  |     0.400|     0.563| 2183| 2817|\n|item7  |     0.261|     0.457| 2717| 2283|\n|item8  |     0.264|     0.365| 3176| 1824|\n|item9  |     0.331|     0.560| 2198| 2802|\n|item10 |     0.505|     0.431| 2843| 2157|\n|item11 |     0.306|     0.354| 3228| 1772|\n|item12 |     0.528|     0.560| 2199| 2801|\n|item13 |     0.362|     0.550| 2251| 2749|\n|item14 |     0.427|     0.761| 1196| 3804|\n|item15 |     0.433|     0.241| 3793| 1207|\n|item16 |     0.377|     0.458| 2710| 2290|\n|item17 |     0.524|     0.545| 2275| 2725|\n|item18 |     0.351|     0.578| 2112| 2888|\n|item19 |     0.429|     0.509| 2455| 2545|\n|item20 |     0.330|     0.307| 3465| 1535|\n|item21 |     0.399|     0.403| 2984| 2016|\n|item22 |     0.418|     0.609| 1957| 3043|\n|item23 |     0.356|     0.354| 3232| 1768|\n|item24 |     0.460|     0.670| 1651| 3349|\n|item25 |     0.388|     0.507| 2465| 2535|\n|item26 |     0.209|     0.310| 3451| 1549|\n|item27 |     0.242|     0.476| 2618| 2382|\n|item28 |     0.495|     0.502| 2492| 2508|\n|item29 |     0.441|     0.481| 2593| 2407|\n|item30 |     0.450|     0.731| 1344| 3656|\n|item31 |     0.601|     0.399| 3006| 1994|\n|item32 |     0.396|     0.682| 1588| 3412|\n|item33 |     0.584|     0.613| 1933| 3067|\n|item34 |     0.489|     0.557| 2216| 2784|\n|item35 |     0.467|     0.759| 1203| 3797|\n|item36 |     0.312|     0.367| 3166| 1834|\n|item37 |     0.410|     0.778| 1109| 3891|\n|item38 |     0.443|     0.571| 2143| 2857|\n|item39 |     0.519|     0.755| 1224| 3776|\n|item40 |     0.280|     0.327| 3365| 1635|\n|item41 |     0.413|     0.582| 2088| 2912|\n|item42 |     0.338|     0.395| 3024| 1976|\n|item43 |     0.430|     0.634| 1830| 3170|\n|item44 |     0.348|     0.382| 3088| 1912|\n|item45 |     0.370|     0.530| 2351| 2649|\n|item46 |     0.286|     0.337| 3314| 1686|\n|item47 |     0.456|     0.403| 2985| 2015|\n|item48 |     0.340|     0.397| 3014| 1986|\n|item49 |     0.310|     0.291| 3544| 1456|\n|item50 |     0.435|     0.357| 3214| 1786|\n|item51 |     0.283|     0.821|  895| 4105|\n|item52 |     0.272|     0.324| 3382| 1618|\n|item53 |     0.474|     0.531| 2347| 2653|\n|item54 |     0.298|     0.336| 3318| 1682|\n|item55 |     0.427|     0.546| 2271| 2729|\n|item56 |     0.471|     0.667| 1667| 3333|\n|item57 |     0.410|     0.470| 2652| 2348|\n|item58 |     0.483|     0.433| 2834| 2166|\n|item59 |     0.363|     0.232| 3841| 1159|\n|item60 |     0.376|     0.666| 1670| 3330|\n\n\n:::\n:::\n\n\n## Final Calibration of Form A\n\n### Model Specification\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSPECS <- mirt.model('F = 1-60\n                    PRIOR = (1-60, a1, lnorm, 0, 1),\n                    (1-60,  d,  norm, 0, 1),\n                    (1-60,  g,  norm, -1.39,1)')\nmod_A3PL <- mirt(data=dat_cali, model=SPECS, itemtype='3PL')\nparms_a <- coef(mod_A3PL, simplify=TRUE, IRTpars = TRUE)$items\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\na_A <- parms_a[,1] \nb_A <- parms_a[,2] \nc_A <- parms_a[,3] \ntheta_A <- fscores(mod_A3PL,method=\"EAP\",\n                   full.scores=TRUE, full.scores.SE=TRUE,\n                   scores.only=TRUE)\n```\n:::\n\n\nUsing 3-PL for irt model of form A. Extracting the cofficients (a, b, c) of IRT. The model-implied theta was outputed, whose mean is 0.1314938\n\nThe plot below suggest that SE is low when theta is close to mean, but low theta and high theta has large SE.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(theta_A[,1],theta_A[,2])\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/SE-1.png){width=672}\n:::\n:::\n\n\n# Calibration of Form B\n\nThe structure of Form B is as same as Form A.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_b <- read.csv(file=\"FormB.csv\")\nglimpse(dat_b)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 5,000\nColumns: 64\n$ X   <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,…\n$ V1  <dbl> 1.12513, 0.29724, -0.54719, 1.18477, 0.37517, 0.05821, 1.11918, 1.…\n$ V2  <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ V3  <int> 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, …\n$ V4  <int> 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, …\n$ V5  <int> 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, …\n$ V6  <int> 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, …\n$ V7  <int> 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, …\n$ V8  <int> 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, …\n$ V9  <int> 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, …\n$ V10 <int> 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, …\n$ V11 <int> 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, …\n$ V12 <int> 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, …\n$ V13 <int> 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, …\n$ V14 <int> 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, …\n$ V15 <int> 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, …\n$ V16 <int> 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, …\n$ V17 <int> 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, …\n$ V18 <int> 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, …\n$ V19 <int> 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, …\n$ V20 <int> 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, …\n$ V21 <int> 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, …\n$ V22 <int> 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, …\n$ V23 <int> 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, …\n$ V24 <int> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, …\n$ V25 <int> 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, …\n$ V26 <int> 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, …\n$ V27 <int> 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, …\n$ V28 <int> 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, …\n$ V29 <int> 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, …\n$ V30 <int> 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, …\n$ V31 <int> 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, …\n$ V32 <int> 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, …\n$ V33 <int> 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, …\n$ V34 <int> 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, …\n$ V35 <int> 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, …\n$ V36 <int> 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, …\n$ V37 <int> 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, …\n$ V38 <int> 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, …\n$ V39 <int> 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, …\n$ V40 <int> 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, …\n$ V41 <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, …\n$ V42 <int> 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, …\n$ V43 <int> 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, …\n$ V44 <int> 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, …\n$ V45 <int> 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ V46 <int> 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, …\n$ V47 <int> 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …\n$ V48 <int> 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, …\n$ V49 <int> 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, …\n$ V50 <int> 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, …\n$ V51 <int> 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, …\n$ V52 <int> 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, …\n$ V53 <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ V54 <int> 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, …\n$ V55 <int> 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, …\n$ V56 <int> 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, …\n$ V57 <int> 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, …\n$ V58 <int> 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, …\n$ V59 <int> 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, …\n$ V60 <int> 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, …\n$ V61 <int> 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, …\n$ V62 <int> 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, …\n$ V63 <int> 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot(data = dat_b) +\n  ggtitle(\"Group B True Trait Density\") +\n  geom_density(aes(x = V1), fill = \"skyblue\", col = \"skyblue\", alpha=0.8) +\n  xlab(\"True Latent Trait\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/theta_b-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_cali2 <- dat_b %>% select(V3:V52, V54:V63)\ncolnames(dat_cali2) <- paste0(\"item\",1:60)\nN <- nrow(dat_cali2)\nn <- ncol(dat_cali2)\n\n\n# item stats\n## item discrimnation\nitem.disc <- apply(dat_cali2, 2, function(x) cor(x, rowSums(dat_cali, na.rm = TRUE)))\n\n## item difficulty\nitem.diff <- colMeans(dat_cali2)\n\n## item response frequency\nitem.freq <- reduce(lapply(dat_cali2, table), bind_rows)\n\nCTT2 <- cbind(item.disc, item.diff, item.freq)\n\nkable(CTT2, digits = 3, caption = \"CTT Table for Form A\")\n```\n\n::: {.cell-output-display}\n\n\nTable: CTT Table for Form A\n\n|       | item.disc| item.diff|    0|    1|\n|:------|---------:|---------:|----:|----:|\n|item1  |    -0.029|     0.517| 2415| 2585|\n|item2  |    -0.005|     0.573| 2137| 2863|\n|item3  |    -0.037|     0.552| 2242| 2758|\n|item4  |     0.008|     0.519| 2405| 2595|\n|item5  |     0.013|     0.709| 1455| 3545|\n|item6  |    -0.012|     0.804|  979| 4021|\n|item7  |     0.017|     0.687| 1567| 3433|\n|item8  |     0.003|     0.641| 1794| 3206|\n|item9  |     0.000|     0.626| 1869| 3131|\n|item10 |    -0.021|     0.392| 3038| 1962|\n|item11 |     0.021|     0.821|  893| 4107|\n|item12 |    -0.012|     0.474| 2629| 2371|\n|item13 |    -0.026|     0.687| 1564| 3436|\n|item14 |     0.008|     0.517| 2414| 2586|\n|item15 |     0.004|     0.475| 2626| 2374|\n|item16 |    -0.012|     0.525| 2375| 2625|\n|item17 |    -0.025|     0.363| 3185| 1815|\n|item18 |     0.001|     0.393| 3036| 1964|\n|item19 |     0.003|     0.490| 2550| 2450|\n|item20 |     0.001|     0.505| 2477| 2523|\n|item21 |     0.006|     0.710| 1451| 3549|\n|item22 |     0.015|     0.248| 3759| 1241|\n|item23 |     0.007|     0.594| 2030| 2970|\n|item24 |    -0.010|     0.360| 3200| 1800|\n|item25 |     0.011|     0.664| 1681| 3319|\n|item26 |    -0.002|     0.790| 1050| 3950|\n|item27 |     0.011|     0.395| 3026| 1974|\n|item28 |     0.009|     0.353| 3236| 1764|\n|item29 |    -0.003|     0.335| 3325| 1675|\n|item30 |    -0.015|     0.346| 3268| 1732|\n|item31 |     0.005|     0.340| 3301| 1699|\n|item32 |     0.007|     0.613| 1935| 3065|\n|item33 |    -0.026|     0.377| 3117| 1883|\n|item34 |     0.003|     0.500| 2502| 2498|\n|item35 |    -0.007|     0.436| 2821| 2179|\n|item36 |    -0.009|     0.767| 1166| 3834|\n|item37 |     0.003|     0.428| 2861| 2139|\n|item38 |     0.002|     0.593| 2033| 2967|\n|item39 |     0.011|     0.663| 1683| 3317|\n|item40 |     0.020|     0.606| 1968| 3032|\n|item41 |    -0.010|     0.840|  799| 4201|\n|item42 |     0.015|     0.554| 2232| 2768|\n|item43 |     0.012|     0.824|  880| 4120|\n|item44 |    -0.018|     0.433| 2837| 2163|\n|item45 |    -0.005|     0.429| 2855| 2145|\n|item46 |    -0.019|     0.316| 3421| 1579|\n|item47 |    -0.007|     0.827|  867| 4133|\n|item48 |    -0.023|     0.760| 1201| 3799|\n|item49 |     0.009|     0.389| 3055| 1945|\n|item50 |    -0.013|     0.317| 3413| 1587|\n|item51 |    -0.002|     0.848|  762| 4238|\n|item52 |    -0.018|     0.362| 3191| 1809|\n|item53 |     0.007|     0.580| 2101| 2899|\n|item54 |    -0.013|     0.363| 3184| 1816|\n|item55 |    -0.023|     0.581| 2096| 2904|\n|item56 |    -0.034|     0.731| 1344| 3656|\n|item57 |    -0.007|     0.524| 2379| 2621|\n|item58 |    -0.017|     0.491| 2547| 2453|\n|item59 |     0.004|     0.275| 3627| 1373|\n|item60 |     0.022|     0.715| 1423| 3577|\n\n\n:::\n:::\n\n\n## Final Calibration of Form A\n\n### Model Specification of B\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSPECS2 <- mirt.model('F = 1-60\n                    PRIOR = (1-60, a1, lnorm, 0, 1),\n                    (1-60,  d,  norm, 0, 1),\n                    (1-60,  g,  norm, -1.39,1)')\nmod_B3PL <- mirt(data=dat_cali2, model=SPECS, itemtype='3PL')\nparms_b <- coef(mod_B3PL, simplify=TRUE, IRTpars = TRUE)$items\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\na_B <- parms_b[,1] \nb_B <- parms_b[,2] \nc_B <- parms_b[,3] \ntheta_B <- fscores(mod_B3PL,method=\"EAP\",\n                   full.scores=TRUE, full.scores.SE=TRUE,\n                   scores.only=TRUE)\nhead(theta_B, 20) %>% kable(digits = 3, caption = \"Model-implied Theta of B\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Model-implied Theta of B\n\n|      F|  SE_F|\n|------:|-----:|\n|  0.933| 0.214|\n|  0.193| 0.220|\n| -0.783| 0.293|\n|  0.865| 0.208|\n| -0.233| 0.261|\n| -0.217| 0.239|\n|  0.890| 0.215|\n|  1.369| 0.232|\n| -0.875| 0.306|\n| -0.411| 0.266|\n|  1.091| 0.223|\n| -0.638| 0.261|\n| -1.253| 0.321|\n| -0.784| 0.261|\n|  0.436| 0.228|\n|  0.135| 0.211|\n| -1.841| 0.491|\n| -0.491| 0.259|\n|  0.065| 0.225|\n| -0.339| 0.240|\n\n\n:::\n:::\n\n\n## b-plot\n\nThe relationship between b parameters of A and B reflect the latent traits of A and B:\n\n$$\n\\theta_{A} = \\theta_{B} - 0.25 \\\\\n\\sigma_A^2 = \\sigma_B^2\n$$ thus, $b_B -b_A$ should also be -0.25. the estimated difference of b is calculate by the mean of b parametes of Form A's common items and that of Form B's common items, which is -0.2756443. Thus, it is very close to difference of true traits.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### b-plot\nplot(b_A[51:60],b_B[51:60],\n     main=paste0(\"r =\", round(cor(b_A[51:60],b_B[51:60]),5)), \n     xlab = \"b_A\",\n     ylab = \"b_B\"\n     )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# mean(b_B[51:60])-mean(b_A[51:60])\n```\n:::\n\n\n## a-plot\n\nBecause $\\theta_B - \\theta_A = 0.25$, so a parametes are: $$\na_A / a_B = 1\n$$\n\nThe true ratio of (means of) a parameters is 1.016284, which is very close to 1. SD of A and B are both close to 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### a-plot\nplot(a_A[51:60],a_B[51:60],\n     main=round(cor(a_A[51:60],a_B[51:60]),5)\n     )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# mean(a_A[51:60]) / mean(a_B[51:60]) \n\n\n#SDs of b-values across forms\nSD_bA <- sd(b_A[51:60])\nSD_bB <- sd(b_B[51:60])\n\nMean_bA <- mean(b_A[51:60])\nMean_bB <- mean(b_B[51:60])\n```\n:::\n\n\n# Linking\n\n\n::: {.cell}\n\n```{.r .cell-code}\n###\n### Run one or the other, NOT BOTH!\n###\n\n### MS linking: place item parameters from\n### Form B on the scale of Form A\nslope <- SD_bA / SD_bB\ninter <- Mean_bA - slope*Mean_bB\n\n### MM linking: place item parameters from\n### Form B on the scale of Form A\n# slope <- Mean_aA / Mean_aB\n# inter <- Mean_bA - slope*Mean_bB\n\n\n###\n### Perform the Linking\n###\n\nLINKED_items <- matrix(0,50,3)\n\n#Column 3 is c, it stays the same\nLINKED_items[,3] <- c_B[1:50]\n\n#Column 2 is b, it is linked:\nLINKED_items[,2] <- b_B[1:50]*slope + inter\n\n#Column 1 is a, it is also linked:\nLINKED_items[,1] <- a_B[1:50] / slope\n\n### Now the ITEM BANK has 110 items all\n### linked to a common metric!\nrownames(LINKED_items) <- paste0(\"item_B\", 1:50)\nITEM.BANK <- rbind(parms_a[,-4], LINKED_items)\n# write.csv(ITEM.BANK,file=\"item_bank.csv\")\n\n#Link the theta estimates\nLINKED_theta <- theta_B[,1]*slope + inter\nLINKED_se <- theta_B[,2]/slope\n\n# write.csv(cbind(LINKED_theta,LINKED_se),file=\"LINKED_FormB_theta_est.csv\")\npaste0(\"Mean of Theta of B is \",mean(theta_B[,1]) %>% round(3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Mean of Theta of B is -0.013\"\n```\n\n\n:::\n\n```{.r .cell-code}\npaste0(\"SD of Theta of B is \", sd(theta_B[,1]) %>% round(3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"SD of Theta of B is 0.97\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# after Linked\nprint(\"After Linking:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"After Linking:\"\n```\n\n\n:::\n\n```{.r .cell-code}\npaste0(\"Mean of Theta of B is \",mean(LINKED_theta) %>% round(3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Mean of Theta of B is 0.269\"\n```\n\n\n:::\n\n```{.r .cell-code}\npaste0(\"SD of Theta of B is \",sd(LINKED_theta) %>% round(3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"SD of Theta of B is 0.935\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Theta of A is\npaste0(\"Mean of Theta of A is \",mean(theta_A[,1]) %>% round(3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Mean of Theta of A is -0.021\"\n```\n\n\n:::\n\n```{.r .cell-code}\npaste0(\"SD of Theta of A is \", sd(theta_A[,1]) %>% round(3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"SD of Theta of A is 0.965\"\n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}