{
  "hash": "02509f14d97d48267313f6b8f9a7afcb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Estimating Logistic Regression Coefficients\ndate: '2019-10-16'\ncategories:\n  - Math\ntags: []\ndraft: true\nauthors: ['Jihong Zhang']\n---\n\n\n\n\n```{.r .cell-code}\nlibrary(ISLR)\nlibrary(tidyverse)\n```\n\n\n\n## Descriptive Statistics\n\n\n\n\n```{.r .cell-code}\nhead(Default)\n```\n\n  default student   balance    income\n1      No      No  729.5265 44361.625\n2      No     Yes  817.1804 12106.135\n3      No      No 1073.5492 31767.139\n4      No      No  529.2506 35704.494\n5      No      No  785.6559 38463.496\n6      No     Yes  919.5885  7491.559\n\n\n```{.r .cell-code}\nfig <- Default %>% ggplot(aes(x = default))\n\nfig + geom_boxplot(aes(fill = default, y = balance))\nfig + geom_boxplot(aes(fill = default, y = income))\n\nDefault_stu<-Default %>% \n  group_by(default, student) %>% \n  summarise(n_stu = n())\n\nDefault_stu %>% ggplot() + geom_histogram(aes(y = n_stu, x= student, fill = default), data = Default_stu, \n                     stat = \"identity\",position = \"dodge\")\n```\n\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=33%}![](index_files/figure-html/unnamed-chunk-3-2.png){width=33%}![](index_files/figure-html/unnamed-chunk-3-3.png){width=33%}\n\n\n\n## Estimation\n\nThe estimation process is based on the [Eq.17 here](https://czep.net/stat/mlelr.pdf)\n\n\n\n\n```{.r .cell-code}\nY = as.numeric(Default$default) - 1\nX = Default[,3:4]\nX = cbind(beta0 = 1, X)\nX = as.matrix(X)\nN = nrow(Default)\nK = ncol(X) # student balance and income\npi = c(table(Y)/N)\nbetas = matrix(0, K)\nW= diag(N)\nmu = pi[Y]\nnrep = 100\n\nbetas.old = betas\nfor (rep in 1:nrep) {\n  betas.new = betas.old + solve(t(X) %*% W %*% X) %*% t(X) %*% (Y - mu)\n  if (abs(betas.new[1]-betas.old[1]) < 0.01) {\n    print(betas)\n    break\n  }\n  \n  print(betas.new[1])\n  print(paste0(\"Repete \", rep, \" Times\"))\n  betas.old = betas.new\n}\n```\n\n[1] -1.05894\n[1] \"Repete 1 Times\"\n[1] -2.117879\n[1] \"Repete 2 Times\"\n[1] -3.176819\n[1] \"Repete 3 Times\"\n[1] -4.235759\n[1] \"Repete 4 Times\"\n[1] -5.294698\n[1] \"Repete 5 Times\"\n[1] -6.353638\n[1] \"Repete 6 Times\"\n[1] -7.412578\n[1] \"Repete 7 Times\"\n[1] -8.471517\n[1] \"Repete 8 Times\"\n[1] -9.530457\n[1] \"Repete 9 Times\"\n[1] -10.5894\n[1] \"Repete 10 Times\"\n[1] -11.64834\n[1] \"Repete 11 Times\"\n[1] -12.70728\n[1] \"Repete 12 Times\"\n[1] -13.76622\n[1] \"Repete 13 Times\"\n[1] -14.82516\n[1] \"Repete 14 Times\"\n[1] -15.8841\n[1] \"Repete 15 Times\"\n[1] -16.94303\n[1] \"Repete 16 Times\"\n[1] -18.00197\n[1] \"Repete 17 Times\"\n[1] -19.06091\n[1] \"Repete 18 Times\"\n[1] -20.11985\n[1] \"Repete 19 Times\"\n[1] -21.17879\n[1] \"Repete 20 Times\"\n[1] -22.23773\n[1] \"Repete 21 Times\"\n[1] -23.29667\n[1] \"Repete 22 Times\"\n[1] -24.35561\n[1] \"Repete 23 Times\"\n[1] -25.41455\n[1] \"Repete 24 Times\"\n[1] -26.47349\n[1] \"Repete 25 Times\"\n[1] -27.53243\n[1] \"Repete 26 Times\"\n[1] -28.59137\n[1] \"Repete 27 Times\"\n[1] -29.65031\n[1] \"Repete 28 Times\"\n[1] -30.70925\n[1] \"Repete 29 Times\"\n[1] -31.76819\n[1] \"Repete 30 Times\"\n[1] -32.82713\n[1] \"Repete 31 Times\"\n[1] -33.88607\n[1] \"Repete 32 Times\"\n[1] -34.94501\n[1] \"Repete 33 Times\"\n[1] -36.00395\n[1] \"Repete 34 Times\"\n[1] -37.06289\n[1] \"Repete 35 Times\"\n[1] -38.12183\n[1] \"Repete 36 Times\"\n[1] -39.18077\n[1] \"Repete 37 Times\"\n[1] -40.23971\n[1] \"Repete 38 Times\"\n[1] -41.29865\n[1] \"Repete 39 Times\"\n[1] -42.35759\n[1] \"Repete 40 Times\"\n[1] -43.41653\n[1] \"Repete 41 Times\"\n[1] -44.47547\n[1] \"Repete 42 Times\"\n[1] -45.53441\n[1] \"Repete 43 Times\"\n[1] -46.59335\n[1] \"Repete 44 Times\"\n[1] -47.65229\n[1] \"Repete 45 Times\"\n[1] -48.71123\n[1] \"Repete 46 Times\"\n[1] -49.77017\n[1] \"Repete 47 Times\"\n[1] -50.8291\n[1] \"Repete 48 Times\"\n[1] -51.88804\n[1] \"Repete 49 Times\"\n[1] -52.94698\n[1] \"Repete 50 Times\"\n[1] -54.00592\n[1] \"Repete 51 Times\"\n[1] -55.06486\n[1] \"Repete 52 Times\"\n[1] -56.1238\n[1] \"Repete 53 Times\"\n[1] -57.18274\n[1] \"Repete 54 Times\"\n[1] -58.24168\n[1] \"Repete 55 Times\"\n[1] -59.30062\n[1] \"Repete 56 Times\"\n[1] -60.35956\n[1] \"Repete 57 Times\"\n[1] -61.4185\n[1] \"Repete 58 Times\"\n[1] -62.47744\n[1] \"Repete 59 Times\"\n[1] -63.53638\n[1] \"Repete 60 Times\"\n[1] -64.59532\n[1] \"Repete 61 Times\"\n[1] -65.65426\n[1] \"Repete 62 Times\"\n[1] -66.7132\n[1] \"Repete 63 Times\"\n[1] -67.77214\n[1] \"Repete 64 Times\"\n[1] -68.83108\n[1] \"Repete 65 Times\"\n[1] -69.89002\n[1] \"Repete 66 Times\"\n[1] -70.94896\n[1] \"Repete 67 Times\"\n[1] -72.0079\n[1] \"Repete 68 Times\"\n[1] -73.06684\n[1] \"Repete 69 Times\"\n[1] -74.12578\n[1] \"Repete 70 Times\"\n[1] -75.18472\n[1] \"Repete 71 Times\"\n[1] -76.24366\n[1] \"Repete 72 Times\"\n[1] -77.3026\n[1] \"Repete 73 Times\"\n[1] -78.36154\n[1] \"Repete 74 Times\"\n[1] -79.42048\n[1] \"Repete 75 Times\"\n[1] -80.47942\n[1] \"Repete 76 Times\"\n[1] -81.53836\n[1] \"Repete 77 Times\"\n[1] -82.5973\n[1] \"Repete 78 Times\"\n[1] -83.65624\n[1] \"Repete 79 Times\"\n[1] -84.71517\n[1] \"Repete 80 Times\"\n[1] -85.77411\n[1] \"Repete 81 Times\"\n[1] -86.83305\n[1] \"Repete 82 Times\"\n[1] -87.89199\n[1] \"Repete 83 Times\"\n[1] -88.95093\n[1] \"Repete 84 Times\"\n[1] -90.00987\n[1] \"Repete 85 Times\"\n[1] -91.06881\n[1] \"Repete 86 Times\"\n[1] -92.12775\n[1] \"Repete 87 Times\"\n[1] -93.18669\n[1] \"Repete 88 Times\"\n[1] -94.24563\n[1] \"Repete 89 Times\"\n[1] -95.30457\n[1] \"Repete 90 Times\"\n[1] -96.36351\n[1] \"Repete 91 Times\"\n[1] -97.42245\n[1] \"Repete 92 Times\"\n[1] -98.48139\n[1] \"Repete 93 Times\"\n[1] -99.54033\n[1] \"Repete 94 Times\"\n[1] -100.5993\n[1] \"Repete 95 Times\"\n[1] -101.6582\n[1] \"Repete 96 Times\"\n[1] -102.7171\n[1] \"Repete 97 Times\"\n[1] -103.7761\n[1] \"Repete 98 Times\"\n[1] -104.835\n[1] \"Repete 99 Times\"\n[1] -105.894\n[1] \"Repete 100 Times\"\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}