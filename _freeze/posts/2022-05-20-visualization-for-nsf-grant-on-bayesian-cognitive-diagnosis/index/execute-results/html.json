{
  "hash": "7657a34756b3f8ef2dc8b8b855e39415",
  "result": {
    "engine": "knitr",
    "markdown": "---\n# Documentation: https://wowchemy.com/docs/managing-content/\n\ntitle: \"NSF Grant on Bayesian Cognitive Diagnosis\"\nsubtitle: \"Data visualization using ggplot2\"\nsummary: \"\"\nauthors: [\"Jihong\"]\ntags: []\ncategories: []\ndate: 2022-05-20T12:30:38-05:00\nlastmod: 2022-05-20T12:30:38-05:00\nfeatured: false\ndraft: false\n\n# Featured image\n# To use, add an image named `featured.jpg/png` to your page's folder.\n# Focal points: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight.\n\n# Projects (optional).\n#   Associate this post with one or more of your projects.\n#   Simply enter your project's folder or file name without extension.\n#   E.g. `projects = [\"internal-project\"]` references `content/project/deep-learning/index.md`.\n#   Otherwise, set `projects = []`.\n---\n\n\n\n\n> The NSF grant awards can be easily searched via [NSF website](https://nsf.gov/awardsearch). Check `Active Awards` and type \"Bayesian & Cognitive Diagnosis\" into the search box. Two things I'm really interested in: (1) Who as Principal Investigator (PI) obtained most NSF awards? (2) Which institute obtained most NSF awards?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nawards <- read.csv(\"Awards.csv\")\nawards <- awards |>\n  filter(NSFOrganization == \"SES\") # select social economic sciences\n```\n:::\n\n\n## Who get most awards\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npi_amount <- awards |> \n  select(PI = PrincipalInvestigator, Org = Organization, Amount = AwardedAmountToDate, Title) |> \n  filter(PI!=\"\") |> \n  mutate(Org = str_replace_all(Org, pattern = \" -DO NOT USE\", \"\")) |> \n  mutate(Amount = str_replace_all(Amount, pattern = \"[\\\\$\\\\,]\", \"\")) |> \n  mutate(Amount = as.numeric(Amount)) |> \n  mutate(Title = str_replace(Title, \"    \", \" \")) |> \n  mutate(Title = str_replace(Title, \"NCRN-MN: \", \"\")) |> \n  mutate(Title = str_replace(Title, \"Collaborative Research: \", \"\")) |> \n  mutate(Title = str_replace(Title, \"CAREER: \", \"\")) |> \n  mutate(Title = sub(x = Title, pattern = '(?<=.{85})', replacement = '\\n', perl = TRUE)) |> \n  mutate(Title = str_replace(Title, \"^ \", \"\")) |> \n  mutate(PI = paste0(PI, \"\\n\", Org))\n\npi_amount_p <- pi_amount |> \n  group_by(PI) |> \n  summarise(\n    Amount_sum = sum(Amount),\n    Award_num = n(),\n    Title = Title[1]\n  ) |> \n  mutate(PI = fct_reorder(PI, Amount_sum)) |> \n  arrange(desc(PI)) |> \n  head(50) |>  # top 100 \n  mutate(Highlight = c(rep(1, 10), rep(0, 40)),\n         rank = row_number()) |> \n  mutate(labels = paste0(round(Amount_sum/ 1e6, 1), \" M\"))\n\nggplot(pi_amount_p) +\n  geom_col(aes(x = PI, y = Amount_sum, fill = factor(Highlight))) +\n  # geom_text(aes(x = PI, y = 0, label = labels), hjust = 1, size = 3) +\n  geom_text(aes(x = PI, y = 0, label = Title), hjust = 0, size = 3, alpha = 0.8) +\n  scale_y_continuous(labels = scales::label_number(suffix = \" M\", scale = 1e-6), limits = c(NA, 4500000)) +\n  # scale_x_discrete(labels = PI, breaks = PI) +\n  scale_fill_manual(values = c(\"darkblue\", \"red\")) +\n  labs(title = \"NSF Social Economic Sciences: Top 50 PIs most amount of awards\\nfunded (2021-2022)\", \n       subtitle = \"Bayesian Cognitive Diagnosis\",\n       caption = 'SEARCH: \"Bayesian Cognitive Diagnosis\"\\nSource:https://nsf.gov/awardsearch',\n       x = \"PI & Orgnization\", y = \"Total Amount of Awards\") +\n  coord_flip() +\n  ggdark::dark_theme_gray() +\n  theme(legend.position = \"\", text = element_text(size = 10), title = element_text(hjust = -0.1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=768}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}