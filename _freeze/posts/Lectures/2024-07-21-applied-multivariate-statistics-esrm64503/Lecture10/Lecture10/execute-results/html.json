{
  "hash": "fecf9492108242d11fd7ae652dd3b45c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 10: Mixed Models for Multivariate Regression\"\nsubtitle: \"\"\nauthor: \"Jihong Zhang*, Ph.D\"\ninstitute: | \n  Educational Statistics and Research Methods (ESRM) Program*\n  \n  University of Arkansas\ndate: \"2024-10-09\"\ndate-modified: \"2024-10-11\"\nsidebar: false\nexecute: \n  echo: true\n  warning: false\noutput-location: default\ncode-annotations: below\nhighlight-style: \"nord\"\nformat: \n  uark-revealjs:\n    scrollable: true\n    chalkboard: true\n    embed-resources: false\n    code-fold: false\n    number-sections: false\n    footer: \"ESRM 64503 - Lecture 09: Absolute Model fit and Path Analysis\"\n    slide-number: c/t\n    tbl-colwidths: auto\n    output-file: slides-index.html\n  html: \n    page-layout: full\n    toc: true\n    toc-depth: 2\n    toc-expand: true\n    lightbox: true\n    code-fold: false\n    fig-align: center\nfilters:\n  - quarto\n  - line-highlight\n---\n\n\n\n\n## \n\n\n\n\n```{=html}\n<div class=\"card shadow\">\n    <div class=\"ml-3 mt-2\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"14\" viewBox=\"0 0 54 14\">\n            <g fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(1 1)\">\n                <circle cx=\"6\" cy=\"6\" r=\"6\" fill=\"#FF5F56\" stroke=\"#E0443E\" stroke-width=\".5\"></circle>\n                <circle cx=\"26\" cy=\"6\" r=\"6\" fill=\"#FFBD2E\" stroke=\"#DEA123\" stroke-width=\".5\"></circle>\n                <circle cx=\"46\" cy=\"6\" r=\"6\" fill=\"#27C93F\" stroke=\"#1AAB29\" stroke-width=\".5\"></circle>\n            </g>\n        </svg>\n    </div>\n    <div class=\"card-body\">\n        <h4 class=\"card-title\"><b>Today's Class</b></h4>\n        <ul>\n          <li>Multivaraite regression via mixed models</li>\n          <li>Comparing and contrasting path analysis with mixed models</li>\n          <ul>\n            <li>Differences in model fit measures </li>\n            <li>Differences in software estimation methods </li>\n            <li>Model comparisons via multivariate Wald tests (instead of LRTs) </li>\n            <li>How to compute R-square </li>\n          </ul>\n        </ul>\n    </div>\n</div>\n```\n\n\n\n## R Setup\n\n\n\n\n::: {.cell output-location='default'}\n\n```{.r .cell-code}\nlibrary(ESRM64503)\nlibrary(kableExtra)\nlibrary(tidyverse)\nlibrary(DescTools) # Desc() allows you to quick screen data\nlibrary(lavaan) # Desc() allows you to quick screen data\n# options(digits = 3)\nhead(dataMath)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  id hsl cc use msc mas mse perf female\n1  1  NA  9  44  55  39  NA   14      1\n2  2   3  2  77  70  42  71   12      0\n3  3  NA 12  64  52  31  NA   NA      1\n4  4   6 20  71  65  39  84   19      0\n5  5   2 15  48  19   2  60   12      0\n6  6  NA 15  61  62  42  87   18      0\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(dataMath)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 350   9\n```\n\n\n:::\n:::\n\n\n\n\n## Big Picture\n\n1.  Mixed models are used for many types of analyses:\n    -   Analogous to MANOVA and M-Regression (so repeated measures analyses)\n    -   Multilevel models for clustered, longitudinal, and crossed-effects data\n2.  The biggest difference between mixed models and path analysis software is in the assumed distribution of the exogenous variables：\n    -   Mixed models: no distribution assumed\n    -   Path analysis: most software assumes multivariate normal\n    -   This affects how missing data are managed – mixed models cannot have any missing IVs\n3.  Mixed models also do not allow endogenous variables to predict other endogenous variables\n    -   No indirect effects are possible from a single analysis (multiple analyses needed)\n4.  Mixed models software also often needs variables to be stored in so-called “stacked” or long-format data (one row per DV)\n    -   We used wide-format data for `lavaan` (one row per person)\n\n## Wide to Long Data Transformation\n\n-   Original wide-format data (all DVs for a person on one row)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- dataMath\ndat$cc10 <- dat$cc - 10\n(dat_wide <- dat |> select(id, perf, use, female, cc10))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     id perf use female cc10\n1     1   14  44      1   -1\n2     2   12  77      0   -8\n3     3   NA  64      1    2\n4     4   19  71      0   10\n5     5   12  48      0    5\n6     6   18  61      0    5\n7     7   10  51      0  -10\n8     8   NA  45      0    3\n9     9   14  51      0    2\n10   10   13  36      0   12\n11   11   13  78      0    5\n12   12   16  51      1   -6\n13   13   15  73      0   -2\n14   14    8  27      1  -10\n15   15   15  34      0   11\n16   16   NA  46      0    1\n17   17   16  NA      1    1\n18   18   14  65      0    1\n19   19   15  78      0    0\n20   20   12  60      0    5\n21   21   15  35      1   -6\n22   22   NA  25      0   NA\n23   23   11  67      1    6\n24   24   23  67      0    9\n25   25   NA  62      1  -10\n26   26   22  50      0    0\n27   27   14  84      1   10\n28   28   12  NA      0    0\n29   29   16  58      1   -8\n30   30   13  58      0   -1\n31   31   11  50      0   -8\n32   32   13  51      1   -1\n33   33   11  65      0   -6\n34   34   10  65      0   -1\n35   35   13  70      0   -5\n36   36   14  77      0    5\n37   37   14  58      0   -4\n38   38   14  51      1    4\n39   39   12  65      0    0\n40   40   13  51      0    4\n41   41   15  57      0   -1\n42   42   10  33      0  -10\n43   43   14  57      0   -2\n44   44   NA  52      0    2\n45   45   13  59      0   -7\n46   46   16  44      1   -5\n47   47   12  52      0    5\n48   48   13  47      0   -7\n49   49   17  25      0   -3\n50   50   12  47      1   NA\n51   51   NA  25      0    3\n52   52   15  63      0   NA\n53   53   NA  58      1   NA\n54   54   NA  50      1  -10\n55   55   NA  38      1   -2\n56   56   15  56      0    3\n57   57    9  32      0   -6\n58   58   13  54      1    3\n59   59   16  38      0   -6\n60   60    5  44      0    0\n61   61   13  44      0   NA\n62   62   13  47      1  -10\n63   63   22  51      1    5\n64   64   14  53      1   -7\n65   65   12  36      0   -5\n66   66   13  50      0   -7\n67   67   19  49      0    2\n68   68    9  78      0   -5\n69   69   11  31      0    6\n70   70   11  66      1   -3\n71   71   20  19      0   -6\n72   72   14  73      0   -2\n73   73   13  50      1    5\n74   74   13  63      0    0\n75   75   17  68      1   -2\n76   76   14  53      1   NA\n77   77   12  54      0  -10\n78   78   NA  52      1   -9\n79   79   16  64      0    4\n80   80   NA  61      0   NA\n81   81   19  86      0    6\n82   82   14  69      0    9\n83   83   11  51      0   -4\n84   84   15  65      0    2\n85   85   12  60      0  -10\n86   86   18  73      0    5\n87   87   18  63      0    4\n88   88   16  NA      0   -2\n89   89   12  75      0   -2\n90   90   13  38      0   -9\n91   91   15  62      1   -3\n92   92   14  64      0   15\n93   93   NA  66      1    3\n94   94    9  39      0  -10\n95   95   17  40      0    1\n96   96   11  43      0   NA\n97   97    9  NA      0  -10\n98   98   14  NA      0    3\n99   99   14  42      0   -7\n100 100   15  71      0   -2\n101 101   NA  50      1    0\n102 102   NA  NA      1    1\n103 103   11  54      1    0\n104 104   NA  62      1   NA\n105 105   11  NA      1   -3\n106 106   10  28      0   -8\n107 107   NA  38      1   -8\n108 108   15  45      0    1\n109 109   13  50      0   -3\n110 110   16  38      0    0\n111 111   13  49      0   -5\n112 112    9  NA      0   12\n113 113   10  39      1   -5\n114 114   NA  63      0    2\n115 115   12  81      1    5\n116 116   NA  51      1    2\n117 117    9  36      0   -2\n118 118   15  20      0    0\n119 119   NA  66      1    1\n120 120   NA  22      1   -4\n121 121   18  83      0   12\n122 122   12  83      0   -1\n123 123   12  62      1  -10\n124 124    8  54      0   -3\n125 125   17   0      0   -3\n126 126   16  68      0    7\n127 127   13  71      0    9\n128 128   17  73      0   NA\n129 129   14  52      0    6\n130 130   13  31      0   -3\n131 131   12  55      0    7\n132 132   17  47      0   -5\n133 133   16  68      1    0\n134 134   13  51      0   -5\n135 135   17  34      1   -3\n136 136   13  47      0    9\n137 137   NA  49      0   -4\n138 138   16  45      0   -1\n139 139   NA  32      0   -9\n140 140   NA  58      0    2\n141 141   NA  48      0   NA\n142 142   17  95      0    4\n143 143   14  42      0    4\n144 144   15  NA      0    4\n145 145   15  80      0   -7\n146 146   NA  49      0    0\n147 147   14  NA      1    5\n148 148   18  42      1    9\n149 149   12  30      0    2\n150 150   14  37      0    4\n151 151   16  56      1   NA\n152 152   NA  NA      0   10\n153 153   12  31      0    2\n154 154   16  62      1    0\n155 155   21  66      1    9\n156 156   11  35      0    7\n157 157   NA  59      1    0\n158 158   14  47      1    0\n159 159   19  84      1    2\n160 160   15  54      0    0\n161 161   19  58      1    2\n162 162   13  54      1   -4\n163 163   20  64      0   11\n164 164   10  58      0    3\n165 165   16  47      0   NA\n166 166   16  35      0   NA\n167 167   14  NA      0    4\n168 168   12  63      0   -4\n169 169   13  29      1   -6\n170 170   NA  51      0   -1\n171 171   17  29      0    2\n172 172   NA  42      1   11\n173 173   15  28      0   17\n174 174   NA  39      0   -6\n175 175   16  60      0   NA\n176 176   13  NA      0   -8\n177 177   16  53      0  -10\n178 178   16  43      0   NA\n179 179   NA  45      0   -4\n180 180   12 100      0    1\n181 181   17  36      1    3\n182 182   21  34      0   -3\n183 183   18  70      0   NA\n184 184   11  NA      0   10\n185 185   18  64      0    3\n186 186   10  41      1   NA\n187 187   14  72      1   -3\n188 188   16  69      0   NA\n189 189   19  59      1   -2\n190 190   13  51      0   -5\n191 191   14  53      1    0\n192 192   12  49      0    9\n193 193   18  65      1    1\n194 194   17  49      0    4\n195 195   NA  73      0    1\n196 196   19  33      1    9\n197 197   14  78      0    1\n198 198   NA  71      0   14\n199 199   15  52      0   -2\n200 200   11  55      0   NA\n201 201   NA  41      1   -3\n202 202   12  35      0   -4\n203 203   13  64      1   NA\n204 204   14  31      0    8\n205 205   15  44      1    7\n206 206   NA  45      1   -9\n207 207   NA  36      0    3\n208 208   10  13      0    3\n209 209   11  46      1    5\n210 210   15  72      0   -4\n211 211   13  32      0   NA\n212 212   17  44      1    5\n213 213   12  NA      1    5\n214 214   NA  36      0    6\n215 215   15  55      0   NA\n216 216   19  63      1   -5\n217 217   16  64      0  -10\n218 218   11  41      1   -5\n219 219   10  NA      0   NA\n220 220   17  34      0   12\n221 221   16  76      1  -10\n222 222   11  50      0  -10\n223 223   11  65      0   NA\n224 224   11  51      0    2\n225 225   NA  52      0    2\n226 226   16  25      0   -2\n227 227   15  39      0   -6\n228 228   16  46      0   10\n229 229   11  79      1   -2\n230 230   17  77      1   12\n231 231   15  15      0  -10\n232 232   12  49      1   NA\n233 233   15  70      1    8\n234 234    7  NA      1  -10\n235 235   15  57      0   13\n236 236   11  71      0   -5\n237 237    7  57      0    3\n238 238   12  50      0    0\n239 239   12  48      0    0\n240 240   13  63      0    6\n241 241   13  45      1   -5\n242 242   NA  50      0    3\n243 243   NA  60      0   -3\n244 244   13  36      1   -6\n245 245   14  38      0    9\n246 246   16  57      0    1\n247 247   17  53      0    4\n248 248   20  48      0   11\n249 249   NA  66      1    4\n250 250   15  48      0   -4\n251 251   12  72      1    2\n252 252   15  37      0    7\n253 253   15  70      1   -1\n254 254   11  54      1    0\n255 255    9  37      0   -2\n256 256   11  49      1  -10\n257 257   NA  65      1    0\n258 258   14  65      1   -6\n259 259   13  44      1   -1\n260 260   11  NA      1    8\n261 261   NA  55      0   -2\n262 262   16  67      0   -6\n263 263   15  76      1    2\n264 264   15  NA      1    3\n265 265   NA  52      0    0\n266 266   17  68      1    2\n267 267   NA  68      0   NA\n268 268   NA  71      0   -4\n269 269   11  55      0   -4\n270 270   13  68      0    9\n271 271   12  47      1   -2\n272 272   NA  22      0   NA\n273 273   16  67      1    3\n274 274   10  23      1   -3\n275 275   12  45      1   -8\n276 276   13  NA      1   NA\n277 277   15  54      0   10\n278 278   17  16      1    3\n279 279    6  37      0    5\n280 280   10  43      1    0\n281 281   16  19      0   -1\n282 282   15  61      0   -8\n283 283   12  24      0    9\n284 284    8  44      1   -2\n285 285   12  48      1    2\n286 286   15  51      0   10\n287 287   11  65      0   -5\n288 288   15  78      0    4\n289 289   NA  44      1   -1\n290 290   18  52      1   11\n291 291   15  52      0   NA\n292 292   19  66      0    2\n293 293   NA  53      0    3\n294 294   14  49      1   -4\n295 295   11  35      0   -2\n296 296   13  60      0    5\n297 297   12  NA      0  -10\n298 298   17  45      1    8\n299 299   14  62      0   -1\n300 300   19  NA      0   -9\n301 301   10  30      1   -3\n302 302   NA  44      0    5\n303 303   12  46      1   -2\n304 304   18  NA      1   NA\n305 305   NA  43      0    3\n306 306   16  42      0   -2\n307 307   17  64      0    7\n308 308   16  27      0    6\n309 309   13  58      1   NA\n310 310   17  61      1   -1\n311 311   15  29      1    1\n312 312   18  40      0    1\n313 313   16  47      0    2\n314 314   13  63      0    6\n315 315   13  57      0    3\n316 316   14  54      1    3\n317 317   NA  68      1  -10\n318 318   15  42      1    0\n319 319   NA  70      0   -1\n320 320   11  NA      0   -7\n321 321   NA  69      0    0\n322 322   15  79      0   16\n323 323   14  59      0    0\n324 324   NA  30      0    2\n325 325   11  31      0    3\n326 326   11  63      1    4\n327 327   13  32      1   -1\n328 328    9  59      0   -7\n329 329   NA  66      0   -1\n330 330   21  57      1    7\n331 331   11  30      0    9\n332 332   15  64      1   -5\n333 333   NA  66      0    0\n334 334   14  63      0    3\n335 335   10  23      0    3\n336 336   16  43      0    3\n337 337   10  64      0    3\n338 338   11  27      0    1\n339 339   18  92      1    3\n340 340   20  70      1  -10\n341 341   18  63      0   NA\n342 342   10  74      0    9\n343 343   14  45      1   NA\n344 344   12  50      1   -8\n345 345   13  64      1   NA\n346 346   16  61      0    2\n347 347   NA  24      0    3\n348 348   13  73      0   -7\n349 349   15  39      0   NA\n350 350   NA  65      0   NA\n```\n\n\n:::\n:::\n\n\n\n- Reshape with `pivot_longer()` function and Resulting data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_long <- dat_wide |> \n  pivot_longer(cols = c(perf, use), \n               names_to = \"DV\", \n               values_to = \"score\") |> \n  mutate(dperf = ifelse(DV == 'perf', 0, 1)) # convert DVs into indicator variable - dperf\ndat_long\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 700 × 6\n      id female  cc10 DV    score dperf\n   <int>  <int> <dbl> <chr> <int> <dbl>\n 1     1      1    -1 perf     14     0\n 2     1      1    -1 use      44     1\n 3     2      0    -8 perf     12     0\n 4     2      0    -8 use      77     1\n 5     3      1     2 perf     NA     0\n 6     3      1     2 use      64     1\n 7     4      0    10 perf     19     0\n 8     4      0    10 use      71     1\n 9     5      0     5 perf     12     0\n10     5      0     5 use      48     1\n# ℹ 690 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Path Model VS. Mixed Model\n\n-   Before we dive into mixed models, we will begin with a multivariate regression model:\n    -   Predicting mathematics performance (PERF) with female (F), college math experience (CC), and the interaction between female and college math experience (FxCC)\n    -   Predicting perceived usefulness (USE) with female (F), college math experience (CC), and the interaction between female and college math experience (FxCC)\n\n$$\nPERF_i = \\beta_{0,PERF} + \\beta_{F,PERF} F_i + \\beta_{CC,PERF}CC_i + \\beta_{F*CC,PERF}F_i*CC_i + e_{i,PERF}\n$$ {#eq-pathmodel1} $$\nUSE_i = \\beta_{0,USE} + \\beta_{F,USE} F_i + \\beta_{CC,USE}CC_i + \\beta_{F*CC,USE}F_i*CC_i + e_{i,USE}\n$$ {#eq-pathmodel2}\n\n$$\nScore_i = (\\beta_{0,PERF} + \\beta_{0, dPERF}) + (\\beta_{F,PERF} + \\beta_{F, dPERF}) F_i + (\\beta_{CC,PERF} \\\\ + \\beta_{CC, dPERF}) CC_i + (\\beta_{F*CC,PERF} + \\beta_{F*CC,dPERF}) F_i*CC_i + e_{i,PERF} + e_{i,dPERF}\n$$ {#eq-mixedmodel1}\n\n$$\nScore_i = \\beta_{0,PERF} + \\beta_{0, dPERF}dPERF_i + \\beta_{F,PERF} F_i + \\beta_{F, dPERF}dPERF_i * F_i \\\\ \n+ \\beta_{CC,PERF} CC_i + \\beta_{CC, dPERF} dPERF_i * CC_i \\\\ \n+ \\beta_{F*CC,PERF} F_i*CC_i + \\beta_{F*CC,dPERF} dPERF_i * F_i*CC_i + e_{i,PERF} + e_{i,dPERF}\n$$ {#eq-mixedmodel2}\n\n## Build the Empty Model: Not So Empty\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}