{
  "hash": "2707e9cfeffceb840325bdd915076330",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 04: Distribution and Estimation\"\nauthor: \"Jihong Zhang*, Ph.D; Jinbo He, Ph.D\"\ninstitute: | \n  Educational Statistics and Research Methods (ESRM) Program*\n  \n  University of Arkansas\ndate: \"2024-09-16\"\nsidebar: false\nexecute: \n  echo: true\n  warning: false\noutput-location: column\nformat: \n  html: \n    page-layout: full\n    toc: true\n    toc-depth: 2\n    toc-expand: true\n    lightbox: true\n    code-fold: false\n  uark-revealjs:\n    scrollable: true\n    chalkboard: true\n    embed-resources: false\n    code-fold: false\n    number-sections: false\n    footer: \"ESRM 64503: Lecture 04: Distribution and Estimation\"\n    slide-number: c/t\n    tbl-colwidths: auto\n    output-file: slides-index.html\n---\n\n\n\n\n## Today's Class\n\n-   [The building blocks]{style=\"color: tomato\"}: **The basics of mathematical statistics:**\n\n    -   Random variables: Definition & Types\n\n    -   Univariate distribution\n\n        -   General terminology (e.g., sufficient statistics)\n\n        -   Univariate normal (aka Gaussian)\n\n        -   Other widely used univariate distributions\n\n    -   Types of distributions: Marginal \\| Conditional \\| Joint\n\n    -   Expected values: means, variances, and the algebra of expectations\n\n    -   Linear combinations of random variables\n\n-   [The finished product]{style=\"color: violet\"}: **How the GLM fits within statistics**\n\n    -   The GLM with the normal distribution\n\n    -   The statistical assumptions of the GLM\n\n    -   How to assess these assumptions\n\n# Unit 1: Random Variables & Statistical Distribution\n\n## Definition of Random Variables\n\n[**Random:**]{.underline} situations in which the certainty of the outcome is unkown and is at least in part due to chanvce\n\n[**Variable:**]{.underline} a value that may change give the scope of a given problem or set of operations\n\n[**Random Variable**]{.underline}: a variable whose outcome depends on chance (possible values might represent the possible outcomes of a yet-to-be performed experiment)\n\nToday, we will denote a random variable with a lower-cased: ***x***\n\n## Types of Random Variables\n\n1.  **Continuous**\n    -   Examples of continuous random variables:\n        -   ***x*** represent the height of a person, draw at random\n        -   *Y* (the outcome/DV in a GLM*)*\n        -   Some variables like **exam score or motivation scores** are not \"true\" continuous variables, but it is convenient to consider them as \"continuous\"\n2.  **Discrete** (also called categorical, generally)\n    -   Example of discrete random variables:\n        -   ***x*** represents the gender of a person, drawn at random\n        -   *Y* (outcomes like yes/no; pass/not pass; master / not master a skill; survive / die)\n3.  **Mixture of Continuous and Discrete**:\n    -   Example of mixture: \\begin{equation}\n          x =\n        \\begin{cases}\n          RT & \\text{between 0 and 45 seconds} \\\\\n          0 & \\text{otherwise}\n        \\end{cases}       \n        \\end{equation}\n\n## Key Features of Random Variable\n\n1.  Random variables each are described by a **probability density / mass function (PDF) –** $f(x)$\n\n    -   PDF indicates relative frequency of occurrence\n\n    -   A PDF is a math function that gives rough picture of the distribution from which a random variable is draw\n\n2.  The type of random variable dictates the name and nature of these functions:\n\n    -   [Continuous random variables]{style=\"color: tomato\"}:\n\n        -   $f(x)$ is called a probability density function\n\n        -   Area under curve must equal to 1 (found by calculus integration)\n\n        -   Height of curve (the function value $f(x)$):\n\n            -   Can be any positive number\n\n            -   Reflects relative likelihood of an observation occurring\n\n    -   Discrete random variables:\n\n        -   $f(x)$ is called a probability mass function\n\n        -   Sum across all values must equal 1\n\n------------------------------------------------------------------------\n\n::: {.callout-note style=\"font-size: 1.4em;\"}\nBoth max and min values of temperature look like continuous random variables.\n:::\n\n\n\n\n::: {.cell .column-screen layout-align=\"center\" output-location='default'}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\ntemp <- read.csv(\"data/temp_fayetteville.csv\")\ntemp$value_F <- (temp$value / 10 * 1.8) + 32\ntemp |> \n  ggplot() +\n  geom_density(aes(x = value_F, fill = datatype), col = \"white\", alpha = .8) +\n  labs(x = \"Max/Min Temperature (F) at Fayetteville, AR (Sep-2023)\", \n       caption = \"Source: National Oceanic and Atmospheric Administration (https://www.noaa.gov/)\") +\n  scale_x_continuous(breaks = seq(min(temp$value_F), max(temp$value_F), by = 2)) +\n  scale_fill_manual(values = c(\"tomato\", \"turquoise\")) +\n  theme_classic(base_size = 15) \n```\n\n::: {.cell-output-display}\n![](Lecture04_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n## Other key Terms\n\n-   The sample space is the set of all values that a random variable x can take:\n    -   **Example 1:** The sample space for a random variable x from a normal distribution $x \\sim N(\\mu_x, \\sigma^2_x)$ is $(-\\infty, +\\infty)$.\n    -   **Example 2:** The sample space for a random variable x representing the outcome of a coin flip is {H, T}\n    -   **Example 3:** The sample space for a random variable x representing the outcome of a roll of a die is {1, 2, 3, 4, 5, 6}\n-   When using generalized models, the trick is to pick a distribution with a sample space that matches the range of values obtainable by data\n\n## Uses of Distributions in Data Analysis\n\n-   Statistical models make distributional assumptions on various parameters and / or parts of data\n\n-   These assumptions govern:\n\n    -   How models are estimated\n\n    -   How inferences are made\n\n    -   How missing data may be imputed\n\n-   If data do not follow an assumed distribution, inferences may be inaccurate\n\n    -   Sometimes a very big problem, other times not so much\n\n-   Therefore, it can be helpful to check distributional assumptions prior to running statistical analysis\n\n## Continuous Univariate distributions\n\n-   To demonstrate how continuous distributions work and look, we will discuss three:\n\n    -   Uniform distribution\n\n    -   Normal distribution\n\n    -   Chi-square distribution\n\n-   Each are described a set of parameters, which we will later see are what give us our inferences when we analysis data\n\n-   What we then do is put constraints on those parameters based on hypothesized effects in data\n\n## Uniform distribution\n\n-   The uniform distribution is how to help set up how continuous distributions work\n\n-   For a continuous random variable x that ranges from (a, b), the uniform probability density function is:\n\n    $f(x) = \\frac{1}{b-a}$\n\n-   The uniform distribution has two parameters\n\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    x = seq(0, 3, .1)\n    y = dunif(x, min = 0, max = 3)\n    ggplot() +\n      geom_point(aes(x = x, y = y)) +\n      geom_path(aes(x = x, y = y)) +\n      theme_bw()\n    ```\n    \n    ::: {.cell-output-display}\n    ![](Lecture04_files/figure-html/unnamed-chunk-2-1.png){width=672}\n    :::\n    :::\n\n\n\n\n## More on the Uniform Distribution\n\n-   To demonstrate how PDFs work, we will try a few values:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconditions <- tribble(\n   ~x, ~a, ~b,\n   .5,  0,  1,\n  .75,  0,  1,\n   15,  0, 20,\n   15, 10, 20\n) |> \n  mutate(y = dunif(x, min = a, max = b))\nconditions\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n      x     a     b     y\n  <dbl> <dbl> <dbl> <dbl>\n1  0.5      0     1  1   \n2  0.75     0     1  1   \n3 15        0    20  0.05\n4 15       10    20  0.1 \n```\n\n\n:::\n:::\n\n\n\n\n-   The uniform PDF has the feature that all values of ***x*** are equally likely across the sample space of the distribution\n    -   Therefore, you do not see ***x*** in the PDF $f(x)$\n-   The mean of the uniform distribution is $\\frac{1}{2}(a+b)$\n-   The variance of the uniform distribution is $\\frac{1}{12}(b-a)^2$\n\n## Univariate Normal Distribution\n\n-   For a continuous random variable ***x*** (ranging from $-\\infty$ to $\\infty$), the univariate normal distribution function is:\n\n$$\nf(x) = \\frac1{\\sqrt{2\\pi\\sigma^2_x}}\\exp(-\\frac{(x-\\mu_x)^2}{2\\sigma^2_x})\n$$\n\n-   The shape of the distribution is governed by two parameters:\n\n    -   The mean $\\mu_x$\n\n    -   The variance $\\sigma^2_x$\n\n    -   These parameters are called **sufficient statistics** (they contain all the information about the distribution)\n\n-   The skewness (lean) and kurtosis (peakedness) are fixed\n\n-   Standard notation for normal distributions is $x\\sim N(\\mu_x, \\sigma^2_x)$\n\n    -   Read as: \"*x* follows a normal distribution with a mean $\\mu_x$ and a variance $\\sigma^2_x$\"\n\n-   Linear combinations of random variables following normal distributions result in a random variable that is normally distributed\n\n## Univariate Normal Distribution in R: pnorm\n\nDensity (`dnorm`), distribution function (`pnorm`), quantile function (`qnorm`) and random generation (`rnorm`) for the normal distribution with mean equal to `mean` and standard deviation equal to `sd`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nZ = seq(-5, 5, .1) # Z-score\nggplot() +\n  aes(x = Z, y = pnorm(q = Z, lower.tail = TRUE)) +\n  geom_point() +\n  geom_path() +\n  labs(x = \"Z-score\", y = \"Cumulative probability\",\n       title = \"`pnorm()` gives the cumulative probability function P(X < T)\")\n```\n\n::: {.cell-output-display}\n![](Lecture04_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n## Univariate Normal Distribution in R: dnorm\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- seq(-5, 5, .1)\n\nparams <- list(\n  y_set1 = c(mu =  0, sigma2 = 0.2),\n  y_set2 = c(mu =  0, sigma2 = 1.0),\n  y_set3 = c(mu =  0, sigma2 = 5.0),\n  y_set4 = c(mu = -2, sigma2 = 0.5)\n)\n\ny <- sapply(params, function(param) dnorm(x, mean = param['mu'], sd = param['sigma2']))\n\ndt <- cbind(x, y) |> \n  as.data.frame() |> \n  pivot_longer(starts_with(\"y_\"))\n\nggplot(dt) +\n  geom_path(aes(x = x, y = value, color = name, group = name), linewidth = 1.3) +\n  scale_color_manual(values = 1:4,\n                     name = \"\",\n                     labels = c('y_set1' = expression(mu*\"=0, \"*sigma^2*\"=.02\"),\n                                'y_set2' = expression(mu*\"=0, \"*sigma^2*\"=1.0\"),\n                                'y_set3' = expression(mu*\"=0, \"*sigma^2*\"=5.0\"),\n                                'y_set4' = expression(mu*\"=-2, \"*sigma^2*\"=0.5\"))\n                     ) +\n  theme_bw() +\n  theme(legend.position = \"top\", text = element_text(size = 13))\n```\n\n::: {.cell-output-display}\n![](Lecture04_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n## Chi-Square Distribution\n\n-   Another frequently used univariate distribution is the Chi-square distribution\n\n    -   Sampling distribution of the variance follows a chi-square distribution\n\n    -   Likelihood ratios follow a chi-square distribution\n\n-   For a continuous random variable *x* (ranging from 0 to $\\infty$), the chi-square distribution is given by:\n\n    $$\n    f(x) =\\frac1{2^{\\frac{\\upsilon}{2}} \\Gamma(\\frac{\\upsilon}{2})} x^{\\frac{\\upsilon}{2}-1} \\exp(-\\frac{x}2)\n    $$\n\n-   $\\Gamma(\\cdot)$ is called the gamma function\n\n-   The chi-square distribution is govern by one parameter: $\\upsilon$ (the degrees of freedom)\n\n    -   The mean is equal to $\\upsilon$; the variance is equal to 2$\\upsilon$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- seq(0.01, 15, .01)\ndf <- c(1, 2, 3, 5, 10)\ndt2 <- as.data.frame(sapply(df, \\(df) dchisq(x, df = df)))\ndt2_with_x <- cbind(x = x, dt2)\ndt2_with_x |> \n  pivot_longer(starts_with(\"V\")) |> \n  ggplot() +\n  geom_path(aes(x = x, y = value, color = name), linewidth = 1.2) +\n  scale_y_continuous(limits = c(0, 1)) +\n  scale_color_discrete(name = \"\", labels = paste(\"df =\", df)) +\n  labs(y = \"f(x)\") +\n  theme_bw() +\n  theme(legend.position = \"top\", text = element_text(size = 13))\n```\n\n::: {.cell-output-display}\n![](Lecture04_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Lecture04_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}