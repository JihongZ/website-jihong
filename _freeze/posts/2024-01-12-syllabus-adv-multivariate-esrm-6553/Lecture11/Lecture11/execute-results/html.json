{
  "hash": "42ab7457a652906714ab12d74fb04ef3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 11\"\nsubtitle: \"Multidimensionality and Missing Data\"\nauthor: \"Jihong Zhang\"\ninstitute: \"Educational Statistics and Research Methods\"\ntitle-slide-attributes:\n  data-background-image: ../Images/title_image.png\n  data-background-size: contain\nexecute: \n  echo: false\n  eval: false\nformat: \n  revealjs:\n    logo: ../Images/UA_Logo_Horizontal.png\n    incremental: false  # choose \"false \"if want to show all together\n    transition: slide\n    background-transition: fade\n    theme: [simple, ../pp.scss]\n    footer:  <https://jihongzhang.org/posts/2024-01-12-syllabus-adv-multivariate-esrm-6553>\n    scrollable: true\n    slide-number: true\n    chalkboard: true\n    number-sections: false\n    code-line-numbers: true\n    code-annotations: below\n    code-copy: true\n    code-summary: ''\n    highlight-style: arrow\n    view: 'scroll' # Activate the scroll view\n    scrollProgress: true # Force the scrollbar to remain visible\n    mermaid:\n      theme: neutral\n    include-in-header:\n      - macros.tex\n#bibliography: references.bib\n---\n\n\n\n## Previous Class\n\n1.  Show how to estimate unidimensional latent variable models with polytomous data\n    -   Also know as [Polytomous]{.underline} I[tem response theory]{.underline} (IRT) or [Item factor analysis]{.underline} (IFA)\n2.  Distributions appropriate for polytomous (discrete; data with lower/upper limits)\n\n## Today's Lecture Objectives\n\n1.  How to model multidimensional factor structures\n2.  Show how to estimate models with missing data\n\n## Example Data: Conspiracy Theories\n\n-   Today's example is from a bootstrap resample of 177 undergraduate students at a large state university in the Midwest.\n-   The survey was a measure of 10 questions about their beliefs in various conspiracy theories that were being passed around the internet in the early 2010s\n-   All item responses were on a 5-point Likert scale with:\n    1.  Strong Disagree\n    2.  Disagree\n    3.  Neither Agree nor Disagree\n    4.  Agree\n    5.  Strongly Agree\n-   The purpose of this survey was to study individual beliefs regarding conspiracies.\n-   Our purpose in using this instrument is to provide a context that we all may find relevant as many of these conspiracies are still prevalent.\n\n# Multidimensionality\n\n## More than one Latent Variable - Latent Parameter Space\n\nWe need to create latent variables by specifying which items measure which latent variables in an analysis model\n\n-   This procedure Called different names by different fields:\n\n    -   Alignment (education measurement)\n\n    -   Factor pattern matrix (factor analysis)\n\n    -   Q-matrix (Question matrix; diagnostic models and multidimensional IRT)\n\n## From Q-matrix to Model\n\nThe alignment provides a specification of which latent variables are measured by which items\n\n-   Sometimes we say items \"load onto\" factors\n\nThe math definition of either of these terms is simply whether or not a latent variable appears as a predictor for an item\n\n-   For instance, item one appears to measure nongovernment conspiracies, meaning its alignment (row vector of the Q-matrix)\n\n    ```{.r}\n             Gov NonGov \n    item1     0      1 \n    ```\n\n## From Q-matrix to Model (Cont.)\n\nThe model for the first item is then built with only the factors measured by the item as being present:\n\n$$\nf(E(Y_{p1}|\\boldsymbol{\\theta_p})=\\mu_1 + \\boldsymbol{0}*\\lambda_{11}\\theta_{p1} +\\boldsymbol{1}*\\lambda_{21}\\theta_{p2} \\\\=\\mu_1 + \\lambda_{21}\\theta_{p2} \n$$\n\nWhere:\n\n-   $\\mu_1$ is the item intercept\n\n-   $\\lambda_{\\bf{1}1}$ is the factor loading for item 1 (the first subscript) loaded on factor 1 (the second subscript)\n\n-   $\\theta_{p1}$ is the value of the latent variable for person *p* and factor 1\n\nThe second factor is not included in the model for the item\n\n## More Q-matrix\n\nWe could generalize the previous function with Q-matrix\n\n$$\nQ=\\begin{bmatrix}q_{11}\\ \\ \\ 0\\\\0\\ \\ \\  q_{12}\\end{bmatrix}\n$$\n\n$$\n\\begin{align}\nf(E(Y_{p1}|\\boldsymbol{\\theta_p})\n&=\\mu_1+q_{11}(\\lambda_{11}\\theta_{p1})+q_{12}(\\lambda_{12}\\theta_{p2})\\\\\n&= \\mu_1 + \\boldsymbol{\\theta_p\\text{diag}(q)\\lambda}\n\\end{align} \n$$\n\nWhere:\n\n-   \\$\\\\lambda_1\\$ = $\\bb{Q}$ contains all possible factor loadings for item 1 (size 2 $\\times$ 1)\n\n-   $\\theta_p$\n\n# Missing Data\n\n## Dealing with Missing Data in Stan\n\nIf you ever attempted to analyze missing data in `Stan`, you likely received an error message:\n\n`Error: Variable 'Y' has NA values.`\n\nThat is because, by default, `Stan` does not model missing data\n\n-   Instead, we have to get `Stan` to work with the data we have (the values that are not missing)\n\n-   That does not mean remove cases where any observed variables are missing\n\n## Example Missing Data\n\nTo make things a bit easier, I'm only turning one value into missing data (the first person's response to the first item)\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Import data ===============================================================================\ndat <- read.csv(here(root_dir, 'conspiracies.csv'))\nconspiracyItems <- dat[,1:10]\ncolnames(conspiracyItems) <- paste0('item', 1:10)\n\n# make some cases missing for demonstration:\nconspiracyItems[1,1] = NA\n```\n:::\n\n\n\nNote that all code will work with as missing as you have\n\n-   Observed variables do have to have some values that are not missing\n\n## Resources\n\n-   [Dr. Templin's slide](https://jonathantemplin.github.io/Bayesian-Psychometric-Modeling-Course-Fall2022/lectures/lecture04e/04e_Modeling_Multidimensional_Latent_Variables#/from-q-matrix-to-model-1)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}