{
  "hash": "e90868c8314db7462c2223b102540b85",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 12: ANCOVA\"\nsubtitle: \"Experimental Design in Education\"\ndate: \"2025-04-09\"\ndate-modified: \"2025-11-12\"\nexecute:\n  eval: true\n  echo: true\n  warning: false\n  message: false\nwebr:\n  editor-font-scale: 1.2\nformat:\n  html:\n    toc-expand: 3\n    code-tools: false\n    code-line-numbers: false\n    code-fold: false\n    code-summary: \"Click to see R code\"\n    number-sections: true\n    fig.width: 10\n    fig-align: center\n    message: false\n    grid:\n      sidebar-width: 350px\n  uark-revealjs:\n    chalkboard: true\n    embed-resources: false\n    code-fold: false\n    number-sections: true\n    number-depth: 1\n    footer: \"ESRM 64103\"\n    slide-number: c/t\n    tbl-colwidths: auto\n    scrollable: true\n    output-file: slides-index.html\n    mermaid:\n      theme: forest\n---\n\n::: objectives\n## Overview of Lecture 12 {.unnumbered}\n\n1.  What is ANCOVA?\n2.  Why use ANCOVA?\n3.  How to use ANCOVA (e.g., assumptions, hypothesis setup)?\n4.  Potential issues of using ANCOVA.\n:::\n\n# Introduction\n\n## Introduction: Overview of Other Designs\n\n-   **The ANOVA designs we have been talking about use experimental control (e.g., our research design) in order to reduce error variance.**\n    -   ✔ Example: In the one-way ANOVA tutoring example, we posited that there might be another factor explaining math scores beyond the tutoring program (factor A).\n    -   ✔ Thus, we also looked at school type (factor B) to help reduce the error variance.\n-   **Other examples to reduce error variance:**\n    -   ✔ Blocking (analyzing blocks of experimental units – levels of IVs)\n    -   ✔ Between-subjects design (i.e., N-way ANOVA)\n    -   ✔ Within-subjects design (i.e., repeated measures)\n\n## Introduction: ANCOVA\n\n::: rmdquote\nANOVA is Analysis of Variance\n\n**ANCOVA is Analysis of Covariance**\n:::\n\n-   Today we focus on **statistical control to reduce error variance**.\n\n-   Statistical control is used when we know a subject’s score on an additional variable.\n\n    -   When we discussed blocking designs, the control variable was categorical (e.g., school, class).\n    -   But for **ANCOVA**, it is a **continuous** covariate!\n        -   e.g., students’ academic motivation, engagement, baseline math proficiency.\n\n::: rmdnote\n- What is \"covariate\"?\n\n  - A covariate is an observed predictor not of primary interest, included to explain additional variance in the dependent variable.\n  - In ANCOVA, covariates are modeled linearly and are assumed to be measured prior to or independent of treatment assignment.\n  - Including covariates reduces residual error and adjusts group means, improving precision when assumptions hold (e.g., no treatment–covariate interaction, reliable measurement).\n  - Example (one‑way ANCOVA): `E[Y | Group, X] = α + τ_Group + βX`, where `X` is the covariate, `τ_Group` are group effects, and `β` is the common slope.\n:::\n\n-   **ANCOVA** by definition is a general linear model that includes both:\n\n    -   **ANOVA (categorical)** predictors\n    -   **Regression (continuous)** predictors\n\n## ANCOVA: Example\n\n-   We are interested in\n\n    -   Comparing the ***method of instruction*** on students’ ***mathematical problem‑solving performance***, as measured by a test score.\n\n        -   The test is composed of word problems that are each presented in a few sentences.\n            -   **Ex**: “Joe buys 60 cantaloupes and sells 5. He then gives away 4…”\n            -   **DV** = number of problems correctly answered in an hour.\n            -   **IV** = method of instruction (three levels)\n\n-   *One-way, independent ANOVA*: If the omnibus F is significant, we conclude that ***the instructional methods differ in the mean number of correctly answered problems***.\n\n-   [But]{.bigger}, performance on math word problems may be affected by factors beyond instructional method and math ability.\n\n    -   To name a few: academic motivation scores, verbal proficiency scores, hunger ratings, previous years’ math grades…\n\n-   The DV score results from instructional method + the other factors we just listed.\n\n    -   We really want to ask:\n\n        > To what extent would we have observed ***instructional‑method differences in math scores if the groups had been equivalent in motivation*** (or verbal proficiency)?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-1-1.png){width=1152}\n:::\n:::\n\n\n\n## ANCOVA definition\n\n-   ANCOVA is one way to investigate the group (treatment) effect controlling for some relevant covariates.\n-   Incorporates information on additional variables (e.g., motivation) directly into the model.\n    -   **To estimate differences in math word‑problem performance as if the groups were equivalent in baseline motivation**.\n-   When comparing groups, we claim that people vary in their scores on the DV for a variety of reasons:\n    -   **Treatment Effects (i.e., group differences)** - Ex: Instructional Method\n    -   **Individual Differences** - Ex: Individuals vary in their motivation to do well on the math test\n    -   **Measurement Error** - Ex: The math assessment is unreliable\n    -   These two sources (Individual differences and measurement error) contribute to:\n        -   ***Experimental Error***\n        -   *(both of these go into* $SS_{\\text{Error}}$)\n\n## ANCOVA Advantage\n\n-   **Reduces Error Variance**\n    -   By explaining some of the unexplained variance ($SS_{\\text{error}}$), the error variance in the model can be reduced.\n    -   Think of the pie charts below!\n    \n-   **Greater Experimental Control**\n    -   By controlling known extraneous variables, we gain greater insight into the effect of the predictor (IV) variable(s).\n\n\n::: {.cell layout-nrow=\"2\"}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-dfd8c286450adf951d09\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-dfd8c286450adf951d09\">{\"x\":{\"visdat\":{\"18c552b1a4734\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"18c552b1a4734\",\"attrs\":{\"18c552b1a4734\":{\"labels\":[\"A\",\"Error (Not explained by A)\"],\"values\":[25,75],\"title\":\"ONE-WAY ANOVA\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"pie\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":{\"text\":\"ONE-WAY ANOVA\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"labels\":[\"A\",\"Error (Not explained by A)\"],\"values\":[25,75],\"title\":\"ONE-WAY ANOVA\",\"type\":\"pie\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"line\":{\"color\":\"rgba(255,255,255,1)\"}},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-1eed53714473009b5a7e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1eed53714473009b5a7e\">{\"x\":{\"visdat\":{\"18c5562b21d1b\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"18c5562b21d1b\",\"attrs\":{\"18c5562b21d1b\":{\"labels\":[\"A\",\"Cov\",\"Error (Not explained by A, Cov, A*Cov)\"],\"values\":[25,15,60],\"title\":\"ANCOVA\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"pie\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":{\"text\":\"ANCOVA\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"labels\":[\"A\",\"Cov\",\"Error (Not explained by A, Cov, A*Cov)\"],\"values\":[25,15,60],\"title\":\"ANCOVA\",\"type\":\"pie\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"line\":{\"color\":\"rgba(255,255,255,1)\"}},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n----\n\n## What covariate can be added?\n\n::::: columns\n-   **Including a covariate adjusts the groups’ means as if they were equivalent on the covariate.**\n\n-   The analyses addressed different research questions!\n\n    -   Ex. Ignoring the impact of height\\\n        ➔ $H_0\\!: \\mu_A = \\mu_B = \\mu_C$\n    -   Considering height (ANCOVA): adjusted means\\\n        ➔ $H_0\\!: \\text{Adj}_{\\mu_A} = \\text{Adj}_{\\mu_B} = \\text{Adj}_{\\mu_C}$\n\n::: column\n-   If there is no random assignment to treatments, use ANCOVA with caution.\n    -   Pre‑existing differences may render the “as if equivalent” interpretation untenable.\n:::\n\n::: column\n\n::: {.cell}\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n:::\n:::::\n\n## ANCOVA: Backrgound of Example Case\n\n-   Consider a scenario in which a school principal wants to evaluate the effectiveness of teaching methods in math courses.\n-   The principal would like to gauge the effectiveness of the following three types of instruction:\n    -   Type 1: Lecture-only,\n    -   Type 2: Lecture + hands-on activities,\n    -   Type 3: Self-paced instruction\n-   The principal randomly assigned 200 students to one of the three instructional methods and measured performance on an end‑of‑semester achievement test (out of 100 points).\n-   One researcher suggested that the principal also want to **statistically control for students’ ability (covariate)**:\n\n::: rmdquote\nEach student also completed a math pre‑test (an indicator of baseline ability), so the principal included pre‑test scores as the covariate.\n:::    \n\n## ANCOVA: Example Data\n\nIn this example, we will simulate data for 200 students who were randomly assigned to one of three teaching methods. \n\nThe pre-test scores will be used as a covariate in the ANCOVA analysis. \n\nThe post-test scores will be generated based on the pre-test scores and the teaching method.\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| student_id|method     | pretest| posttest|\n|----------:|:----------|-------:|--------:|\n|          1|lecture    |    68.9|     70.9|\n|          2|hands-on   |    66.1|     62.8|\n|          3|lecture    |    61.6|     53.5|\n|          4|self-paced |    72.5|     85.8|\n|          5|hands-on   |    64.9|     73.1|\n\n\n:::\n:::\n\n\n```{webr-r}\n#| echo: false\n#| context: setup\n# Simulate data\n# Load necessary packages\nlibrary(dplyr)\n\n# Set seed for reproducibility\nset.seed(2025)\n\n# Total number of students\nn_students <- 200\n\n# Assign students randomly to one of the three teaching methods\nteaching_methods <- c(\"lecture\", \"hands-on\", \"self-paced\")\ngroup <- sample(teaching_methods, n_students, replace = TRUE)\n\n# Simulate pre-test scores (covariate): assume normal distribution\npretest <- rnorm(n_students, mean = 65, sd = 6)\n\n# Define group-specific effects (adjusted for covariate)\ngroup_effects <- data.frame(\n  method = teaching_methods,\n  intercept = c(20, 25, 23),  # baseline group effect\n  slope = c(0.7, 0.7, 0.7)    # assume equal slopes for ANCOVA assumption\n)\n\n# Generate post-test scores based on pretest + method-specific effect + error\ndf <- data.frame(student_id = 1:n_students,\n                   method = factor(group, levels = teaching_methods),\n                   pretest = pretest) %>%\n  left_join(group_effects, by = c(\"method\" = \"method\")) %>%\n  mutate(\n    error = rnorm(n_students, mean = 0, sd = 5),\n    posttest = intercept + slope * pretest + error\n  ) %>%\n  select(student_id, method, pretest, posttest)\n```\n\n```{webr-r}\nhead(df)\ntable(df$method)\ncor(df$pretest, df$posttest)\n```\n\n# ANCOVA: Assumption Check\n\n## ANCOVA: Assumption Check I\n\n**Assumption Check in ANCOVA:**\n\n➤ **The three usual ANOVA assumptions apply:**\n\n-   Independency\n-   Normality (within-group; for each group)\n-   Equality of variance (homogeneity of variance)\n\n➤ **Three additional data considerations:**\n\n-   Linear relationship between the covariate & DV\n-   Homogeneity of Regression Slope\n-   Covariate is measured without error\n\n## ANCOVA: Assumption Check II\n\n-   **Assumption Check in ANCOVA:**\n\n1.  **Linear relationship between the covariate & DV:**\n\n---\n\n::: rmdnote\nBy looking over the plot, we can find that there is a general linear relationship (i.e., straight line) between the covariate (pretest) and the DV (mathtest).\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"R code to check linear relationship\"}\n# Plot\nggplot(df, aes(x = pretest, y = posttest)) +\n  geom_point(color = \"blue\", alpha = 0.6) +\n  geom_smooth(method = \"lm\", color = \"steelblue\", se = FALSE) +\n  theme_minimal(base_size = 14) +\n  labs(x = \"pretest\", y = \"mathtest\") +\n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(title = NULL))\n```\n\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## ANCOVA: Assumption Check III\n\n-   **Assumption Check in ANCOVA:**\n\n2.  **Homogeneity of Regression Slope:**\n\n::: rmdnote\n-   **The relationship between each covariate and the DV should be the same for each level of the IV.**\n    -   Conceptually, this is the interaction between the IV and the covariate.\n    -   *We don’t want this in ANCOVA!*\n    -   This assumption limits the applicability of ANCOVA\n:::\n\n---\n\n\n::: {.cell}\n\n```{.python .cell-code  code-fold=\"true\" code-summary=\"Example Python code to check homogeneity of regression slope\"}\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Generate x values (covariate)\nx = np.linspace(0, 10, 100)\n\n# Homogeneous regression slopes\ny1_homo = 1.0 * x + 2\ny2_homo = 1.0 * x + 4\ny3_homo = 1.0 * x + 6\n\n# Heterogeneous regression slopes\ny1_hetero = -0.1 * x + 6\ny2_hetero = 1.2 * x + 1\ny3_hetero = 0.9 * x + 3\n\n# Create the figure with two subplots\nfig, axs = plt.subplots(1, 2, figsize=(12, 5), sharey=True)\n\n# Plot for homogeneous regression slopes\naxs[0].plot(x, y1_homo, label=\"Group 1\")\naxs[0].plot(x, y2_homo, label=\"Group 2\")\naxs[0].plot(x, y3_homo, label=\"Group 3\")\naxs[0].set_title(\"(a) Homogeneity of regression (slopes)\")\naxs[0].set_xlabel(\"Covariate (X)\")\naxs[0].set_ylabel(\"DV (Y)\")\naxs[0].legend()\n\n# Plot for heterogeneous regression slopes\naxs[1].plot(x, y1_hetero, label=\"Group 1\")\naxs[1].plot(x, y2_hetero, label=\"Group 2\")\naxs[1].plot(x, y3_hetero, label=\"Group 3\")\naxs[1].set_title(\"(b) Heterogeneity of regression (slopes)\")\naxs[1].set_xlabel(\"Covariate (X)\")\naxs[1].legend()\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-7-1.png){width=1152}\n:::\n:::\n\n\n## ANCOVA: Assumption Check IV\n\n-   **Assumption Check in ANCOVA:**\n\n2.  **Homogeneity of Regression Slope:**\n\n➤ This is equivalent to saying that the relationship between the DV and the covariate must be the same for each cell (i.e., group).\n\n-   [x] The slope value – *b* – that we use to make the adjustment is the same\n\n➤ Consequences depend on whether cells have equal sample sizes and whether a true experiment\n\n-   [x] *With equal sample sizes in a true experiment, ANCOVA is relatively robust to modest violations of this assumption.*\n-   [x] *With unequal sample sizes (or in quasi‑experimental designs), the adjusted means may be materially biased.*\n\n## ANCOVA: Assumption Check V\n\n-   **Assumption Check in ANCOVA:**\n\n2.  **Homogeneity of Regression Slope:**\n\n::: rmdnote\nWhen we visually inspect the three regression slopes (covariate predicting the DV), the relationships appear approximately equal.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"R code to check homogeneity of regression slope\"}\n# Plot\nggplot(df, aes(x = pretest, y = posttest, color = method)) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  scale_color_manual(values = c(\"steelblue\", \"tomato\", \"seagreen4\")) +\n  theme_minimal(base_size = 14) +\n  labs(x = \"pretest\", y = \"mathtest\") +\n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(title = NULL))\n```\n\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n:::\n\n\n## ANCOVA: Assumption Check VI\n\n-   **Assumption Check in ANCOVA:**\n\n2.  **Homogeneity of Regression Slope:**\n\n➤ **Formal approach to checking homogeneity of regression slopes:**\n\n1.  Run the model **with the interaction** term included to make sure it is negligible (a.k.a., not significant) → this is *not* the ANCOVA yet!\n\n$SS_{total} = SS_{IV} + SS_{COV} + \\color{red}{SS_{IV*COV}} + SS_{within}$\n\n2.  If negligible (i.e., not significant), re‑run the ANCOVA **without the interaction** term to obtain the final estimates to interpret → this is the ANCOVA model.\n\n$SS_{total} = SS_{IV} + SS_{COV} + SS_{within}$\n\n## ANCOVA: Assumption Check VII\n\n2.  **Homogeneity of Regression Slope:** ➤ **The formal/general method of checking homogeneity of regression slope:**\n\n3.  Run the model **with the interaction** term included to make sure it is negligible (a.k.a., not significant) → this is *not* the ANCOVA yet!\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(gt)\nlibrary(tidyverse)\nres <- anova(lm(posttest~pretest*method, data=df))\nres_tbl <- res |>\n  as.data.frame() |>\n  rownames_to_column(\"Coefficient\")\nres_gt_display <- gt(res_tbl) |>\n  fmt_number(\n    columns = `Sum Sq`:`Pr(>F)`,\n    suffixing = TRUE,\n    decimals = 3\n  )\nres_gt_display|>\n  tab_style( # style for versicolor\n    style = list(\n      cell_fill(color = \"royalblue\"),\n      cell_text(color = \"red\", weight = \"bold\")\n    ),\n    locations = cells_body(\n        columns = colnames(res_tbl),\n        rows = Coefficient == \"pretest:method\")\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ycgfkvjntr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ycgfkvjntr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ycgfkvjntr thead, #ycgfkvjntr tbody, #ycgfkvjntr tfoot, #ycgfkvjntr tr, #ycgfkvjntr td, #ycgfkvjntr th {\n  border-style: none;\n}\n\n#ycgfkvjntr p {\n  margin: 0;\n  padding: 0;\n}\n\n#ycgfkvjntr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ycgfkvjntr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ycgfkvjntr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ycgfkvjntr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ycgfkvjntr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ycgfkvjntr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ycgfkvjntr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ycgfkvjntr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ycgfkvjntr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ycgfkvjntr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ycgfkvjntr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ycgfkvjntr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ycgfkvjntr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ycgfkvjntr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ycgfkvjntr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ycgfkvjntr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ycgfkvjntr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ycgfkvjntr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ycgfkvjntr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ycgfkvjntr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_left {\n  text-align: left;\n}\n\n#ycgfkvjntr .gt_center {\n  text-align: center;\n}\n\n#ycgfkvjntr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ycgfkvjntr .gt_font_normal {\n  font-weight: normal;\n}\n\n#ycgfkvjntr .gt_font_bold {\n  font-weight: bold;\n}\n\n#ycgfkvjntr .gt_font_italic {\n  font-style: italic;\n}\n\n#ycgfkvjntr .gt_super {\n  font-size: 65%;\n}\n\n#ycgfkvjntr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ycgfkvjntr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ycgfkvjntr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ycgfkvjntr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ycgfkvjntr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ycgfkvjntr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ycgfkvjntr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ycgfkvjntr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ycgfkvjntr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Df\">Df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sum-Sq\">Sum Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean-Sq\">Mean Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F-value\">F value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pr(&gt;F)\">Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">pretest</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">150.059</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">method</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">726.111</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">363.055</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">14.436</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">pretest:method</td>\n<td headers=\"Df\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">2</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">66.190</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">33.095</td>\n<td headers=\"F value\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">1.316</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">0.271</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">Residuals</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">194</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">4.879K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">25.148</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">NA</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n2.  IF negligible (a.k.a., not significant), re-run the ANCOVA **without the interaction** term to get the final values to interpret → this *is* the ANCOVA model.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nres <- anova(lm(posttest~pretest+method, data=df))\nres_tbl <- res |>\n  as.data.frame() |>\n  rownames_to_column(\"Coefficient\")\nres_gt_display <- gt(res_tbl) |>\n  fmt_number(\n    columns = `Sum Sq`:`Pr(>F)`,\n    suffixing = TRUE,\n    decimals = 3\n  )\nres_gt_display|>\n  tab_style( # style for versicolor\n    style = list(\n      cell_fill(color = \"royalblue\"),\n      cell_text(color = \"red\", weight = \"bold\")\n    ),\n    locations = cells_body(\n        columns = colnames(res_tbl),\n        rows = Coefficient == \"method\")\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"etakirvmkn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#etakirvmkn table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#etakirvmkn thead, #etakirvmkn tbody, #etakirvmkn tfoot, #etakirvmkn tr, #etakirvmkn td, #etakirvmkn th {\n  border-style: none;\n}\n\n#etakirvmkn p {\n  margin: 0;\n  padding: 0;\n}\n\n#etakirvmkn .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#etakirvmkn .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#etakirvmkn .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#etakirvmkn .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#etakirvmkn .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#etakirvmkn .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#etakirvmkn .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#etakirvmkn .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#etakirvmkn .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#etakirvmkn .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#etakirvmkn .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#etakirvmkn .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#etakirvmkn .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#etakirvmkn .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#etakirvmkn .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#etakirvmkn .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#etakirvmkn .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#etakirvmkn .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#etakirvmkn .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#etakirvmkn .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_left {\n  text-align: left;\n}\n\n#etakirvmkn .gt_center {\n  text-align: center;\n}\n\n#etakirvmkn .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#etakirvmkn .gt_font_normal {\n  font-weight: normal;\n}\n\n#etakirvmkn .gt_font_bold {\n  font-weight: bold;\n}\n\n#etakirvmkn .gt_font_italic {\n  font-style: italic;\n}\n\n#etakirvmkn .gt_super {\n  font-size: 65%;\n}\n\n#etakirvmkn .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#etakirvmkn .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#etakirvmkn .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#etakirvmkn .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#etakirvmkn .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#etakirvmkn .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#etakirvmkn .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#etakirvmkn .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#etakirvmkn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Df\">Df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sum-Sq\">Sum Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean-Sq\">Mean Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F-value\">F value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pr(&gt;F)\">Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">pretest</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">149.576</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">method</td>\n<td headers=\"Df\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">2</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">726.111</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">363.055</td>\n<td headers=\"F value\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">14.390</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">Residuals</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">196</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">4.945K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">25.230</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">NA</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n## ANCOVA: Assumption Check VIII\n\n-   **Assumption Check in ANCOVA:**\n\n3.  **Covariate is measured without error:**\n\n➤ **Reliability of Covariates** \n\n  - ✓ Because covariates are used to linearly predict the DV, measurement error in the covariate is not modeled (unlike the DV). \n  - ✓ Thus, ANCOVA assumes covariates are measured without error. \n    - ➔ You will cover reliability of measures in detail in measurement theory; here we simply note its importance.\n\n➤ **The reliability of covariate scores is crucial with ANCOVA**\n\n| True Experimental Design | Quasi-Experimental Design |\n|-----------------------------------|-------------------------------------|\n| \\- Relationship between covariate and DV underestimated, resulting in less adjustment than is necessary | \\- Relationship between covariate and DV underestimated, resulting in less adjustment than is necessary |\n| \\- Less powerful *F* test | \\- *Group effects (IV) may be seriously biased* |\n\n# Hypothesis Test\n\n## ANCOVA: Hypothesis Test I\n\n**\\[Example\\] Step #1**\n\n-   **Research (alternative) hypothesis**\n    -   [x] $H_A$: *Controlling for pretest*, the **adjusted** means of math scores among three instructional groups will differ.\n-   **Null hypothesis**\n    -   [x] $H_0$: *Controlling for pre-test*, there is no difference between the **adjusted** means of math scores among three instructional groups.\\\n        $\\Rightarrow H_0: \\text{adjusted } \\mu_{\\text{lecture}} = \\text{adjusted } \\mu_{\\text{hands-on}} = \\text{adjusted } \\mu_{\\text{self-paced}}$\n\n------------------------------------------------------------------------\n\n### ANCOVA: Definition of Adjusted Means\n\n-   **Adjusted cell means** are the observed cell mean minus a weighted within-cell deviation of the covariate values from the covariate cell means.\n    -   [x] When we do the adjustment, this is what happens:\n\n$$\n\\bar{Y}_{\\text{adjusted}} = \\bar{Y}_{\\text{original}} - b (\\bar{X}_{\\text{cell}} - \\bar{X}_{\\text{grand}})\n$$\n\n-   *b* is the pooled slope for the simple regression of the DV on the covariate\\\n\n-   *X* is the covariate (cell mean and grand mean)\\\n\n-   *Y* is the dependent variable (adjusted and unadjusted cell means)\n\n-   If *b* is zero (relationship is zero) then there is no adjustment.\n\n-   The bigger *b* is (the stronger the covariate/DV relationship), the more of an adjustment.\n\n➔ **The farther a cell’s covariate mean is from the grand covariate mean (the larger the deviation), the greater the adjustment to its outcome mean.**\n\n------------------------------------------------------------------------\n\n### ANCOVA: Formula of Adjusted Means\n\nBased on the ANCOVA adjusted means *formula*:\n\n$$\n\\bar{Y}_{\\text{adjusted}} = \\bar{Y}_{\\text{original}} - b (\\bar{X}_{\\text{cell}} - \\bar{X}_{\\text{grand}})\n$$\nWe can compute the adjusted means for each group using the following steps:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"R code to compute adjusted means\"}\n# Unadjusted means of posttest by group\nunadjusted_means <- df %>%\n  group_by(method) %>%\n  summarise(posttest_mean = mean(posttest))\n\n# Pretest means by group\npretest_means <- df %>%\n  group_by(method) %>%\n  summarise(pretest_mean = mean(pretest))\n\n# Grand mean of pretest\ngrand_pretest_mean <- mean(df$pretest)\n\n# Fit linear model to get pooled regression slope\nmodel <- lm(posttest ~ pretest, data = df)\n\n# Extract slope\npooled_slope <- coef(model)[\"pretest\"]\n\n# Combine into one table\nresults <- left_join(unadjusted_means, pretest_means, by = \"method\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"R code to display adjusted means as a table\"}\n# Calculate adjusted means using the ANCOVA adjustment formula\nresults2 <- results |>\n  mutate(grand_pretest_mean = grand_pretest_mean) |>\n  mutate(pooled_slope = pooled_slope) |>\n  mutate(adjusted_mean = posttest_mean - pooled_slope * (pretest_mean - grand_pretest_mean))\n\n# View results\ngt(results2) |>\n  fmt_number(\n    columns = posttest_mean:adjusted_mean\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bypliswfyc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bypliswfyc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bypliswfyc thead, #bypliswfyc tbody, #bypliswfyc tfoot, #bypliswfyc tr, #bypliswfyc td, #bypliswfyc th {\n  border-style: none;\n}\n\n#bypliswfyc p {\n  margin: 0;\n  padding: 0;\n}\n\n#bypliswfyc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bypliswfyc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bypliswfyc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bypliswfyc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bypliswfyc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bypliswfyc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bypliswfyc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bypliswfyc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bypliswfyc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bypliswfyc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bypliswfyc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bypliswfyc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bypliswfyc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bypliswfyc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bypliswfyc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bypliswfyc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bypliswfyc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bypliswfyc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bypliswfyc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bypliswfyc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_left {\n  text-align: left;\n}\n\n#bypliswfyc .gt_center {\n  text-align: center;\n}\n\n#bypliswfyc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bypliswfyc .gt_font_normal {\n  font-weight: normal;\n}\n\n#bypliswfyc .gt_font_bold {\n  font-weight: bold;\n}\n\n#bypliswfyc .gt_font_italic {\n  font-style: italic;\n}\n\n#bypliswfyc .gt_super {\n  font-size: 65%;\n}\n\n#bypliswfyc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bypliswfyc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bypliswfyc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bypliswfyc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bypliswfyc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bypliswfyc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bypliswfyc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#bypliswfyc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#bypliswfyc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"posttest_mean\">posttest_mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pretest_mean\">pretest_mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"grand_pretest_mean\">grand_pretest_mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pooled_slope\">pooled_slope</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adjusted_mean\">adjusted_mean</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">hands-on</td>\n<td headers=\"posttest_mean\" class=\"gt_row gt_right\">70.41</td>\n<td headers=\"pretest_mean\" class=\"gt_row gt_right\">64.90</td>\n<td headers=\"grand_pretest_mean\" class=\"gt_row gt_right\">65.11</td>\n<td headers=\"pooled_slope\" class=\"gt_row gt_right\">0.74</td>\n<td headers=\"adjusted_mean\" class=\"gt_row gt_right\">70.56</td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">lecture</td>\n<td headers=\"posttest_mean\" class=\"gt_row gt_right\">65.96</td>\n<td headers=\"pretest_mean\" class=\"gt_row gt_right\">65.25</td>\n<td headers=\"grand_pretest_mean\" class=\"gt_row gt_right\">65.11</td>\n<td headers=\"pooled_slope\" class=\"gt_row gt_right\">0.74</td>\n<td headers=\"adjusted_mean\" class=\"gt_row gt_right\">65.86</td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">self-paced</td>\n<td headers=\"posttest_mean\" class=\"gt_row gt_right\">69.10</td>\n<td headers=\"pretest_mean\" class=\"gt_row gt_right\">65.20</td>\n<td headers=\"grand_pretest_mean\" class=\"gt_row gt_right\">65.11</td>\n<td headers=\"pooled_slope\" class=\"gt_row gt_right\">0.74</td>\n<td headers=\"adjusted_mean\" class=\"gt_row gt_right\">69.03</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### Visualization\n\nBased on the adjusted means, pretest, and posttest means, we can visualize the results using a bar plot.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nused_colors <- c(\"steelblue\", \"tomato\", \"seagreen4\")\nused_group_labels <- c(\"Pretest\", \"Posttest\", \"Adjusted\")\nresults2 |>\n  select(method, pretest_mean, posttest_mean, adjusted_mean) |>\n  pivot_longer(ends_with(\"_mean\"), names_to = \"type\", values_to = \"Mean\") |>\n  mutate(type = factor(type, levels = paste0(c(\"pretest\", \"posttest\", \"adjusted\"), \"_mean\"))) |>\n  ggplot(aes(y = method, x = Mean)) +\n  geom_col(aes(y = method, x = Mean, fill = type), position = position_dodge()) +\n  geom_text(aes(x = Mean + 5, label = round(Mean, 2), color = type), position = position_dodge(width = .85)) +\n  scale_color_manual(values = used_colors, labels = used_group_labels) +\n  scale_fill_manual(values = used_colors, labels = used_group_labels) +\n  labs(y = \"\", title = \"Comparing Adjusted and Unadjusted Means\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## ANCOVA: Hypothesis Test II\n\n-   **\\[Example\\] Step #2**\n\n-   **Recall: What distinguishes ANCOVA from other analyses?**\n\n-   In addition to a grouping variable (IV), we have scores from some continuous measure (i.e., covariate) that is related to the DV\n    -   [x] Preferably, we are in a randomized-control experimental situation — use caution when in a quasi-experimental situation! (because it does not consider random assignments of treatments/levels of IV)\n    \n-   This is a situation in which we desire **“statistical control”** based upon the covariate.\n    -   [x] In some scenarios it may not make sense to adjust the group means as if they were the same on the covariate.\n-   In ANCOVA:\n    -   [x] IV: same as before — grouping/categorical variable with 2 or more levels\n    -   [x] In addition to IV, we are adding a **continuous covariate** → this is **NEW!**\n    -   [x] DV: same as before — continuous variable\n\n## ANCOVA: Hypothesis Test III\n\n-   **\\[Example\\] Step #2**\n-   **Recall: Continuous covariate?**\n\n- ➤ **Categorical variable** \n\n  - ✓ Contain a finite number of categories or distinct groups. \n  \n  - ✓ Might not have a logical order. \n  \n  - ✓ Examples: gender, material type, and payment method.\n\n- ➤ **Discrete variable** \n\n  - ✓ Numeric variables that have a countable number of values between any two values. \n  \n  - ✓ Examples: number of customer complaints, number of items correct on an assessment, attempts on GRE. \n  \n  - ✓ It is common practice to treat discrete variables as continuous, as long as there are a large number of levels (e.g., 1–100 not 1–4).\n\n- ➤ **Continuous variable** \n  \n  - ✓ Numeric variables that have an infinite number of values between any two values. \n  \n  - ✓ Examples: length, weight, time to complete an exam.\n\n- ➔ **We often assume the DV for ANCOVA is continuous, but we can sometimes “get away” with discrete, ordered outcomes if there are enough categories.**\n\n## ANCOVA: Hypothesis Test IV\n\n-   **\\[Example\\] Step #2**\n-   **What if we have a categorical outcome?**\n\n➤ Not related to this course, but categorical outcomes are commonly analyzed: - ✓ Examples: pass/fail a fitness test; pass/fail an academic test; retention (yes/no); on-time graduation (yes/no); proficiency (below, meeting, advanced), etc.\n\n➔ **These are not continuous, so we cannot use them in ANOVA**\n\n➤ Instead: **logistic regression** (PROC LOGISTIC or PROC GLM!) - ✓ *Logistic regression can include both categorical and continuous IVs (and their interactions)*\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load libraries\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Simulate data\nset.seed(123)\nn <- 100\nweight <- rnorm(n, 140, 20)\nprob_obese <- 1 / (1 + exp(-(0.1 * weight -15)))  # logistic model\nobese <- rbinom(n, size = 1, prob = prob_obese)\n\ndata <- data.frame(weight = weight, obese = obese)\n\n# Linear model\nlm_model <- lm(obese ~ weight, data = data)\n\n# Logistic model\nlogit_model <- glm(obese ~ weight, data = data, family = \"binomial\")\n\n# Prediction data\npred_data <- data.frame(weight = seq(min(weight), max(weight), length.out = 100))\npred_data$lm_pred <- predict(lm_model, newdata = pred_data)\npred_data$logit_pred <- predict(logit_model, newdata = pred_data, type = \"response\")\n\n# Plot 1: Linear Regression\np1 <- ggplot(data, aes(x = weight, y = obese)) +\n  geom_point(color = \"red\", size = 2) +\n  geom_line(data = pred_data, aes(x = weight, y = lm_pred), color = \"black\") +\n  labs(title = \"Linear Regression\", x = \"weight\", y = \"Obesity (0/1)\") +\n  # ylim(0, 1.1) +\n  theme_minimal()\n\n# Plot 2: Logistic Regression\np2 <- ggplot(data, aes(x = weight, y = obese)) +\n  geom_point(color = \"red\", size = 2) +\n  geom_line(data = pred_data, aes(x = weight, y = logit_pred), color = \"black\") +\n  labs(title = \"Logistic Regression\", x = \"weight\", y = \"Predicted Probability\") +\n  # ylim(0, 1.1) +\n  theme_minimal()\n\n# Combine plots using patchwork\nlibrary(patchwork)\np1 + p2\n```\n\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## ANOVA: Degree of Freedom\n\n-   In addition to the traditional degrees of freedom for ANOVA, **you lose one degree of freedom for each covariate.**\n\n-   **Degrees of Freedom** → In our scenario, we have 1 IV with 3 groups and 1 covariate.\n\n-   The $df_{method}$ remains: *k − 1*, where *k* is the number of groups.\n\n    -   In our scenario, with 3 groups, the numerator df = 3 − 1 = **2**\n\n-   The $df_{error}$ differs from ANOVA:\n\n    -   *N − k − c*, where *k* is the number of groups and *c* is the number of covariates.\n    -   In our scenario, if there are 200 students (*N = 200*), 3 groups, and 1 covariate (e.g., IQ), the df is\\\n        **200 − 3 − 1 = 196**\n\n-   The $df_{covariate}$ is **#covariates = 1**\n\n-   With 200 students, 3 groups, and 1 covariate, the degrees of freedom for this analysis would be:\n\n    -   **2** (numerator) and **196** (denominator)\n\n## AFTER ANCOVA: Treatment Effect\n\n-   **Now we need to follow-up to see where the differences lie.**\n\n-   **Planned contrasts and pairwise comparisons**\n\n    -   [x] based on the **adjusted means** and the **error term** after removing covariate variance\n    -   [x] Can interpret the same, **just be sure to note that it is the effect for the adjusted means**\\\n        *(i.e., the means of DV after controlling for covariate)*\n\n-   **Post-hoc tests**\n\n    -   [x] Many post‑hoc procedures are not designed for ANCOVA; however, a limited selection is available (e.g., Bonferroni, Sidak). Avoid mislabeling Tukey’s HSD as “LSD.”\n\n## Problem: ANCOVA in Quasi-experimental Design I\n\n|   | **True Experimental Design** | **Quasi-Experimental Design** |\n|-------------------|---------------------------|---------------------------|\n| **Assignment to treatment** | The researcher *randomly assigns* subjects to control and treatment groups. | Some other, *non-random* method is used to assign subjects to groups. |\n| **Control over treatment** | The researcher usually *designs the treatment*. | The researcher often *does not have control over the treatment*, but studies pre-existing groups. |\n| **Use of control groups** | Requires the use of *control and treatment groups*. | Control groups are not required (although they are commonly used). |\n\n## Problem: ANCOVA in Quasi-experimental Design II\n\n-   **ANCOVA in true experiments is straightforward**\n    -   [x] It reduces error variance and increases power and is a great option if you have a good covariate and have met the ANCOVA assumptions.\n-   **ANCOVA in quasi‑experimental designs is controversial and risky**\n    -   [x] Some people say you shouldn’t do it at all. Others say you just have to be careful not to over-interpret and to be sure to do replications.\n-   **Accounting for Pre-Existing Group Differences:**\n    -   ➤ If people are not randomly assigned to conditions, there may be differences in the DV across the groups before the experiment starts.\n    -   ➤ Some use ANCOVA to “account for pre‑existing differences” in quasi‑experimental designs; however:\n        -   [x] ANCOVA equates groups on a particular covariate, but there is no guarantee that this is the only or most important dimension that the groups differ on.\n        -   [x] Equating pre‑existing groups on one variable may accentuate differences on another.\n\n## Problem: ANCOVA in Quasi-experimental Design III\n\n-   **What is the risk/concern with quasi-experimental design?**\n\n    ➤ For example, **including a covariate adjusts the two groups’ means as if they were the same on that covariate**.\\\n    ➤ *Therefore, the two analyses are addressing two different research questions!*\n\n    -   [x] Pre–post change analysis addresses $H_0\\!: \\mu_{\\text{female}} = \\mu_{\\text{male}}$\n    -   [x] ANCOVA addresses $H_0\\!: \\text{adjusted } \\mu_{\\text{female}} = \\text{adjusted } \\mu_{\\text{male}}$\n\n| **Biases the effect size of the IV** | **Values can’t be trusted** |\n|--------------------------------------|----------------------------------|\n| \\- Can remove real “effect variance” and attenuate the effect size | \\- Adjusted means are implausible values |\n| \\- If other variables involved, can make it look like there is an effect when there isn’t | \\- Interaction and slope values could just apply to the cells observed, not the population |\n\n## ANCOVA: Final Thoughts…\n\n-   Use of covariates does not guarantee that groups are “equivalent” —\\\n    even after using multiple covariates, there still may be some confounding variables operating that you are unaware of.\n\n-   The best safeguard against confounding is random assignment to groups.\n\n-   Make sure that the covariate you are using is reliable!\n\n\n## Final Exercise: Psychology Scenario (ANCOVA) {.unnumbered}\n\n- Scenario: Therapy effectiveness on anxiety reduction\n- Outcome (continuous): post_anxiety\n- IV (categorical, 3 levels): therapy (CBT, Mindfulness, Control)\n- Covariate 1 (categorical): sex (Female/Male)\n- Covariate 2 (continuous): baseline anxiety (pre_anxiety)\n\n::: panel-tabset\n### Starter Code\n\n```{webr-r}\n#| echo: true\n#| message: false\n#| warning: false\n#| context: setup\n# --- Part A: Data simulation (provided) ---\nset.seed(64103)\nn <- 240\ntherapy_levels <- c(\"Control\", \"CBT\", \"Mindfulness\")\ntherapy <- factor(sample(therapy_levels, n, replace = TRUE), levels = therapy_levels)\nsex <- factor(sample(c(\"Female\", \"Male\"), n, replace = TRUE))\npre_anxiety <- pmax(0, rnorm(n, mean = 50, sd = 10))\nintercepts <- c(Control = 10, CBT = 5, Mindfulness = 6)\nsex_effect <- c(Female = 0, Male = 1.5)\nbeta_pre <- 0.6\nsigma <- 6\npost_anxiety <- intercepts[therapy] + sex_effect[sex] + beta_pre * pre_anxiety + rnorm(n, 0, sigma)\npsy_df <- data.frame(therapy, sex, pre_anxiety, post_anxiety)\n\n# Expose psy_df as context for subsequent cells\npsy_df\n```\n\n```{webr-r}\n#| echo: true\n#| message: false\n#| warning: false\n# --- Part B: Fill in the blanks ---\n\n# 1) Inspect data\nhead(psy_df)\n\n# 2) Check homogeneity of regression slopes: include the interaction term\nmod_interaction <- lm(post_anxiety ~ ___ * ___ + ___, data = psy_df)\nanova(mod_interaction)\n\n# 3) Fit ANCOVA without the interaction if negligible\nmod_ancova <- lm(post_anxiety ~ ___ + ___ + ___, data = psy_df)\nanova(mod_ancova)\nsummary(mod_ancova)\n\n# 4) Model diagnostics\npar(mfrow = c(1, 2))\nplot(mod_ancova, which = 1)  # residuals vs fitted\nplot(mod_ancova, which = 2)  # QQ plot\npar(mfrow = c(1, 1))\n\n# 5) Adjusted means at grand baseline\ngrand_x <- mean(psy_df$___)\nb <- coef(lm(post_anxiety ~ ___, data = psy_df))[\"___\"]\nadj_tbl <- aggregate(cbind(post_anxiety, pre_anxiety) ~ ___ + ___, data = psy_df, mean)\nadj_tbl$adj_mean <- with(adj_tbl, post_anxiety - b * (pre_anxiety - grand_x))\n\nlibrary(ggplot2)\nggplot(psy_df, aes(___, ___, color = ___, shape = ___)) +\n  geom_point(alpha = 0.4) +\n  geom_vline(xintercept = grand_x, linetype = \"dashed\") +\n  geom_point(data = adj_tbl, aes(x = grand_x, y = adj_mean), size = 3, inherit.aes = FALSE) +\n  labs(title = \"Adjusted means at common baseline (grand pre_anxiety)\", x = \"Baseline anxiety\", y = \"Post anxiety\") +\n  theme_minimal()\n```\n\n### Answer Key\n\n```{webr-r}\n#| echo: true\n#| message: false\n#| warning: false\n# Full worked solution\n\n# Assumption: homogeneity of regression slopes (pre_anxiety x therapy)\nmod_interaction <- lm(post_anxiety ~ pre_anxiety * therapy + sex, data = psy_df)\nassump <- anova(mod_interaction)\nassump\n\n# If interaction ns, proceed with ANCOVA\nmod_ancova <- lm(post_anxiety ~ pre_anxiety + therapy + sex, data = psy_df)\nanova_tbl <- anova(mod_ancova)\ncoef_tbl <- summary(mod_ancova)\nanova_tbl\ncoef_tbl\n\n# Adjusted means at grand covariate\ngrand_x <- mean(psy_df$pre_anxiety)\nb <- coef(lm(post_anxiety ~ pre_anxiety, data = psy_df))[\"pre_anxiety\"]\nadj_tbl <- aggregate(cbind(post_anxiety, pre_anxiety) ~ therapy + sex, data = psy_df, mean)\nadj_tbl$adj_mean <- with(adj_tbl, post_anxiety - b * (pre_anxiety - grand_x))\nadj_tbl\n\n# Model diagnostics\npar(mfrow = c(2, 2))\nplot(mod_ancova)\npar(mfrow = c(1, 1))\n\n# Simple pairwise comparisons (Bonferroni) on therapy adjusted means\nif (requireNamespace(\"emmeans\", quietly = TRUE)) {\n  library(emmeans)\n  em <- emmeans(mod_ancova, ~ therapy)\n  pairs(em, adjust = \"bonferroni\")\n}\n\n# Brief interpretation printouts\ncat(\"\\nHomogeneity of slopes p-value (pre_anxiety:therapy):\",\n    signif(assump[\"pre_anxiety:therapy\", \"Pr(>F)\"], 3), \"\\n\")\ncat(\"ANCOVA F for therapy (adjusted):\",\n    signif(anova_tbl[\"therapy\", \"F value\"], 3),\n    \"p=\", signif(anova_tbl[\"therapy\", \"Pr(>F)\"], 3), \"\\n\")\n```\n\n### Result Report\n\nBased on the ANCOVA analysis, we first evaluated the homogeneity of regression slopes by including the pre_anxiety × therapy interaction in the model along with sex. The interaction was not statistically significant, F(2, 233) = 1.29, p = 0.276, supporting the equal‑slopes assumption for ANCOVA. It implies that participants are homogeneous across treatment and control groups in term of their baseline anxiety levels\n\nWe then fit the ANCOVA with post_anxiety as the dependent variable, therapy as the primary factor, and pre_anxiety (continuous) and sex (categorical) as covariates. The omnibus ANCOVA indicated a strong effect of baseline anxiety, F(1, 235) = 200.0, p < .001, a significant main effect of therapy after adjustment, F(2, 235) = 16.38, p < .001, and a significant effect of sex, F(1, 235) = 6.73, p = .010. The overall model explained approximately 50% of the variance in post‑intervention anxiety, R² = .505 (adjusted R² = .496), with a residual standard error of 5.94.\n\nExamining adjusted group differences, relative to Control, CBT was associated with lower adjusted post_anxiety (b = −5.07, SE = 0.93, p < .001), and Mindfulness was also associated with lower adjusted post_anxiety (b = −3.87, SE = 0.93, p < .001). Males exhibited higher adjusted post_anxiety than females (b = 1.99, SE = 0.77, p = .010). The pooled slope relating baseline to post anxiety was significantly positive (b = 0.51, SE = 0.04, p < .001), indicating higher post‑treatment anxiety for participants with higher baseline anxiety.\n\nAdjusted means at the grand baseline level were consistent with these effects (illustrative cell‑specific adjusted means shown in the table), with both CBT and Mindfulness yielding lower adjusted anxiety than Control. Model diagnostics (residuals vs. fitted and Q–Q plot) did not reveal notable violations of linear model assumptions.\n:::\n\n\n\n## Summary\n\n::: macwindow\n-   This lecture covers key elements of ANCOVA:\n    -   When and why ANCOVA improves precision over ANOVA\n    -   How ANCOVA hypotheses compare to ANOVA hypotheses\n    -   Adjusted means as group summaries conditional on covariates\n    -   Potential problems when assumptions are violated\n    \n-   Next week will be our last course - Mixed ANOVA\n    \n    -  I will bring some dotnuts\n    \n-   Final homework will be light weighted    \n:::\n\n# Fin {.unnumbered}\n",
    "supporting": [
      "ESRM64103_Lecture12_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/plotly-binding-4.11.0/plotly.js\"></script>\n<script src=\"../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../../site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n<link href=\"../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}