{
  "hash": "fdc65cede3844e490e0b55426733dd50",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 12: ANCOVA\"\nsubtitle: \"Experimental Design in Education\"\ndate: \"2025-04-09\"\ndate-modified: \"2025-04-09\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  message: false\nwebr:\n  editor-font-scale: 1.2\nformat: \n  html:\n    toc-expand: 3\n    code-tools: false\n    code-line-numbers: false\n    code-fold: false\n    code-summary: \"Click to see R code\"\n    number-offset: 1\n    fig.width: 10\n    fig-align: center\n    message: false\n    grid:\n      sidebar-width: 350px\n  uark-revealjs:\n    chalkboard: true\n    embed-resources: false\n    code-fold: false\n    number-sections: true\n    number-depth: 1\n    footer: \"ESRM 64503\"\n    slide-number: c/t\n    tbl-colwidths: auto\n    scrollable: true\n    output-file: slides-index.html\n    mermaid:\n      theme: forest    \n---\n\n\n\n\n::: objectives\n## Overview of Lecture 12 {.unnumbered}\n\n1. What is ANCOVA?\n2. Why use ANCOVA?\n3. How to use ANCOVA (assumptions, hypothesis setup)?\n4. Potential issues of using ANCOVA.\n:::\n\n# Introduction\n\n## Introduction - Overview other design\n\n-   **The ANOVA designs we have been talking about use experimental control (e.g., our research design) in order to reduce error variance.**\n    -   ✔ Example: In the one-way ANOVA tutoring example, we thought that there might be another factor explaining math scores beyond just tutoring program (factor A).\n    -   ✔ Thus, we also looked at school type (factor B) to help reduce the error variance.\n-   **Other examples to reduce error variance:**\n    -   ✔ Blocking (analyze blocks of data – levels of IV’s)\n    -   ✔ Between-subjects design (i.e., N-way ANOVA)\n    -   ✔ Within-subjects design (i.e., repeated measures)\n\n## Introduction - ANCOVA\n\n-   What we will discuss today is a **statistical control for reducing the variance due to error**.\n\n-   Statistical control is used when we know a subject’s score on an additional variable.\n\n    -   When we discussed blocking design, it was a categorical control (e.g., schools, class).\n    -   But for **ANCOVA**, it is a **continuous** covariate!\n        - e.g., students' academic motivation; engagement levels; math disorder scores.\n\n-   **ANCOVA** by definition is a general linear model that includes both:\n\n    -   **ANOVA (categorical)** predictors\n    -   **Regression (continuous)** predictors\n\n## ANCOVA: Example\n\n-   We are interested in **comparing method of instruction on students’ math problem solving skills, as measured by a test score**.\n\n    -   The test is composed of word problems that are each presented in a few sentences.\n        -   **Ex**: “Joe buys 60 cantaloupes and sells 5. He then gives away 4…”\n        -   **DV** = \\# of problems correctly answered in an hour.\n        -   **IV** = method of instruction (three levels)\n\n-   One-way, independent ANOVA: If we get a significant F statistic, we would conclude that method of instruction differed on the mean \\# of math problems answered correctly.\n\n-   Performance on math word problems may be affected by things other than method of instruction and math ability.\n\n    -   To name a few: Motivation on the test, verbal proficiency, hunger, gender, previous years’ math grades…\n\n-   The DV score results from instructional method + the other factors we just listed.\n\n    -   We really want to ask: **to what extent might we have obtained method of instruction difference on math scores had the groups been equivalent in their motivation levels?** (or verbal proficiency?)\n\n## ANCOVA definition\n\n-   ANCOVA is one way to investigate the effects of these factors.\n-   Includes information on the other variable (e.g., motivation) in the analysis!\n    -    **To examine the difference in math word problem performance, as if the groups were the same on entering motivation** (or experience, etc...).\n-   When comparing groups, we claim that people vary in their scores on the DV for a variety of reasons:\n    -    **Treatment Effects (i.e., group differences)**\n        -    Ex: Instructional Method\n    -    **Individual Differences**\n        -    Ex: Motivation to do well on the math tests\n    -    **Measurement Error**\n        -    Ex: The math assessment is unreliable\n    -   These two sources (Individual Differences and Measurement Error) contribute to:\n        -   ***Experimental Error***\n        -   *(both of these go into* $SS_{\\text{Error}}$)\n\n## ANCOVA Advantage\n\n-   **Reduces Error Variance**\n    -    By explaining some of the unexplained variance ($SS_{\\text{error}}$), the error variance in the model can be reduced.\n    -    Think of the pie charts below!\n-   **Greater Experimental Control**\n    -    By controlling known extraneous variables, we gain greater insight into the effect of the predictor (IV) variable(s).\n\n\n\n\n::: {.cell layout-nrow=\"2\"}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-b2fe7de7b9bfb8ecb646\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b2fe7de7b9bfb8ecb646\">{\"x\":{\"visdat\":{\"142f270bd782\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"142f270bd782\",\"attrs\":{\"142f270bd782\":{\"labels\":[\"A\",\"Error (Not explained by A)\"],\"values\":[25,75],\"title\":\"ONE-WAY ANOVA\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"pie\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":{\"text\":\"ONE-WAY ANOVA\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"labels\":[\"A\",\"Error (Not explained by A)\"],\"values\":[25,75],\"title\":\"ONE-WAY ANOVA\",\"type\":\"pie\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"line\":{\"color\":\"rgba(255,255,255,1)\"}},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-fe80fd3d699b7e348462\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fe80fd3d699b7e348462\">{\"x\":{\"visdat\":{\"142f21a719b6b\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"142f21a719b6b\",\"attrs\":{\"142f21a719b6b\":{\"labels\":[\"A\",\"Cov\",\"Error (Not explained by A, Cov, A*Cov)\"],\"values\":[25,15,60],\"title\":\"ANCOVA\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"pie\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":{\"text\":\"ANCOVA\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"labels\":[\"A\",\"Cov\",\"Error (Not explained by A, Cov, A*Cov)\"],\"values\":[25,15,60],\"title\":\"ANCOVA\",\"type\":\"pie\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"line\":{\"color\":\"rgba(255,255,255,1)\"}},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n## Adding the covariate\n\n::::: columns\n::: column\n-   **The inclusion of the covariate adjusts the groups’ means, as if they are the same on the covariate.**\n\n-   The analyses addressed different research questions!\n\n    -    Ex. Ignoring the impact of height\\\n        ➔ $H_0\\!: \\mu_A = \\mu_B = \\mu_C$\n    -    Considering height: Adjusted mean! (ANCOVA)\\\n        ➔ $H_0\\!: \\text{Adj}_{\\mu_A} = \\text{Adj}_{\\mu_B} = \\text{Adj}_{\\mu_C}$\n\n-   If there is no random assignment of treatments, we should be careful to use ANCOVA!\n\n    -    We don’t always expect groups to be the same, so ANCOVA may not make sense.\n:::\n\n::: column\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n:::\n:::::\n\n## ANCOVA: Hypothesis Test I\n\n**\\[Example\\]**\n\n-   Let’s examine a scenario in which *a school principal wants to examine the effectiveness of teaching methods in math courses*.\n-   The principal would like to gauge the effectiveness of the following three types of instruction:\n    -    lecture-only,\n    -    lecture + hands-on activities,\n    -    self-paced instruction\n-   The principal randomly-assigned 200 students to one of the three types of math instruction and measured performance on an end-of-semester achievement test (out of 100 points).\n-   A consultant from ESRM 6413 suggested that the principal also **statistically control for students’ ability**.\n    -    Each student had also completed a math pre-test, so the principal decided to include the pre-test scores in the analysis as the covariate.\n\n## ANCOVA: Assumption Check I\n\n**Assumption Check in ANCOVA:**\n\n➤ **The three usual ANOVA assumptions apply:**\n\n-    Independency\n-    Normality (within-group; for each group)\n-    Equality of variance (homogeneity of variance)\n\n➤ **Three additional data considerations:**\n\n-    Linear relationship between the covariate & DV\n-    Homogeneity of Regression Slope\n-    Covariate is measured without error\n\n## ANCOVA: Assumption Check II\n\n-   **Assumption Check in ANCOVA:**\n\n1.  **Linear relationship between the covariate & DV:**\n\n> By looking over the plot, we can find that there is a general linear relationship (i.e., straight line) between the covariate and the DV.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n## ANCOVA: Assumption Check III\n\n- **Assumption Check in ANCOVA:**\n2. **Homogeneity of Regression Slope:**\n  - ✓ The relationship between each covariate and the DV should be the same for each level of the IV.\n  - ✓ *Think of this as an interaction between the IV and covariate.*\n  - ✓ *We don’t want this in ANCOVA!*\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-4-1.png){width=1152}\n:::\n:::\n\n\n\n\n## ANCOVA: Assumption Check IV\n\n- **Assumption Check in ANCOVA:**\n2. **Homogeneity of Regression Slope:**\n\n➤ This is equivalent to saying that the relationship between the DV and covariate has to be the same for each cell (a.k.a. “group”)\n\n  - ✓ The slope value – *b* – that we use to make the adjustment is the same\n\n➤ Consequences depend on whether cells have equal sample sizes and whether a true experiment\n\n  - ✓ *If equal sample sizes, then a true experiment ANCOVA is relatively robust to violations of this assumption.*\n  - ✓ *If unequal sample sizes (or quasi-experimental design), the mean adjustments will be off by a moderate amount.*\n\n## ANCOVA: Assumption Check V\n\n- **Assumption Check in ANCOVA:**\n2. **Homogeneity of Regression Slope:**\n\n> When we “eyeball” the three regression slopes (regression of the covariate predicting the DV), we see the relationship is approximately equal.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n:::\n\n\n\n\n## ANCOVA: Assumption Check VI\n\n- **Assumption Check in ANCOVA:**\n2. **Homogeneity of Regression Slope:**\n\n➤ **The formal/general method of checking homogeneity of regression slope:**\n\n1. Run the model **with the interaction** term included to make sure it is negligible (a.k.a., not significant) → this is *not* the ANCOVA yet!\n\n$SS_{total} = SS_{IV} + SS_{COV} + \\color{red}{SS_{IV*COV}} + SS_{within}$\n\n2. IF negligible (a.k.a., not significant), re-run the ANCOVA **without the interaction** term to get the final values to interpret → this *is* the ANCOVA model.\n\n$SS_{total} = SS_{IV} + SS_{COV} + SS_{within}$\n\n## ANCOVA: Assumption Check VII\n2. **Homogeneity of Regression Slope:**\n➤ **The formal/general method of checking homogeneity of regression slope:**\n\n1. Run the model **with the interaction** term included to make sure it is negligible (a.k.a., not significant) → this is *not* the ANCOVA yet!\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(gt)\nlibrary(tidyverse)\nres <- anova(lm(posttest~pretest*method, data=df))\nres_tbl <- res |> \n  as.data.frame() |> \n  rownames_to_column(\"Coefficient\")\nres_gt_display <- gt(res_tbl) |> \n  fmt_number(\n    columns = `Sum Sq`:`Pr(>F)`,\n    suffixing = TRUE,\n    decimals = 3\n  )\nres_gt_display|> \n  tab_style( # style for versicolor\n    style = list(\n      cell_fill(color = \"royalblue\"),\n      cell_text(color = \"red\", weight = \"bold\")\n    ),\n    locations = cells_body(\n        columns = colnames(res_tbl),\n        rows = Coefficient == \"pretest:method\")\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ycgfkvjntr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ycgfkvjntr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ycgfkvjntr thead, #ycgfkvjntr tbody, #ycgfkvjntr tfoot, #ycgfkvjntr tr, #ycgfkvjntr td, #ycgfkvjntr th {\n  border-style: none;\n}\n\n#ycgfkvjntr p {\n  margin: 0;\n  padding: 0;\n}\n\n#ycgfkvjntr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ycgfkvjntr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ycgfkvjntr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ycgfkvjntr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ycgfkvjntr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ycgfkvjntr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ycgfkvjntr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ycgfkvjntr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ycgfkvjntr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ycgfkvjntr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ycgfkvjntr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ycgfkvjntr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ycgfkvjntr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ycgfkvjntr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ycgfkvjntr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ycgfkvjntr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ycgfkvjntr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ycgfkvjntr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ycgfkvjntr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ycgfkvjntr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ycgfkvjntr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ycgfkvjntr .gt_left {\n  text-align: left;\n}\n\n#ycgfkvjntr .gt_center {\n  text-align: center;\n}\n\n#ycgfkvjntr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ycgfkvjntr .gt_font_normal {\n  font-weight: normal;\n}\n\n#ycgfkvjntr .gt_font_bold {\n  font-weight: bold;\n}\n\n#ycgfkvjntr .gt_font_italic {\n  font-style: italic;\n}\n\n#ycgfkvjntr .gt_super {\n  font-size: 65%;\n}\n\n#ycgfkvjntr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ycgfkvjntr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ycgfkvjntr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ycgfkvjntr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ycgfkvjntr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ycgfkvjntr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ycgfkvjntr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ycgfkvjntr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ycgfkvjntr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Df\">Df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sum-Sq\">Sum Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean-Sq\">Mean Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F-value\">F value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pr(&gt;F)\">Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">pretest</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">150.059</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">method</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">726.111</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">363.055</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">14.436</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">pretest:method</td>\n<td headers=\"Df\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">2</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">66.190</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">33.095</td>\n<td headers=\"F value\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">1.316</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">0.271</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">Residuals</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">194</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">4.879K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">25.148</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">NA</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n2. IF negligible (a.k.a., not significant), re-run the ANCOVA **without the interaction** term to get the final values to interpret → this *is* the ANCOVA model.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nres <- anova(lm(posttest~pretest+method, data=df))\nres_tbl <- res |> \n  as.data.frame() |> \n  rownames_to_column(\"Coefficient\")\nres_gt_display <- gt(res_tbl) |> \n  fmt_number(\n    columns = `Sum Sq`:`Pr(>F)`,\n    suffixing = TRUE,\n    decimals = 3\n  )\nres_gt_display|> \n  tab_style( # style for versicolor\n    style = list(\n      cell_fill(color = \"royalblue\"),\n      cell_text(color = \"red\", weight = \"bold\")\n    ),\n    locations = cells_body(\n        columns = colnames(res_tbl),\n        rows = Coefficient == \"method\")\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"etakirvmkn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#etakirvmkn table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#etakirvmkn thead, #etakirvmkn tbody, #etakirvmkn tfoot, #etakirvmkn tr, #etakirvmkn td, #etakirvmkn th {\n  border-style: none;\n}\n\n#etakirvmkn p {\n  margin: 0;\n  padding: 0;\n}\n\n#etakirvmkn .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#etakirvmkn .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#etakirvmkn .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#etakirvmkn .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#etakirvmkn .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#etakirvmkn .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#etakirvmkn .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#etakirvmkn .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#etakirvmkn .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#etakirvmkn .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#etakirvmkn .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#etakirvmkn .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#etakirvmkn .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#etakirvmkn .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#etakirvmkn .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#etakirvmkn .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#etakirvmkn .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#etakirvmkn .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#etakirvmkn .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#etakirvmkn .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#etakirvmkn .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#etakirvmkn .gt_left {\n  text-align: left;\n}\n\n#etakirvmkn .gt_center {\n  text-align: center;\n}\n\n#etakirvmkn .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#etakirvmkn .gt_font_normal {\n  font-weight: normal;\n}\n\n#etakirvmkn .gt_font_bold {\n  font-weight: bold;\n}\n\n#etakirvmkn .gt_font_italic {\n  font-style: italic;\n}\n\n#etakirvmkn .gt_super {\n  font-size: 65%;\n}\n\n#etakirvmkn .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#etakirvmkn .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#etakirvmkn .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#etakirvmkn .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#etakirvmkn .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#etakirvmkn .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#etakirvmkn .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#etakirvmkn .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#etakirvmkn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Df\">Df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sum-Sq\">Sum Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean-Sq\">Mean Sq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F-value\">F value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pr(&gt;F)\">Pr(&gt;F)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">pretest</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">3.774K</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">149.576</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">method</td>\n<td headers=\"Df\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">2</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">726.111</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">363.055</td>\n<td headers=\"F value\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">14.390</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\" style=\"background-color: #4169E1; color: #FF0000; font-weight: bold;\">0.000</td></tr>\n    <tr><td headers=\"Coefficient\" class=\"gt_row gt_left\">Residuals</td>\n<td headers=\"Df\" class=\"gt_row gt_right\">196</td>\n<td headers=\"Sum Sq\" class=\"gt_row gt_right\">4.945K</td>\n<td headers=\"Mean Sq\" class=\"gt_row gt_right\">25.230</td>\n<td headers=\"F value\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"Pr(>F)\" class=\"gt_row gt_right\">NA</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## ANCOVA: Assumption Check VIII\n\n- **Assumption Check in ANCOVA:**\n3. **Covariate is measured without error:**\n\n➤ **Reliability of Covariates**\n  - ✓ Because the covariates are used in a linear prediction of the DV, no error is assessed or removed from the covariate in the way it is for the DV.\n  - ✓ So, it is assumed that the covariates are measured without any error.\n    ➔ You’ll learn MUCH more about reliability of measures in Dr. Turner’s measurement class!\n    ➔ So, despite the fact that it’s a crucial assumption, we won’t spend much time on it here.\n\n➤ **The reliability of covariate scores is crucial with ANCOVA**\n\n| True Experimental Design | Quasi-Experimental Design |\n|--------------------------|----------------------------|\n| - Relationship between covariate and DV underestimated, resulting in less adjustment than is necessary  | - Relationship between covariate and DV underestimated, resulting in less adjustment than is necessary |\n| - Less powerful *F* test | - *Group effects (IV) may be seriously biased* |\n\n## ANCOVA: Hypothesis Test II\n\n**[Example] Step #1**\n\n- **Research/alternative hypothesis**\n  - ✓ $H_A$: *Controlling for pretest*, the **adjusted** means of math scores among three instructional groups will differ.\n\n- **Null hypothesis**\n  - ✓ $H_0$: *Controlling for pre-test*, there is no difference between the **adjusted** means of math scores among three instructional groups.  \n  $\\Rightarrow H_0: \\text{adjusted } \\mu_{\\text{lecture}} = \\text{adjusted } \\mu_{\\text{hands-on}} = \\text{adjusted } \\mu_{\\text{self-paced}}$\n\n---\n\n### ANCOVA: Adjusted Means I\n\n- **Adjusted cell means** are the observed cell mean minus a weighted within-cell deviation of the covariate values from the covariate cell means.\n  - ✓ When we do the adjustment, this is what happens:\n\n$$\n\\bar{Y}_{\\text{adjusted}} = \\bar{Y}_{\\text{original}} - b (\\bar{X}_{\\text{cell}} - \\bar{X}_{\\text{grand}})\n$$\n\n- *b* is the pooled slope for the simple regression of the covariate on the DV  \n- *X* is the covariate (cell mean and grand mean)  \n- *Y* is the dependent variable (adjusted and unadjusted cell means)\n\n- If *b* is zero (relationship is zero) then there is no adjustment.\n- The bigger *b* is (the stronger the covariate/DV relationship), the more of an adjustment.\n\n➔ **The further a cell mean is from the covariate grand mean (the bigger the deviation), the more the cell mean is adjusted.**\n\n---\n\n### ANCOVA: Adjusted Means II\n\nBased on the ANCOVA adjusted means formula:\n\n$$\n\\bar{Y}_{\\text{adjusted}} = \\bar{Y}_{\\text{original}} - b (\\bar{X}_{\\text{cell}} - \\bar{X}_{\\text{grand}})\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Unadjusted means of posttest by group\nunadjusted_means <- df %>%\n  group_by(method) %>%\n  summarise(posttest_mean = mean(posttest))\n\n# Pretest means by group\npretest_means <- df %>%\n  group_by(method) %>%\n  summarise(pretest_mean = mean(pretest))\n\n# Grand mean of pretest\ngrand_pretest_mean <- mean(df$pretest)\n\n# Fit linear model to get pooled regression slope\nmodel <- lm(posttest ~ pretest, data = df)\n\n# Extract slope\npooled_slope <- coef(model)[\"pretest\"]\n\n# Combine into one table\nresults <- left_join(unadjusted_means, pretest_means, by = \"method\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Calculate adjusted means using the ANCOVA adjustment formula\nresults2 <- results |> \n  mutate(grand_pretest_mean = grand_pretest_mean) |> \n  mutate(pooled_slope = pooled_slope) |> \n  mutate(adjusted_mean = posttest_mean - pooled_slope * (pretest_mean - grand_pretest_mean))\n  \n\n# View results\ngt(results2) |> \n  fmt_number(\n    columns = posttest_mean:adjusted_mean\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bypliswfyc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bypliswfyc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bypliswfyc thead, #bypliswfyc tbody, #bypliswfyc tfoot, #bypliswfyc tr, #bypliswfyc td, #bypliswfyc th {\n  border-style: none;\n}\n\n#bypliswfyc p {\n  margin: 0;\n  padding: 0;\n}\n\n#bypliswfyc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bypliswfyc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bypliswfyc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bypliswfyc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bypliswfyc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bypliswfyc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bypliswfyc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bypliswfyc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bypliswfyc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bypliswfyc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bypliswfyc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bypliswfyc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bypliswfyc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bypliswfyc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bypliswfyc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bypliswfyc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bypliswfyc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bypliswfyc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bypliswfyc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bypliswfyc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bypliswfyc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bypliswfyc .gt_left {\n  text-align: left;\n}\n\n#bypliswfyc .gt_center {\n  text-align: center;\n}\n\n#bypliswfyc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bypliswfyc .gt_font_normal {\n  font-weight: normal;\n}\n\n#bypliswfyc .gt_font_bold {\n  font-weight: bold;\n}\n\n#bypliswfyc .gt_font_italic {\n  font-style: italic;\n}\n\n#bypliswfyc .gt_super {\n  font-size: 65%;\n}\n\n#bypliswfyc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bypliswfyc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bypliswfyc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bypliswfyc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bypliswfyc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bypliswfyc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bypliswfyc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#bypliswfyc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#bypliswfyc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"posttest_mean\">posttest_mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pretest_mean\">pretest_mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"grand_pretest_mean\">grand_pretest_mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pooled_slope\">pooled_slope</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adjusted_mean\">adjusted_mean</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">hands-on</td>\n<td headers=\"posttest_mean\" class=\"gt_row gt_right\">70.41</td>\n<td headers=\"pretest_mean\" class=\"gt_row gt_right\">64.90</td>\n<td headers=\"grand_pretest_mean\" class=\"gt_row gt_right\">65.11</td>\n<td headers=\"pooled_slope\" class=\"gt_row gt_right\">0.74</td>\n<td headers=\"adjusted_mean\" class=\"gt_row gt_right\">70.56</td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">lecture</td>\n<td headers=\"posttest_mean\" class=\"gt_row gt_right\">65.96</td>\n<td headers=\"pretest_mean\" class=\"gt_row gt_right\">65.25</td>\n<td headers=\"grand_pretest_mean\" class=\"gt_row gt_right\">65.11</td>\n<td headers=\"pooled_slope\" class=\"gt_row gt_right\">0.74</td>\n<td headers=\"adjusted_mean\" class=\"gt_row gt_right\">65.86</td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">self-paced</td>\n<td headers=\"posttest_mean\" class=\"gt_row gt_right\">69.10</td>\n<td headers=\"pretest_mean\" class=\"gt_row gt_right\">65.20</td>\n<td headers=\"grand_pretest_mean\" class=\"gt_row gt_right\">65.11</td>\n<td headers=\"pooled_slope\" class=\"gt_row gt_right\">0.74</td>\n<td headers=\"adjusted_mean\" class=\"gt_row gt_right\">69.03</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n---\n\n### Visualization\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nused_colors <- c(\"steelblue\", \"tomato\", \"seagreen4\")\nused_group_labels <- c(\"Pretest\", \"Posttest\", \"Adjusted\")\nresults2 |> \n  select(method, pretest_mean, posttest_mean, adjusted_mean) |> \n  pivot_longer(ends_with(\"_mean\"), names_to = \"type\", values_to = \"Mean\") |> \n  mutate(type = factor(type, levels = paste0(c(\"pretest\", \"posttest\", \"adjusted\"), \"_mean\"))) |> \n  ggplot(aes(y = method, x = Mean)) +\n  geom_col(aes(y = method, x = Mean, fill = type), position = position_dodge()) + \n  geom_text(aes(x = Mean + 5, label = round(Mean, 2), color = type), position = position_dodge(width = .85)) +\n  scale_color_manual(values = used_colors, labels = used_group_labels) +\n  scale_fill_manual(values = used_colors, labels = used_group_labels) +\n  labs(y = \"\", title = \"Comparing Adjusted and Unadjusted Means\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## ANCOVA: Hypothesis Test II\n\n- **[Example] Step #2**\n- **Recall: What distinguishes ANCOVA from other analyses?**\n- In addition to a grouping variable (IV), we have scores from some continuous measure (i.e., covariate) that is related to the DV\n  - ✓ Preferably, we are in a randomized-control experimental situation — use caution when in a quasi-experimental situation! (because it does not consider random assignments of treatments/levels of IV)\n- This is a situation in which we desire **“statistical control”** based upon the covariate.\n  - ✓ In some scenarios it may not make sense to adjust the group means as if they were the same on the covariate.\n\n- In ANCOVA:\n  - ✓ IV: same as before — grouping/categorical variable with 2 or more levels\n  - ✓ In addition to IV, we are adding a **continuous covariate** → this is **NEW!**\n  - ✓ DV: same as before — continuous variable\n\n## ANCOVA: Hypothesis Test III\n\n- **[Example] Step #2**\n- **Recall: Continuous covariate?**\n\n➤ **Categorical variable**\n  - ✓ Contain a finite number of categories or distinct groups.\n  - ✓ Might not have a logical order.\n  - ✓ Examples: gender, material type, and payment method.\n\n➤ **Discrete variable**\n  - ✓ Numeric variables that have a countable number of values between any two values.\n  - ✓ Examples: number of customer complaints, number of items correct on an assessment, attempts on GRE.\n  - ✓ It is common practice to treat discrete variables as continuous, as long as there are a large number of levels (e.g., 1–100 not 1–4).\n\n➤ **Continuous variable**\n  - ✓ Numeric variables that have an infinite number of values between any two values.\n  - ✓ Examples: length, weight, time to complete an exam.\n\n➔ **We often assume the DV for ANCOVA is continuous, but we can sometimes “get away” with discrete, ordered outcomes if there are enough categories.**\n\n## ANCOVA: Hypothesis Test IV\n\n- **[Example] Step #2**\n- **What if we have a categorical outcome?**\n\n➤ Not related to this course, but categorical outcomes are commonly analyzed:\n  - ✓ Examples: pass/fail a fitness test; pass/fail an academic test; retention (yes/no); on-time graduation (yes/no); proficiency (below, meeting, advanced), etc.\n\n  ➔ **These are not continuous, so we cannot use them in ANOVA**\n\n➤ Instead: **logistic regression** (PROC LOGISTIC or PROC GLM!)\n  - ✓ *Logistic regression can include both categorical and continuous IVs (and their interactions)*\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load libraries\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Simulate data\nset.seed(123)\nn <- 100\nweight <- rnorm(n, 140, 20)\nprob_obese <- 1 / (1 + exp(-(0.1 * weight -15)))  # logistic model\nobese <- rbinom(n, size = 1, prob = prob_obese)\n\ndata <- data.frame(weight = weight, obese = obese)\n\n# Linear model\nlm_model <- lm(obese ~ weight, data = data)\n\n# Logistic model\nlogit_model <- glm(obese ~ weight, data = data, family = \"binomial\")\n\n# Prediction data\npred_data <- data.frame(weight = seq(min(weight), max(weight), length.out = 100))\npred_data$lm_pred <- predict(lm_model, newdata = pred_data)\npred_data$logit_pred <- predict(logit_model, newdata = pred_data, type = \"response\")\n\n# Plot 1: Linear Regression\np1 <- ggplot(data, aes(x = weight, y = obese)) +\n  geom_point(color = \"red\", size = 2) +\n  geom_line(data = pred_data, aes(x = weight, y = lm_pred), color = \"black\") +\n  labs(title = \"Linear Regression\", x = \"weight\", y = \"Obesity (0/1)\") +\n  # ylim(0, 1.1) +\n  theme_minimal()\n\n# Plot 2: Logistic Regression\np2 <- ggplot(data, aes(x = weight, y = obese)) +\n  geom_point(color = \"red\", size = 2) +\n  geom_line(data = pred_data, aes(x = weight, y = logit_pred), color = \"black\") +\n  labs(title = \"Logistic Regression\", x = \"weight\", y = \"Predicted Probability\") +\n  # ylim(0, 1.1) +\n  theme_minimal()\n\n# Combine plots using patchwork\nlibrary(patchwork)\np1 + p2\n```\n\n::: {.cell-output-display}\n![](ESRM64103_Lecture12_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\n## ANOVA: Degree of Freedom\n\n- **In addition to the traditional degrees of freedom for an ANOVA, you now lose a degree of freedom for each covariate.**\n\n- **Degrees of Freedom** → In our scenario, we have 1 IV with 3 groups and 1 covariate.\n- The $df_{method}$* is the same as before: *k - 1*, where *k* represents the number of groups.\n  - ✓ In our scenario, we have 3 groups, so the numerator df = 3 − 1 = **2**\n\n- The $df_{error}$ is different:\n  - ✓ *N − k − #covariates*, where *k* is the number of groups and *#covariates* is the number of continuous controls.\n  - ✓ In our scenario, if there are 200 students (*N = 200*), 3 groups, and 1 covariate (e.g., IQ), the df is  \n    **200 − 3 − 1 = 196**\n\n- The $df_{covariate}$ is **#covariates = 1**\n\n- If the principal in the scenario assigned a total of 200 students, the degrees of freedom for this analysis would be:  \n  - **2** (numerator) and **196** (denominator)\n\n## AFTER ANCOVA: Treatment Effect\n\n- **Now we need to follow-up to see where the differences lie.**\n\n- **Planned and Pairwise comparisons**\n  - ✓ based on the **adjusted means** and the **error term** after removing covariate variance\n  - ✓ Can interpret the same, **just be sure to note that it is the effect for the adjusted means**  \n    *(i.e., the means of DV after controlling for covariate)*\n\n- **Post-hoc tests**\n  - ✓ Not designed for situations in which a covariate is specified; however, you can obtain a limited selection.\n  - ✓ Tukey’s LSD; Bonferroni, Sidak Correction still work…\n\n\n## Problem: ANCOVA in Quasi-experimental Design I\n\n|                            | **True Experimental Design**                                                                 | **Quasi-Experimental Design**                                                                 |\n|----------------------------|----------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|\n| **Assignment to treatment**| The researcher *randomly assigns* subjects to control and treatment groups.                 | Some other, *non-random* method is used to assign subjects to groups.                         |\n| **Control over treatment** | The researcher usually *designs the treatment*.                                             | The researcher often *does not have control over the treatment*, but studies pre-existing groups. |\n| **Use of control groups**  | Requires the use of *control and treatment groups*.                                         | Control groups are not required (although they are commonly used).                            |\n\n## Problem: ANCOVA in Quasi-experimental Design II\n\n- **ANCOVA for an experimental design is pretty straightforward**\n  - ✓ It reduces error variance and increases power and is a great option if you have a good covariate and have met the ANCOVA assumptions.\n\n- **ANCOVA for quasi-experimental designs is controversial and risky**\n  - ✓ Some people say you shouldn’t do it at all. Others say you just have to be careful not to over-interpret and to be sure to do replications.\n\n- **Accounting for Pre-Existing Group Differences:**\n  - ➤ If people are not randomly assigned to conditions, there may be differences in the DV across the groups before the experiment starts.\n  - ➤ Some people use ANCOVA to “account for preexisting differences” of groups in a quasi-experimental design, then:\n    - ✓ ANCOVA equates groups on a particular covariate, but there is no guarantee that this is the only or most important dimension that the groups differ on.\n    - ✓ Equating pre-existing groups on one variable may accentuate differences on another variable.\n\n## Problem: ANCOVA in Quasi-experimental Design III\n\n- **What is the risk/concern with quasi-experimental design?**\n\n  ➤ For example, **the inclusion of the covariate adjusts the two groups’ means, as if they are the same on the covariate**.  \n  ➤ *Therefore, the two analyses are addressing two different research questions!*\n  - ✓ Pre-post change analysis addressed the $H_0\\!: \\mu_{\\text{female}} = \\mu_{\\text{male}}$\n  - ✓ ANCOVA analysis addressed the $H_0\\!: \\text{adjusted } \\mu_{\\text{female}} = \\text{adjusted } \\mu_{\\text{male}}$\n\n| **Biases the effect size of the IV**                                                                 | **Values can’t be trusted**                                                             |\n|-------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|\n| - Can remove real “effect variance” and attenuate the effect size                                     | - Adjusted means are implausible values                                                 |\n| - If other variables involved, can make it look like there is an effect when there isn’t              | - Interaction and slope values could just apply to the cells observed, not the population |\n\n## ANCOVA: Final Thoughts…\n\n- Use of covariates does not guarantee that groups will be “equivalent” —  \n  even after using multiple covariates, there still may be some confounding variables operating that you are unaware of.\n\n- Best way to overcome differences between groups due to variables other than the IV  \n  is to randomly assign subjects to groups.\n\n- Make sure that the covariate you are using is reliable!\n\n\n## Summary\n\n- This lecture leads you to go throught varied pieces of ANCOVA:\n    -   Why ANCOVA is better than ANOVA?\n    -   How is the ANCOVA hypotheses compared to ANOVA hypotheses\n    -   Adjusted Means after incorporating covariate\n    -   The potential problems of ANOVA when assumption violated\n    \n# Fin {.unnumbered}\n",
    "supporting": [
      "ESRM64103_Lecture12_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}