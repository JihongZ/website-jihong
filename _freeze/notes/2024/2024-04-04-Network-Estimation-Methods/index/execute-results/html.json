{
  "hash": "b873c6626519742c34135242170d3df1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Network analysis estimation for application research'\nsubtitle: 'Compare multiple R packages for psychological network analysis'\ndate: 'April 4 2024'\ncategories:\n  - R\n  - Bayesian\n  - Tutorial\n  - Network Analysis\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  fig-align: center\nformat: \n  html: \n    code-fold: true\n    code-summary: 'Click to see the code'\n    toc-location: left\n    toc-depth: 2\n    toc-expand: true\nbibliography: references.bib\ncsl: apa.csl\n---\n\n\n\n\n# Background\n\nMultiple estimation methods for network analysis have been proposed, from regularized to unregularized, from frequentist to Bayesian approach, from one-step to multiple steps.\n@isvoranuWhichEstimationMethod2023a provides an throughout illustration of current network estimation methods and simulation study.\nThis post tries to reproduce the procedures and coding illustrated by the paper and compare the results for packages with up-to-date version.\nFive packages will be used for network modeling: (1) `qgraph`, (2)`psychonetrics`, (3)`MGM`, (4)`BGGM`, (5)`GGMnonreg`.\nNote that the tutorial of each R package is not the scope of this post.\nThe specific variants of estimation is described in @fig-usedestimation.\nPlease see [here](../2024-03-05-Bayesian-GGM/index.qmd) for `BGGM` R package for more detailed example.\n\n![Estimation methods used in Isvoranu and Epskamp (2023)](estimation_methods_table.png){#fig-usedestimation fig-align=\"center\"}\n\n# Simulation Study 1\n\n## Data Generation\n\nFor the sake of simplicity, I will only pick one condition from the simulation settings.\nTo simulate data, I used the same code from the paper.\nThe function is a wrapper of `bootnet::ggmGenerator` function\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"dataGenerator() function\"}\nlibrary(\"bootnet\")\nlibrary(\"qgraph\")\n\nmycolors = c(\"#4682B4\", \"#B4464B\", \"#752021\",  \n             \"#1B9E77\", \"#66A61E\", \"#D95F02\", \"#7570B3\",\n             \"#E7298A\", \"#E75981\", \"#B4AF46\", \"#B4726A\")\n\ndataGenerator <- function(\n  trueNet,  # true network models: DASS21, PTSD, BFI\n  sampleSize, # sample size\n  data = c(\"normal\",\"skewed\",\"uniform ordered\",\"skewed ordered\"), # type of data\n  nLevels = 4,\n  missing = 0\n){\n  data <- match.arg(data)\n  nNode <- ncol(trueNet)\n  \n  if (data == \"normal\" || data == \"skewed\"){\n    # Generator function:\n    gen <- ggmGenerator()\n    \n    # Generate data:\n    Data <- gen(sampleSize,trueNet)\n    \n    # Generate replication data:\n    Data2 <- gen(sampleSize,trueNet)\n    \n    if (data == \"skewed\"){ ## exponential transformation to make data skewed\n      for (i in 1:ncol(trueNet)){\n        Data[,i] <- exp(Data[,i])\n        Data2[,i] <- exp(Data2[,i])\n      }\n    }\n  \n  } else {\n    # Skew factor:\n    skewFactor <- switch(data,\n                         \"uniform ordered\" = 1,\n                         \"skewed ordered\" = 2,\n                         \"very skewed ordered\" = 4)\n    \n    # Generator function:\n    gen <- ggmGenerator(ordinal = TRUE, nLevels = nLevels)\n    \n    # Make thresholds:\n    thresholds <- lapply(seq_len(nNode),function(x)qnorm(seq(0,1,length=nLevels + 1)[-c(1,nLevels+1)]^(1/skewFactor)))\n    \n    # Generate data:\n    Data <- gen(sampleSize, list(\n      graph = trueNet,\n      thresholds = thresholds\n    ))\n    \n    # Generate replication data:\n    Data2 <- gen(sampleSize, list(\n      graph = trueNet,\n      thresholds = thresholds\n    ))\n  }\n  \n  # Add missings:\n  if (missing > 0){\n    for (i in 1:ncol(Data)){\n      Data[runif(sampleSize) < missing,i] <- NA\n      Data2[runif(sampleSize) < missing,i] <- NA\n    }\n  }\n  \n  return(list(\n    data1 = Data,\n    data2 = Data2\n  ))\n}\n```\n:::\n\n\n\n\nBFI contains 26 columns: first columns are the precision matrix with 25 $\\times$ 25 and second columns as clusters.\nWe will use the structure of BFI for the simulation.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(here)\nbfi_truenetwork <- read.csv(here(\"notes\", \"2024\", \"2024-04-04-Network-Estimation-Methods\", \n                                 \"weights matrices\", \"BFI.csv\"))\nbfi_truenetwork <- bfi_truenetwork[,1:25]\nhead(psychTools::bfi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4\n61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4  3  4  2  2  3  3  6  3  4\n61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3  3  3  3  5  5  4  2  4  3\n61620  5  4  5  4  4  4  5  4  2  5  2  4  4  4  5  4  5  4  2  3  4  2  5  5\n61621  4  4  6  5  5  4  4  3  5  5  5  3  4  4  4  2  5  2  4  1  3  3  4  3\n61622  2  3  3  4  5  4  4  5  3  2  2  2  5  4  5  2  3  4  4  3  3  3  4  3\n61623  6  6  5  6  5  6  6  6  1  3  2  1  6  5  6  3  5  2  2  3  4  3  5  6\n      O5 gender education age\n61617  3      1        NA  16\n61618  3      2        NA  18\n61620  2      2        NA  17\n61621  5      2        NA  17\n61622  3      1        NA  17\n61623  1      2         3  21\n```\n\n\n:::\n:::\n\n\n\n\nTo generate data from `bootnet::ggmGenerator()`, we can generate a function `gen` from it with first argument as sample size and second argument as partial correlation matrix.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\ngen <- bootnet::ggmGenerator()\ndata <- gen(2800, as.matrix(bfi_truenetwork))\n```\n:::\n\n\n\n\n## Measures\n\n### Overview of Centrality Measures\n\nCentrality measures are used as one characteristic of network model to summarize the importance of nodes/items given a network.\nSome ideas of centrality measures come from social network.\nSome may not make much sense in psychometric network.\nI also listed the centrality measures that have been used in literatures of psychological or psychometric modeling.\nFollowing the terminology of @christensen2018, centrality measures include: (1) betweenness centrality (BC); (2) the randomized shortest paths betweeness centrality (RSPBC); (3) closeness centrality (CC); (4)node degree (ND); (5) node strength (NS); (6) expected influence (EI); (7) engenvector centrality (EC); (8) Eccentricity (*k;* @hage1995); (9) hybrid centrality (HC; @christensen2018a).\n\nThey can be grouped into three categories:\n\n[*Type 1*]{.underline}—Number of path relevant metrics: BC measures how often a node is on the shortest path from one node to another.\nRSPBC is a adjusted BC measure which measures how oftern a node is on the random shortest path from one to another; CC measures the average number of paths from one node to all other nodes in the network.\nND measures how many connections are connected to each node.\nEccentricity (*k*) measures the maximum \"distance\" between one node with other nodes with lower values suggests higher centrality, where one node's distance is the length of a shortest path between this node to other nodes.\n\n[*Type 2*]{.underline}—Path strength relevant metrics: **NS** measures the sum of the absolute values of edge weights connected to a single node.\n**EI** measures the sum of the positive or negative values of edge weights connected to a single node.\n\n[*Type 3*]{.underline}—Composite of multiple centrality measures: **HC** measures nodes on the basis of their centrality values across multiple measures of centrality (BC, LC, *k*, EC, and NS) which describes highly central nodes with large values and highly peripheral nodes with small values [@christensen2018b].\n\nSome literature of network psychometrics criticized the use of Type 1 centrality measures and some Type II centrality measures [@hallquist2021; @neal2022].\nFor example, @hallquist2021 argued that some Type I centrality measures such as BC and CC derive from the concept of distance, which builds on the physical nature of many traditional graph theory applications, including railways and compute networks.\nIn association networks, the idea of network distance does not have physical reference.\n@bringmann2019 also think distance-based centrality like closeness centrality (CC) and betweenness centrality (BC) do not have \"shortest path\", or \"node exchangeability\" assumptions in psychological networks so they are not suitable in the context of psychological network.\nIn addition, ND (degree), CC (closeness), and BC (betweenness) do not take negative values of edge weights into account that may lose important information in the context of psychology.\n\n### Network level accuracy metrics\n\nStructure accuracy measures such as *sensitivity*, specificity, and precision investigate if an true edge is include or not or an false edge is include or not.\nSeveral edge weight accuracy measures include: (1) correlation between absolute values of estimated edge weights and true edge weights, (2) average absolute bias between estimated edge weights and true weights, (3) average absolute bias for true edges.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor0 <- function(x,y,...){\n  if (sum(!is.na(x)) < 2 || sum(!is.na(y)) < 2 || sd(x,na.rm=TRUE)==0 | sd(y,na.rm=TRUE) == 0){\n    return(0)\n  } else {\n    return(cor(x,y,...))\n  }\n}\n\nbias <- function(x,y) mean(abs(x-y),na.rm=TRUE)\n\n\n### Inner function:\ncomparison_metrics <- function(real, est, name = \"full\"){\n  \n  # Output list:\n  out <- list()\n  \n  # True positives:\n  TruePos <- sum(est != 0 &  real != 0)\n  \n  # False pos:\n  FalsePos <- sum(est != 0 & real == 0)\n  \n  # True Neg:\n  TrueNeg <- sum(est == 0 & real == 0)\n  \n  # False Neg:\n  FalseNeg <- sum(est == 0 & real != 0)\n  \n  # Sensitivity:\n  out$sensitivity <- TruePos / (TruePos + FalseNeg)\n  \n  # Sensitivity top 50%:\n  top50 <- which(abs(real) > median(abs(real[real!=0])))\n  out[[\"sensitivity_top50\"]] <- sum(est[top50]!=0 & real[top50] != 0) / sum(real[top50] != 0)\n  \n  # Sensitivity top 25%:\n  top25 <- which(abs(real) > quantile(abs(real[real!=0]), 0.75))\n  out[[\"sensitivity_top25\"]] <- sum(est[top25]!=0 & real[top25] != 0) / sum(real[top25] != 0)\n  \n  # Sensitivity top 10%:\n  top10 <- which(abs(real) > quantile(abs(real[real!=0]), 0.90))\n  out[[\"sensitivity_top10\"]] <- sum(est[top10]!=0 & real[top10] != 0) / sum(real[top10] != 0)\n  \n  # Specificity:\n  out$specificity <- TrueNeg / (TrueNeg + FalsePos)\n  \n  # Precision (1 - FDR):\n  out$precision <- TruePos / (FalsePos + TruePos)\n  \n  # precision top 50% (of estimated edges):\n  top50 <- which(abs(est) > median(abs(est[est!=0])))\n  out[[\"precision_top50\"]] <- sum(est[top50]!=0 & real[top50] != 0) / sum(est[top50] != 0)\n  \n  # precision top 25%:\n  top25 <- which(abs(est) > quantile(abs(est[est!=0]), 0.75))\n  out[[\"precision_top25\"]] <- sum(est[top25]!=0 & real[top25] != 0) / sum(est[top25] != 0)\n  \n  # precision top 10%:\n  top10 <- which(abs(est) > quantile(abs(est[est!=0]), 0.90))\n  out[[\"precision_top10\"]] <- sum(est[top10]!=0 & real[top10] != 0) / sum(est[top10] != 0)\n  \n  # Signed sensitivity:\n  TruePos_signed <- sum(est != 0 &  real != 0 & sign(est) == sign(real))\n  out$sensitivity_signed <- TruePos_signed / (TruePos + FalseNeg)\n  \n  # Correlation:\n  out$correlation <- cor0(est,real)\n  \n  # Correlation between absolute edges:\n  out$abs_cor <- cor0(abs(est),abs(real))\n  \n  #\n  out$bias <- bias(est,real)\n  \n  ## Some measures for true edges only:\n  if (TruePos > 0){\n    \n    trueEdges <- est != 0 & real != 0\n    \n    out$bias_true_edges <- bias(est[trueEdges],real[trueEdges])\n    out$abs_cor_true_edges <- cor0(abs(est[trueEdges]),abs(real[trueEdges]))\n  } else {\n    out$bias_true_edges <- NA\n    out$abs_cor_true_edges <- NA\n  }\n  \n  out$truePos <- TruePos\n  out$falsePos <- FalsePos\n  out$trueNeg <- TrueNeg\n  out$falseNeg <- FalseNeg\n  \n  # Mean absolute weight false positives:\n  false_edges <- (est != 0 &  real == 0) | (est != 0 & real != 0 & sign(est) != sign(real) )\n  out$mean_false_edge_weight <- mean(abs(est[false_edges]))\n  out$SD_false_edge_weight <- sd(abs(est[false_edges]))\n  \n  # Fading:\n  out$maxfade_false_edge <- max(abs(est[false_edges])) / max(abs(est))\n  out$meanfade_false_edge <- mean(abs(est[false_edges])) / max(abs(est))\n  \n  \n  # Set naname\n  if (name != \"\"){\n    names(out) <- paste0(names(out),\"_\",name)  \n  }\n  out\n}\n```\n:::\n\n\n\n\n## Estimation\n\n::: panel-tabset\n### Method 1 - EBICglasso in bootnet\n\nThis method uses the `bootnet::estimateNetwork` function.\n\nThis method makes used of polychoric correlation as input, graphical LASSO as regularlization, and EBIC as model selection method. The polychoric correlation is a technique for estimating the correlation between two hypothesised normally distributed continuous latent variables, from two observed ordinal variables.\n\nThe figure below plot the relationships between two continous variables vs. relationships between two ordinal variables (using `floor` function). It appears that they did not deviate a lot given the values of pearson correlation (-.32) and polychoric correlation (-.3).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndt <- as.data.frame(data[, 1:2])\ndt_ordinal <- as.data.frame(floor(data[, 1:2]))\n\n # polychoric correlation\npearson_corr <- round(cor_auto(dt[, 1:2])[1, 2], 2)\npolychoric_corr <- round(cor_auto(floor(data[, 1:2]))[1, 2], 2)\nggplot(dt) +\n  geom_point(aes(x = V1, y = V2), data = dt, color = mycolors[1], alpha = .4) +\n  geom_smooth(aes(x = V1, y = V2), data = dt, color = mycolors[1], method = \"lm\", se = FALSE) +\n  geom_point(aes(x = V1, y = V2), data = dt_ordinal, color = mycolors[2]) +\n  geom_smooth(aes(x = V1, y = V2), data = dt_ordinal, color = mycolors[2], method = \"lm\", se = FALSE) +\n  geom_text(aes(x = 2, y = 2, label = paste0(\"Pearson: \", pearson_corr))) +\n  geom_text(aes(x = 2, y = 1.7, label = paste0(\"Polychoric: \", polychoric_corr))) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n`EBICtuning <- 0.5` sets up the hyperparameter ($\\gamma$) as .5 that controls how much the EBIC prefers simpler models (fewer edges), which by default is .5.\n\n$$\n\\text{EBIC} =-2L+\\log(N)+4\\gamma \\log(P)\n$$\n\n$$\n\\text{AIC} = -2L + 2P\n$$\n\n$$\n\\text{BIC} = -2L + P\\log(N) \n$$\n\nAnother important setting is the tuning parameter ($\\lambda$) of EBICglasso that controls the sparsity level in the penalized likelihood function as:\n\n$$\n\\log \\det(\\boldsymbol{K}) - \\text{trace}(\\boldsymbol{SK})-\\lambda \\Sigma|\\kappa_{ij}|\n$$\n\nwhere $\\boldsymbol{S}$ represents the sample variance-covariance matrix and $\\boldsymbol{K}$ represents the precision matrix that *lasso* aims to estimate.\nOverall, the regularization limits the sum of absolute partial correlation coefficients.\n\n`sampleSize=\"pairwise_average\"` will set the sample size to the average of sample sizes used for each individual correlation in `EBICglasso`.\n\n@fig-bfi is the estimated network structure with BFI-25 data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 1: EBICglasso\"}\nlibrary(\"qgraph\")\nlibrary(\"bootnet\")\nsampleAdjust  <-  \"pairwise_average\"\nEBICtuning <- 0.5\ntransformation <- \"polychoric/categorical\" # EBICglasso use cor_auto\nres_m1 <- estimateNetwork(data, # input as polychoric correlation\n                          default = \"EBICglasso\",\n                          sampleSize = sampleAdjust,\n                          tuning = EBICtuning,\n                          corMethod = ifelse(transformation == \"polychoric/categorical\",\n                                             \"cor_auto\",\n                                             \"cor\"))\n    \nestnet_m1 <- res_m1$graph\nsummary(res_m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== Estimated network ===\nNumber of nodes: 25 \nNumber of non-zero edges: 159 / 300 \nMean weight: 0.02147125 \nNetwork stored in object$graph \n \nDefault set used: EBICglasso \n \nUse plot(object) to plot estimated network \nUse bootnet(object) to bootstrap edge weights and centrality indices \n\nRelevant references:\n\n \tFriedman, J. H., Hastie, T., & Tibshirani, R. (2008). Sparse inverse covariance estimation with the graphical lasso. Biostatistics, 9 (3), 432-441.\n\tFoygel, R., & Drton, M. (2010). Extended Bayesian information criteria for Gaussian graphical models. \n\tFriedman, J. H., Hastie, T., & Tibshirani, R. (2014). glasso: Graphical lasso estimation of gaussian graphical models. Retrieved from https://CRAN.R-project.org/package=glasso\n\tEpskamp, S., Cramer, A., Waldorp, L., Schmittmann, V. D., & Borsboom, D. (2012). qgraph: Network visualizations of relationships in psychometric data. Journal of Statistical Software, 48 (1), 1-18.\n\tEpskamp, S., Borsboom, D., & Fried, E. I. (2016). Estimating psychological networks and their accuracy: a tutorial paper. arXiv preprint, arXiv:1604.08462.\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 1: EBICglasso\"}\nstr(res_m1$results)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 5\n $ results:List of 5\n  ..$ w      : num [1:25, 1:25, 1:100] 1 -0.328 -0.273 -0.12 -0.185 ...\n  ..$ wi     : num [1:25, 1:25, 1:100] 1.2011 0.3053 0.1755 -0.0059 0.0104 ...\n  ..$ approx : logi FALSE\n  ..$ rholist: num [1:100] 0.0069 0.00723 0.00758 0.00794 0.00832 ...\n  ..$ errflag: int [1:100] 0 0 0 0 0 0 0 0 0 0 ...\n $ ebic   : num [1:100] 53484 53460 53451 53413 53405 ...\n $ optnet : num [1:25, 1:25] 0 -0.214234 -0.113192 0 -0.000263 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : chr [1:25] \"V1\" \"V2\" \"V3\" \"V4\" ...\n  .. ..$ : chr [1:25] \"V1\" \"V2\" \"V3\" \"V4\" ...\n $ lambda : num [1:100] 0.0069 0.00723 0.00758 0.00794 0.00832 ...\n $ optwi  : num [1:25, 1:25] 1.165044 0.285643 0.15788 0 0.000361 ...\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 1: EBICglasso\"}\nEBIC = mean(res_m1$results$ebic) # EBIC of the final model\n(AIC = EBIC - 2 * log(nrow(data))) # AIC =  52287.32\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 56835.81\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 1: EBICglasso\"}\nqgraph(estnet_m1)\n```\n\n::: {.cell-output-display}\n![Method 1: Network Plot for BFI-25 with EBICglasso](index_files/figure-html/fig-bfi-1.png){#fig-bfi width=288}\n:::\n:::\n\n\n\n\n### Method 2 - ggmModSelect in bootnet\n\nThe *ggmModSelect* algorithm is a non-regularized method.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 2: ggmModSelect\"}\n# With stepwise\nres_m2_1 <- estimateNetwork(data, default = \"ggmModSelect\",\n                           sampleSize = sampleAdjust, stepwise = TRUE,\n                           tuning = EBICtuning,\n                           corMethod = ifelse(transformation == \"polychoric/categorical\",\n                                              \"cor_auto\",\n                                              \"cor\"))\n\nestnet_m2_1 <- res_m2_1$graph\nqgraph(estnet_m2_1)\n```\n\n::: {.cell-output-display}\n![Method 2.1: Network Plot for BFI-25 with ggmModSelect and Stepwise](index_files/figure-html/fig-m2_1-1.png){#fig-m2_1 width=288}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 2: ggmModSelect\"}\n# Without stepwise\nres_m2_2 <- estimateNetwork(data, default = \"ggmModSelect\",\n                           sampleSize = sampleAdjust, stepwise = FALSE,\n                           tuning = EBICtuning,\n                           corMethod = ifelse(transformation == \"polychoric/categorical\",\n                                              \"cor_auto\",\n                                              \"cor\"))\nestnet_m2_2 <- res_m2_2$graph\nqgraph(estnet_m2_2)\n```\n\n::: {.cell-output-display}\n![Method 2.1: Network Plot for BFI-25 with ggmModSelect and No Stepwise](index_files/figure-html/fig-m2_2-1.png){#fig-m2_2 width=288}\n:::\n:::\n\n\n\n\n### Method 3 - FIML in psychonetrics\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 3: FIML\"}\nlibrary(psychonetrics)\nlibrary(magrittr)\n# With stepwise\nres_m3_1 <- ggm(data, estimator = \"FIML\", standardize = \"z\") %>% \n  prune(alpha = .01, recursive = FALSE) \n    \nestnet_m3_1 <- getmatrix(res_m3_1, \"omega\")\nfit(res_m3_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Measure     Value\n              logl -89564.34\n unrestricted.logl -89461.96\n     baseline.logl -99313.20\n              nvar        25\n              nobs       350\n              npar       165\n                df       185\n         objective     18.03\n             chisq    204.76\n            pvalue      0.15\n    baseline.chisq  19702.47\n     baseline.npar        50\n       baseline.df       300\n   baseline.pvalue       ~ 0\n               nfi      0.99\n              pnfi      0.61\n               tli       1.0\n              nnfi       1.0\n               rfi      0.98\n               ifi       1.0\n               rni       1.0\n               cfi       1.0\n             rmsea    0.0062\n    rmsea.ci.lower       ~ 0\n    rmsea.ci.upper     0.011\n      rmsea.pvalue         1\n            aic.ll 179458.68\n           aic.ll2 179479.48\n             aic.x   -165.24\n            aic.x2    534.76\n               bic 180438.35\n              bic2 179914.09\n           ebic.25 180969.46\n            ebic.5 181500.58\n           ebic.75 181925.47\n             ebic1 182562.81\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 3: FIML\"}\nqgraph(estnet_m3_1)\n```\n\n::: {.cell-output-display}\n![Method 3: Network Plot for BFI-25 with FIML and Prue](index_files/figure-html/fig-m3_1-1.png){#fig-m3_1 width=288}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 3: FIML\"}\n# With stepwise\nres_m3_2 <- ggm(data, estimator = \"FIML\", standardize = \"z\") %>% \n  prune(alpha = .01, recursive = FALSE) |> \n  stepup(alpha = .01)\n    \nestnet_m3_2 <- getmatrix(res_m3_2, \"omega\")\n\nqgraph(estnet_m3_2)\n```\n\n::: {.cell-output-display}\n![Method 3: Network Plot for BFI-25 with FIML and Stepup](index_files/figure-html/fig-m3_2-1.png){#fig-m3_2 width=288}\n:::\n:::\n\n\n\n\n### Method 4 - WLS in psychonetrics\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 4: WLS\"}\n# With stepwise\nres_m4_1 <- ggm(data, estimator = \"WLS\", standardize = \"z\") %>% \n  prune(alpha = .01, recursive = FALSE) \n    \nestnet_m4_1 <- getmatrix(res_m4_1, \"omega\")\n\nqgraph(estnet_m4_1)\n```\n\n::: {.cell-output-display}\n![Method 4: Network Plot for BFI-25 with WLS and prune](index_files/figure-html/fig-m4_1-1.png){#fig-m4_1 width=288}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 4: WLS\"}\nres_m4_2 <- ggm(data, estimator = \"WLS\", standardize = \"z\") %>% \n  prune(alpha = .01, recursive = FALSE) |> \n  modelsearch(prunealpha = .01, addalpha = .01)\n    \nestnet_m4_2 <- getmatrix(res_m4_2, \"omega\")\n\nqgraph(estnet_m4_2)\n```\n\n::: {.cell-output-display}\n![Method 4: Network Plot for BFI-25 with WLS, prune, and modelsearch](index_files/figure-html/fig-m4_2-1.png){#fig-m4_2 width=288}\n:::\n:::\n\n\n\n\n### Method 5 - mgm in mgm\n\n`mgm` package is used for estimating mixed graphical models.\nNode type can be \"g\" for Gaussian or \"c\" for categorical.\nFor continuous variables, set `level` to 1 and `type` to g.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 5: mgm\"}\nlibrary(mgm)\n## mgm with CV\nres_m5_1 <- mgm(na.omit(data), type = rep(\"g\", ncol(data)), level = rep(1, ncol(data)), \n           lambdaFolds = 20,\n           lambdaSel = \"CV\", lambdaGam = EBICtuning, \n           pbar = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNote that the sign of parameter estimates is stored separately; see ?mgm\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 5: mgm\"}\ngetmatrix_mgm <- function(res) {\n  sign = ifelse(is.na(res$pairwise$signs), 1, res$pairwise$signs)\n  sign * res$pairwise$wadj\n}\nestnet_m5_1 <- getmatrix_mgm(res_m5_1)\nqgraph(estnet_m5_1)\n```\n\n::: {.cell-output-display}\n![Method 5: Network Plot for BFI-25 with mgm and CV](index_files/figure-html/fig-m5_1-1.png){#fig-m5_1 width=288}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 5: mgm\"}\n## mgm with EBIC\nres_m5_2 <- mgm(na.omit(data), type = rep(\"g\", ncol(data)), level = rep(1, ncol(data)), \n           lambdaFolds = 20,\n           lambdaSel = \"EBIC\", lambdaGam = EBICtuning,\n           pbar = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNote that the sign of parameter estimates is stored separately; see ?mgm\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 5: mgm\"}\nestnet_m5_2 <- getmatrix_mgm(res_m5_2)\nqgraph(estnet_m5_2)\n```\n\n::: {.cell-output-display}\n![Method 5: Network Plot for BFI-25 with mgm and EBIC](index_files/figure-html/fig-m5_2-1.png){#fig-m5_2 width=288}\n:::\n:::\n\n\n\n\n### Method 6 - BGGM in BGGM\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 6: BGGM\"}\nres_m6_1 <- BGGM::explore(data, type = \"continuous\") |> \n  BGGM:::select.explore(BF_cut = 3)\nestnet_m6_1 <- res_m6_1$pcor_mat_zero\nqgraph(estnet_m6_1)\n```\n\n::: {.cell-output-display}\n![Method 6: Network Plot for BFI-25 with BGGM and explore](index_files/figure-html/fig-m6_1-1.png){#fig-m6_1 width=288}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"Method 6: BGGM\"}\nres_m6_2 <- BGGM::explore(data, type = \"continuous\") |> \n  BGGM:::select.estimate(cred = 0.95)\nestnet_m6_2 <- res_m6_2$pcor_adj\nqgraph(estnet_m6_2)\n```\n\n::: {.cell-output-display}\n![Method 6: Network Plot for BFI-25 with BGGM and estimate](index_files/figure-html/fig-m6_2-1.png){#fig-m6_2 width=288}\n:::\n:::\n\n\n\n:::\n\n## Performance Comparison\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nperformance <- function(network) {\n  res_comparison <- comparison_metrics(real = as.matrix(bfi_truenetwork), est = as.matrix(network))\n  c(\n    sensitivity = res_comparison$sensitivity_full,\n    specificity = res_comparison$specificity_full,\n    precision = res_comparison$precision_full,\n    \n    abs_corr = res_comparison$abs_cor_true_edges_full, # The Pearson correlation between the absolute edge weights\n    bias = res_comparison$bias_full, # The average absolute deviation\n    bias_true = res_comparison$bias_true_edges_full # The average absolute deviation between the true edge weight and the estimated edge weight\n  )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nperformance_compr <- Reduce(rbind, lapply(list(estnet_m1, estnet_m2_1, estnet_m2_2, \n                                               estnet_m3_1, estnet_m3_2,\n                                               estnet_m4_1, estnet_m4_2,\n                                               estnet_m5_1, estnet_m5_2,\n                                               estnet_m6_1, estnet_m6_2), performance))\nrownames(performance_compr) <- c(\"EBICglasso\", \"ggmModSelect_stepwise\", \"ggmModSelect_nostepwise\",\n                                 \"FIML_prune\", \"FIML_stepup\",\n                                 \"WLS_prune\", \"WLS_prune_modelsearch\",\n                                 \"mgm_CV\", \"mgm_EBIC\",\n                                 \"BGGM_explore\", \"BGGM_estimate\")\nkableExtra::kable(performance_compr, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|                        | sensitivity| specificity| precision| abs_corr|  bias| bias_true|\n|:-----------------------|-----------:|-----------:|---------:|--------:|-----:|---------:|\n|EBICglasso              |       1.000|       0.766|     0.704|    0.969| 0.008|     0.018|\n|ggmModSelect_stepwise   |       0.938|       0.995|     0.991|    0.973| 0.006|     0.014|\n|ggmModSelect_nostepwise |       0.964|       0.900|     0.844|    0.973| 0.007|     0.013|\n|FIML_prune              |       0.973|       0.970|     0.948|    0.974| 0.006|     0.013|\n|FIML_stepup             |       0.982|       0.970|     0.948|    0.974| 0.006|     0.013|\n|WLS_prune               |       0.973|       0.970|     0.948|    0.969| 0.007|     0.014|\n|WLS_prune_modelsearch   |       0.973|       0.970|     0.948|    0.969| 0.007|     0.014|\n|mgm_CV                  |       1.000|       0.855|     0.794|    0.969| 0.008|     0.016|\n|mgm_EBIC                |       0.920|       0.995|     0.990|    0.971| 0.010|     0.023|\n|BGGM_explore            |       0.920|       0.990|     0.981|    0.965| 0.007|     0.015|\n|BGGM_estimate           |       1.000|       0.915|     0.868|    0.964| 0.008|     0.015|\n\n\n:::\n:::\n\n\n\n\n## Summary\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nmycolors = c(\"#4682B4\", \"#B4464B\", \"#752021\",  \n             \"#1B9E77\", \"#66A61E\", \"#D95F02\", \"#7570B3\",\n             \"#E7298A\", \"#E75981\", \"#B4AF46\", \"#B4726A\")\nperformance_tbl <- performance_compr |> \n  as.data.frame() |> \n  mutate(method = rownames(performance_compr)) |> \n  mutate(method = factor(method, levels = rownames(performance_compr))) |> \n  filter(\n    method != \"WLS_prune_modelsearch\"\n  )\nggplot(performance_tbl) +\n  geom_point(aes(x = sensitivity, y = specificity, col = method), size = 3) +\n  geom_text(aes(x = sensitivity, y = specificity, label = method), size = 3,\n            nudge_x = .005, nudge_y = .005) +\n  geom_smooth(aes(x = sensitivity, y = specificity), se = FALSE, method = lm) +\n  theme_bw() +\n  scale_color_manual(values = mycolors) +\n  theme(legend.position = 'bottom')\n```\n\n::: {.cell-output-display}\n![Specificity and Sensitivity Balance](index_files/figure-html/fig-summary01-1.png){#fig-summary01 width=768}\n:::\n:::\n\n\n\n\n`FLML_prune` and `BGGM_estimation` seem to perform best among all methods regarding balance between sensitivity and specificity of network weights.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(performance_tbl) +\n  geom_col(aes(y = forcats::fct_reorder(method, precision), x = precision, fill = method)) +\n  theme_bw() +\n  labs(y = \"\") +\n  theme(legend.position = 'bottom')\n```\n\n::: {.cell-output-display}\n![Precision among all methods](index_files/figure-html/fig-summary02-1.png){#fig-summary02 width=960}\n:::\n:::\n\n\n\n\n`ggmMoSelect` with the stepwise procedure appears to have highest precision, followed by BGGM explore.\n\n# Empirical study 1: PTSD networks\n\nThis study examines the reliability and replicability of the network structure of PTSD symptoms in a large sample of trauma-exposed individuals.\nFried et al. (2018) shared their correlation matrices, model output, and code in the [Supplementary Materials](https://doi.org/10.1080/00273171.2019.1616526) and encouraged reanalysis of the data for further replicability research.\nThis data sets were reanalyzed by [@forbesQuantifyingReliabilityReplicability2021].\n\n## Research Plan\n\nFirst, the PTSD network structure will be estimated through three models:\n\n-   **Model 1**: Gaussian graphical models (GGMs) derived from polychoric correlations using fused graphical lasso selecting tuning parameters using k-fold cross-validation first.\n\n-   **Model 2**: GGM using FIML in *psychonetrics* (`FLML_prune`)\n\n-   **Model 3**: Bayesian GGM using `BGGM_estimation`, which have best performance in sensitivity and specificity.\n\nSecond, the parameter estimation and network characteristics will be carefully screened and reviewed.\nSome important network characteristics include:\n\n1.  Symptom strength centrality\n\n## Data Information\n\n\"*The primary analyses were based on a subset of community participants from a larger longitudinal study. Analyses included 403 participants who completed questions online regarding depression and anxiety symptoms two times one week apart.* [@forbesQuantifyingReliabilityReplicability2021]\"\n\n## Data Analysis\n\nTo replicate the same analysis as @forbesQuantifyingReliabilityReplicability2021, we used the raw data from their OSF project (<https://osf.io/6fk3v/>)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"List the files in the OSF project of (Forbes et al., 2021)\"}\nlibrary(osfr)\nforbes2018 <- project <- osf_retrieve_node(\"https://osf.io/6fk3v/\")\nosf_ls_files(forbes2018)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 3\n  name                                  id                       meta        \n  <chr>                                 <chr>                    <list>      \n1 Comparing PTSD networks.R             5b99a0ea296328001ac7af0e <named list>\n2 bootnet edges T2.csv                  5a8f462291b689000d9ebfdb <named list>\n3 bootnet edges T1.csv                  5a8f4620da91d4000eafd645 <named list>\n4 MBR paper code_R1_4Setp2018.R         605c02d5e12b600049aa6646 <named list>\n5 Comparing edges between networks.xlsx 5a8f462291b689000f9f074a <named list>\n6 Long_ESEM_WLSMV_unconstr.inp          5a8f460b91b689000d9ebfcd <named list>\n7 time1and2data_wide.csv                5a8f45ee91b689000d9ebfb5 <named list>\n8 MBR paper code.R                      5a8f45fcda91d4000faedd86 <named list>\n9 Long_ESEM_WLSMV_constr.inp            5a8f4609da91d40010af0c47 <named list>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Download the time1and2data_wide.csv\"}\nforbes2018_files <- osf_ls_files(forbes2018)\nosf_download(forbes2018_files[7, ], path = \"PTSD_network/\")\nosf_download(forbes2018_files[4, ], path = \"PTSD_network/\")\n```\n:::\n\n\n\n\nThere are 403 participants with 40 variables and 1 ID.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Read in the data set\"}\n# Set the random seed:\nset.seed(123)\n\n# Load time1 dataset:\ntime1and2data <- read.csv(\"PTSD_network/time1and2data_wide.csv\", header=FALSE)\ntime1and2data<-as.data.frame(time1and2data)\ntime1data<- time1and2data[c(2:17)]\ntime1data<-as.data.frame(time1data)\nlabels_time1and2data <- c(\"PHQ1\",\"PHQ2\",\"PHQ3\",\"PHQ4\",\"PHQ5\",\"PHQ6\",\"PHQ7\",\n                       \"PHQ8\",\"PHQ9\",\"GAD1\",\"GAD2\",\"GAD3\",\"GAD4\",\"GAD5\",\n                       \"GAD6\",\"GAD7\")\ngroups_time1and2data <- c(rep(\"Depression\", 9), rep(\"Anxiety\", 7))  \ntime2data<- time1and2data[c(18:33)]\ntime2data<-as.data.frame(time2data)\ncolnames(time2data) <- colnames(time1data) <- labels_time1and2data\nLabels<- c(\"interest\", \"feel down\", \"sleep\", \"tired\", \"appetite\", \"self-esteem\", \n            \"concentration\", \"psychomotor\", \"suicidality\", \"feel nervous\", \n            \"uncontrollable worry\", \"worry a lot\", \"trouble relax\", \"restless\", \n            \"irritable\", \"something awful\")\ntime1dep<-time1data[c(1:9)]\ntime1anx<-time1data[c(10:16)]\ntime2dep<-time2data[c(1:9)]\ntime2anx<-time2data[c(10:16)]\n```\n:::\n\n\n\n\nThe Patient Health Questionnaire (PHQ-9; Kroenke, Spitzer & Williams, 2001) is a 9-item measure of depression symptoms with cutoff scores that indicate clinically significant levels of major depression.\nThe Brief Measure for Assessing Generalized Anxiety Disorder (GAD-7; Spitzer, Kroenke, Williams & Lowe, 2006) is a 7-item measure of anxiety symptoms with cutoff scores that indicate clinically significant levels of generalized anxiety (Spitzer et al., 2006).\n\nBoth questionnaires have the scale options (0 – “Not at all,” 1 – “Several days,” 2 – “More than half the days,”, 3 – “Nearly every day”).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Time 1 dataset\"}\nlibrary(gt)\nlibrary(DT)\ndatatable(time1data)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-9eceb20dc2a931752ae4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9eceb20dc2a931752ae4\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\",\"327\",\"328\",\"329\",\"330\",\"331\",\"332\",\"333\",\"334\",\"335\",\"336\",\"337\",\"338\",\"339\",\"340\",\"341\",\"342\",\"343\",\"344\",\"345\",\"346\",\"347\",\"348\",\"349\",\"350\",\"351\",\"352\",\"353\",\"354\",\"355\",\"356\",\"357\",\"358\",\"359\",\"360\",\"361\",\"362\",\"363\",\"364\",\"365\",\"366\",\"367\",\"368\",\"369\",\"370\",\"371\",\"372\",\"373\",\"374\",\"375\",\"376\",\"377\",\"378\",\"379\",\"380\",\"381\",\"382\",\"383\",\"384\",\"385\",\"386\",\"387\",\"388\",\"389\",\"390\",\"391\",\"392\",\"393\",\"394\",\"395\",\"396\",\"397\",\"398\",\"399\",\"400\",\"401\",\"402\",\"403\"],[1,2,1,0,1,1,1,0,0,1,0,2,2,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,2,0,3,2,1,1,0,3,1,2,2,0,3,2,0,0,1,0,0,1,0,0,0,0,2,2,2,1,0,1,2,0,1,2,1,0,2,3,0,0,1,0,0,3,0,0,2,1,1,0,2,2,0,2,3,2,1,2,1,1,2,0,2,0,1,2,1,1,0,3,0,0,0,1,3,2,1,0,0,0,1,0,2,0,1,2,0,2,0,0,3,0,1,1,0,0,1,1,1,1,1,1,1,0,2,0,3,2,1,1,0,0,0,0,1,0,0,1,0,1,1,0,0,2,2,0,0,0,3,1,1,1,1,0,2,1,0,2,1,1,1,0,1,1,0,1,3,1,0,0,1,0,1,1,0,1,1,0,0,1,1,2,1,0,1,0,3,0,0,1,0,0,3,2,2,2,0,3,1,1,3,0,0,0,2,1,0,0,0,1,0,1,0,0,0,1,1,1,0,2,0,0,1,1,2,0,0,0,1,0,0,0,1,3,2,0,0,0,2,0,3,1,0,2,3,2,1,0,0,0,0,3,0,1,1,0,1,0,0,0,2,0,1,0,0,1,0,0,0,0,1,2,1,0,3,1,1,1,1,0,1,0,0,0,0,0,1,1,1,2,0,2,1,2,1,1,1,1,0,0,1,3,1,1,0,0,2,0,0,2,2,1,1,0,0,1,1,0,1,0,0,0,1,0,1,1,0,1,0,1,3,0,0,1,2,1,3,2,0,1,0,0,0,1,1,0,1,3,0,1,1,0,0,0,1,1,1,1,0,2,0,1,1,1,1,0,0,1,0,1,1,1,3,0,0,1,0,1,2,1,0,0,0,1,3,0,0,1,1,0,2,1,1,1],[2,3,1,0,0,1,1,1,0,1,0,2,2,0,0,1,1,1,1,2,0,0,1,0,1,0,1,1,1,3,1,3,2,1,0,0,0,1,3,2,0,2,1,0,0,2,1,0,1,0,0,0,1,2,3,1,0,1,1,3,0,1,3,1,0,3,2,0,1,3,0,1,2,1,0,3,1,1,0,3,2,0,2,1,2,1,2,2,2,2,0,1,0,1,1,0,0,0,3,0,0,1,1,3,1,2,0,1,0,0,0,2,0,1,1,1,2,0,1,3,0,1,2,0,0,1,1,1,1,1,1,0,1,1,0,3,3,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,1,1,0,0,1,3,1,1,1,1,0,1,1,1,2,2,1,0,0,1,1,1,1,2,1,0,0,2,0,1,1,0,1,1,0,0,0,1,1,0,0,1,1,3,0,0,2,1,0,3,1,2,2,1,3,0,0,3,0,1,0,1,1,1,3,1,1,1,2,0,0,0,1,1,2,0,0,0,0,1,1,1,0,0,0,1,0,0,0,1,1,3,0,0,0,1,0,2,1,0,1,3,2,1,0,1,0,0,3,0,1,1,1,1,0,1,0,2,0,1,1,1,1,0,0,0,1,0,1,1,0,2,1,1,1,0,0,1,0,0,0,0,1,1,1,1,3,0,3,1,2,1,0,1,1,0,1,1,1,1,2,0,0,2,0,0,0,1,1,1,0,0,1,1,0,1,0,0,0,1,1,1,1,0,1,0,1,0,1,1,2,1,1,1,1,0,1,0,0,0,1,2,0,1,3,0,1,1,0,0,0,0,1,1,0,1,3,0,0,1,1,1,0,0,0,0,1,1,1,3,1,0,0,1,1,2,1,1,0,1,1,3,0,0,1,1,1,1,1,1,1],[1,2,2,0,1,0,3,1,0,2,0,3,2,0,1,0,0,0,1,2,0,0,1,0,2,1,3,0,2,2,0,3,2,3,1,0,0,1,3,3,0,2,1,0,1,3,1,1,1,0,1,0,1,2,2,1,2,1,2,3,0,3,2,2,1,1,3,1,1,3,1,0,3,0,0,2,0,0,0,3,2,0,1,0,3,3,0,2,2,2,1,0,0,1,1,1,1,0,3,0,1,2,3,1,2,1,0,1,1,1,1,2,1,3,2,1,2,0,0,3,0,2,1,0,0,1,1,2,1,1,3,0,1,1,1,3,3,0,1,1,0,0,1,1,1,0,1,1,0,2,1,0,3,1,1,1,1,2,1,1,2,2,2,1,1,0,2,0,2,2,1,1,1,1,2,2,0,0,0,2,1,1,0,1,2,1,0,0,1,0,1,2,0,1,1,3,0,0,3,3,1,3,2,1,3,1,3,3,1,3,2,2,1,3,1,0,3,1,2,1,2,1,0,1,1,3,2,0,2,1,0,2,1,3,0,3,0,0,0,0,0,2,3,2,1,0,0,2,3,2,1,0,1,3,2,2,1,3,0,1,1,0,1,1,0,1,1,0,0,2,0,2,1,1,1,1,0,1,0,1,1,0,0,3,1,3,1,1,1,1,1,1,0,1,1,1,3,1,3,1,1,1,2,1,2,1,0,0,1,1,0,2,2,1,1,3,1,0,2,2,1,1,0,0,0,2,3,3,1,0,0,1,1,3,1,1,2,0,1,1,1,2,3,2,1,2,1,0,2,0,1,0,1,0,0,0,2,1,1,1,0,1,0,2,0,1,0,1,1,1,1,1,1,1,0,0,2,1,2,2,0,2,0,1,0,2,1,3,1,1,1,0,2,3,0,0,0,1,1,1,1,1,0],[1,2,2,0,1,1,2,1,0,1,0,3,2,1,1,1,1,0,1,3,0,1,1,1,2,1,3,3,2,3,2,3,3,2,1,1,1,1,3,3,0,2,1,0,1,2,0,1,0,2,1,0,1,2,2,1,1,0,1,3,1,2,1,1,0,1,3,1,1,3,1,1,3,1,0,2,1,3,1,3,1,1,1,2,3,3,1,2,2,2,1,1,0,1,1,2,1,1,3,0,1,1,2,1,2,1,1,1,1,1,1,1,1,3,3,1,2,0,1,3,0,2,2,0,0,1,1,1,1,2,3,1,2,2,1,2,3,1,3,1,1,0,1,2,0,0,1,0,1,2,1,0,3,1,0,1,1,3,1,1,2,2,2,1,1,0,2,0,2,3,1,1,1,1,2,1,1,1,0,2,0,0,0,2,2,2,0,1,1,1,3,3,1,3,1,3,1,0,2,1,1,3,1,1,3,1,3,3,1,3,2,2,3,3,1,0,3,0,3,1,2,0,2,1,3,3,1,0,1,1,0,3,1,3,1,2,0,1,0,1,1,1,2,1,1,1,0,2,1,2,1,0,1,3,2,1,1,2,0,1,3,0,2,2,2,2,2,1,0,2,1,2,1,0,1,0,1,0,1,1,2,1,0,3,3,1,1,1,1,1,1,1,1,0,1,1,3,1,3,1,3,1,3,1,1,2,1,0,1,1,2,1,1,1,1,3,0,1,1,3,1,1,1,0,0,2,1,1,0,1,0,1,0,2,1,0,1,0,1,3,0,0,3,3,1,2,2,0,1,0,1,0,1,1,0,1,2,1,1,1,0,1,0,2,1,1,1,2,3,1,0,2,1,2,0,1,1,0,2,2,0,3,0,1,1,2,1,3,2,1,1,1,2,3,1,0,0,1,1,1,0,3,1],[0,3,2,0,1,2,2,0,0,2,0,2,2,0,0,1,1,0,0,3,0,0,1,0,2,0,1,3,1,0,2,3,0,2,1,0,0,1,3,2,0,2,1,0,1,1,2,0,1,2,0,2,0,2,3,3,2,1,2,2,0,2,3,0,0,1,2,1,0,0,0,1,2,0,0,2,2,2,0,2,2,0,1,0,3,3,1,2,2,2,1,2,0,3,2,1,0,0,0,0,0,0,3,1,2,1,0,2,0,1,0,2,0,2,2,0,2,0,1,3,1,2,1,1,0,2,0,1,0,1,0,0,2,1,0,3,2,1,0,0,3,0,1,1,0,0,1,1,1,2,0,0,3,0,0,1,3,2,1,0,2,1,2,0,1,0,3,1,1,1,2,0,2,0,1,2,0,1,0,0,0,0,0,3,2,1,0,0,1,1,2,2,0,1,1,1,1,0,2,1,1,0,1,1,0,0,2,3,1,3,0,3,1,2,1,0,2,1,1,2,3,0,1,0,2,0,2,0,1,1,1,3,0,2,0,2,0,0,0,1,0,1,2,3,0,0,0,2,1,2,1,0,1,3,2,1,0,2,1,0,2,0,2,2,3,0,1,0,0,2,0,0,0,0,1,1,0,1,0,1,1,2,0,3,1,0,1,0,0,0,0,0,0,1,2,2,0,1,3,0,3,1,3,1,0,0,1,1,0,1,0,1,1,0,0,3,0,0,1,2,0,1,0,1,0,2,2,3,0,1,0,1,1,2,3,0,1,1,1,3,2,0,3,1,1,1,3,1,0,0,0,0,0,0,0,1,1,0,1,0,1,0,0,3,0,1,2,1,2,0,0,0,1,2,0,0,1,1,1,0,0,3,0,1,0,1,1,2,1,1,0,1,1,3,0,0,0,1,0,0,0,2,1],[0,2,2,1,0,0,2,1,0,2,0,2,2,0,0,0,0,1,0,2,0,0,1,0,0,0,1,1,1,0,2,3,0,3,0,0,0,1,1,2,0,3,1,0,2,3,1,1,0,0,0,1,0,0,3,2,1,1,0,3,0,0,3,1,0,3,2,0,1,1,0,1,2,1,0,3,3,1,0,3,2,0,1,3,3,2,0,1,2,2,0,2,0,2,1,0,1,1,2,1,0,1,0,3,2,1,0,1,0,1,0,2,0,1,3,1,3,0,1,3,0,2,0,0,0,1,1,1,1,1,2,0,1,1,0,2,3,0,0,1,0,0,1,0,0,1,1,1,0,0,1,1,3,1,0,1,3,2,1,0,2,1,1,2,0,0,3,2,1,0,0,1,0,0,1,0,2,0,0,1,0,0,2,0,1,1,0,0,0,1,2,1,0,1,1,3,0,0,1,0,0,3,1,1,0,0,3,0,1,3,2,1,0,1,1,1,2,0,0,2,2,0,0,0,3,2,2,0,0,0,0,1,1,2,0,2,0,1,0,0,0,2,3,3,0,0,0,3,1,2,1,0,1,3,3,2,0,2,0,0,3,1,0,1,0,0,0,0,0,2,0,2,0,0,2,0,0,1,1,1,1,1,0,1,2,2,1,1,0,2,0,0,0,0,1,1,0,1,3,0,3,1,3,1,0,1,2,0,0,1,2,1,1,0,0,3,0,0,0,0,1,1,1,1,0,2,1,1,0,0,0,1,0,1,0,1,2,0,1,1,0,0,1,1,1,2,2,1,1,0,0,0,1,3,0,0,1,0,1,1,1,0,0,0,1,1,1,0,3,0,0,1,1,0,0,1,0,0,1,1,1,3,0,0,0,0,0,3,1,1,0,1,0,3,1,0,1,0,0,1,2,0,0],[1,2,1,1,0,0,3,0,0,2,0,1,2,0,0,0,0,0,0,2,0,0,0,3,1,0,2,1,1,2,0,1,1,0,0,0,1,1,2,2,0,0,2,0,1,2,1,0,0,1,0,0,1,1,3,0,1,0,1,2,0,1,2,0,0,2,2,0,1,1,0,0,2,0,0,1,0,1,0,1,2,1,0,0,2,1,1,1,2,2,0,2,0,0,3,2,1,0,0,0,0,0,1,3,0,0,0,1,0,0,0,0,0,1,1,0,2,0,0,3,0,2,2,0,0,1,1,1,0,0,0,0,1,1,1,2,2,0,1,1,1,0,0,1,0,0,0,0,0,0,0,0,3,1,0,0,2,2,0,2,2,2,0,1,0,1,3,1,0,1,0,1,1,0,0,3,1,0,0,0,0,0,0,1,2,3,0,0,1,1,1,0,0,1,0,3,1,0,0,3,0,1,1,0,1,0,2,2,0,3,3,0,1,0,0,1,1,0,0,1,1,0,0,0,3,1,2,0,1,0,0,2,1,1,0,0,0,0,0,1,0,0,1,3,0,0,0,2,0,3,1,0,1,3,0,2,0,2,0,1,1,1,1,0,1,0,0,0,0,2,1,2,0,0,0,0,0,0,0,0,3,0,0,2,1,0,1,0,0,0,0,0,0,0,1,0,1,1,3,0,2,1,2,1,0,0,2,0,0,0,1,0,0,0,0,2,0,1,1,0,1,1,1,0,0,1,0,1,1,0,0,0,0,0,2,0,1,0,1,3,0,0,0,1,1,2,1,0,0,1,0,0,1,2,0,0,1,1,0,0,0,0,0,1,0,1,0,1,2,1,0,1,1,0,0,0,1,0,1,0,0,3,0,0,0,1,1,2,0,0,0,0,1,3,0,0,0,1,0,1,0,0,0],[0,0,1,1,0,0,0,0,0,1,0,2,1,1,0,0,0,0,1,0,0,0,0,0,2,0,2,0,1,1,0,2,0,0,0,0,2,0,0,2,0,0,0,0,0,1,0,0,0,0,0,0,0,1,2,0,0,0,1,2,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,2,0,0,0,2,1,1,0,1,3,0,3,0,2,0,0,1,0,1,0,0,0,1,2,0,0,0,1,0,0,0,0,0,1,1,0,3,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,1,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,2,0,0,2,1,0,0,0,0,1,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,3,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,3,0,1,0,0,0,0,1,0,3,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,3,0,1,0,0,1,0,0,1,0,0,1,1,0,1,0,0,2,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,2,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,3,0,0,0,0,0,0,0,0,0,1,0,1,2,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,0,1,0,2,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,3,0,1,0,0,0,0,2,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,2,0,0,0,0,2,0,0,3,0,0,3,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,1,0,1,2,0,2,3,0,2,0,1,0,0,0,0,1,0,0,0,0,2,1,1,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,0,0,0,1,0,0,0,0,1,1,0,0,0,1,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,3,0,3,0,1,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,2,0,1,0,1,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,3,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,3,0,0,1,0,1,0,1,0,0],[1,2,1,2,1,0,1,0,1,1,0,2,1,0,0,0,2,0,1,0,1,1,2,0,1,0,2,1,2,2,0,1,1,2,1,1,0,1,0,3,0,3,1,1,1,3,3,1,0,0,0,0,1,1,2,0,1,1,0,2,0,2,0,0,0,2,2,1,1,3,0,1,2,1,0,3,1,0,0,1,2,0,1,1,3,1,1,2,2,2,1,1,0,2,1,2,1,1,3,0,1,2,1,1,1,1,0,1,0,1,0,1,1,3,2,1,3,1,1,3,0,0,1,0,0,1,1,1,1,0,2,0,3,0,1,1,3,0,0,1,0,1,1,0,0,0,1,1,0,1,1,0,2,1,0,1,1,3,1,1,1,1,0,1,0,2,1,1,1,2,1,2,0,1,1,1,1,0,1,1,0,1,0,1,1,1,0,1,1,1,3,0,1,2,0,3,1,0,1,0,0,3,2,0,2,0,2,0,1,3,2,1,0,0,2,0,3,0,2,2,3,0,1,0,2,3,3,0,0,1,1,2,2,2,1,1,0,1,0,0,0,2,2,3,0,1,0,2,2,1,1,0,1,1,3,2,1,2,0,1,1,1,3,0,1,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,3,1,0,1,1,1,1,1,0,1,1,1,1,1,2,2,1,1,2,0,3,2,2,1,1,0,1,0,1,1,1,1,1,1,1,3,0,1,0,0,2,1,2,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,1,0,1,3,1,2,3,2,0,1,0,1,0,1,2,0,0,1,1,1,0,1,1,0,1,1,1,0,0,2,2,0,1,0,3,2,0,1,1,2,2,2,2,1,2,1,3,1,2,1,2,0,1,1,3,1,0,1,1,2,1,2,1,1],[1,3,1,1,0,0,2,0,0,0,0,2,1,0,0,0,0,0,1,0,1,0,2,0,0,0,1,2,2,2,0,1,1,2,1,1,0,1,1,2,0,1,1,1,1,3,1,0,0,0,0,0,0,1,3,0,1,1,0,3,0,2,0,2,0,3,1,0,1,2,0,0,2,0,0,2,1,0,0,2,1,0,1,1,2,3,0,2,2,2,0,0,0,2,0,1,1,0,3,0,1,0,1,2,2,1,0,0,0,0,0,3,0,3,3,0,3,0,0,3,0,1,2,0,1,1,0,0,1,0,2,0,2,0,1,1,2,0,0,1,1,0,0,1,0,0,1,1,0,2,1,0,1,1,0,1,1,2,1,2,1,1,0,2,1,2,2,2,1,0,0,2,0,0,1,0,1,0,0,0,0,1,2,0,1,0,0,0,0,0,3,1,0,1,0,3,0,0,2,0,0,3,1,0,1,0,2,0,1,3,3,1,1,0,2,0,3,1,3,2,2,0,0,0,2,2,3,0,1,0,0,2,0,1,0,1,0,0,0,0,0,1,1,1,0,0,0,1,2,3,1,0,1,1,2,3,1,1,0,0,1,0,2,0,0,1,1,0,0,2,0,2,0,1,0,0,0,0,1,0,3,0,1,2,0,1,1,0,0,1,1,0,0,1,1,1,1,1,3,0,2,2,2,1,1,0,2,0,1,1,1,1,3,0,0,3,0,2,0,1,0,1,1,0,1,1,0,1,1,0,0,1,1,1,0,0,1,1,1,0,0,1,2,0,2,3,2,0,2,0,0,0,1,3,0,1,1,0,2,0,1,0,0,1,1,1,0,0,1,2,1,1,1,2,1,0,1,0,3,2,1,3,0,0,0,1,1,3,0,1,0,1,1,3,0,0,0,1,1,1,1,3,0],[1,3,1,1,0,1,2,0,0,0,1,2,1,0,1,0,1,0,1,0,1,0,2,0,1,0,1,2,1,2,1,3,1,1,0,1,0,1,1,2,0,1,2,1,2,3,1,0,0,0,0,0,1,1,3,0,1,0,1,3,0,2,0,2,0,3,3,1,0,1,0,0,2,1,0,2,2,1,0,2,1,0,1,1,3,3,0,2,2,2,1,1,0,3,0,1,1,0,3,0,1,1,1,3,2,1,0,0,0,1,1,3,1,3,3,0,3,0,0,3,0,2,2,0,1,1,1,1,1,0,2,0,2,1,1,1,2,0,0,1,1,0,0,1,0,0,1,0,1,2,1,0,1,1,0,1,3,3,0,0,1,1,0,2,1,1,2,2,2,1,1,2,3,1,1,0,1,0,0,0,0,1,2,0,1,0,0,0,0,1,3,2,0,2,0,3,1,0,1,1,0,3,2,1,1,0,2,0,1,3,3,1,1,1,2,0,3,0,3,2,3,0,0,0,2,2,2,0,1,0,1,2,1,2,0,1,0,1,0,1,0,1,2,3,0,0,0,1,1,3,0,1,1,1,2,2,1,1,0,0,1,1,2,1,1,0,1,0,0,2,1,2,0,1,0,0,0,0,1,0,3,1,1,2,1,1,1,0,0,1,1,0,1,0,1,1,1,1,3,0,3,2,2,2,1,1,2,1,1,1,1,1,3,0,0,3,0,3,0,1,1,2,1,0,1,2,0,1,1,0,0,1,2,1,0,1,1,1,1,0,1,1,3,0,3,3,2,1,1,0,0,0,1,3,0,0,1,0,2,0,1,0,0,1,1,1,0,2,1,2,0,1,1,2,1,1,1,0,3,2,1,2,0,1,0,2,1,3,0,1,0,1,1,3,1,0,0,1,1,1,1,3,0],[1,2,1,1,1,0,2,0,0,0,1,1,1,0,1,0,1,0,1,1,1,1,2,1,2,1,3,0,1,0,0,1,0,1,0,1,1,1,2,2,0,2,1,0,1,3,1,0,1,1,0,0,1,1,3,0,1,0,0,2,0,3,0,1,1,2,1,1,1,2,0,0,1,0,0,2,2,1,1,1,2,0,0,1,3,1,2,1,1,2,0,2,0,2,1,1,1,0,3,0,1,0,1,3,1,1,0,0,0,1,0,2,1,3,1,0,2,1,0,3,0,2,2,0,0,1,1,1,0,1,3,0,1,0,1,1,2,0,1,1,0,0,0,1,0,0,1,0,0,2,1,0,2,1,0,1,3,3,0,0,2,2,1,1,1,1,3,1,2,1,0,2,1,1,1,2,1,0,1,2,1,1,0,1,2,1,0,0,1,0,3,2,0,2,1,3,0,0,1,1,0,3,1,0,3,1,3,0,1,3,3,0,1,1,0,0,3,1,2,2,3,1,1,0,2,2,2,0,1,1,1,2,1,1,1,1,0,0,0,0,0,1,2,2,0,0,0,2,1,2,0,1,1,1,1,1,1,1,0,1,1,0,2,0,0,0,1,1,0,2,0,3,0,1,1,0,0,1,1,1,3,1,2,1,2,0,1,0,1,2,0,0,0,0,1,1,1,2,1,0,2,2,2,1,1,1,1,0,1,1,2,1,2,1,1,3,0,3,1,0,2,1,1,0,0,2,0,3,1,0,0,1,2,1,1,0,0,1,1,0,0,1,3,2,0,3,1,1,1,0,0,0,2,1,0,1,1,1,2,1,1,0,0,0,1,1,0,1,3,2,0,1,1,2,2,1,1,0,3,1,2,3,0,1,1,3,1,2,0,1,0,0,1,3,0,0,1,0,0,2,2,3,0],[0,3,1,0,0,0,1,0,0,1,1,2,1,0,0,0,0,0,1,0,1,0,0,0,0,0,2,0,1,1,0,1,0,0,0,0,0,0,0,1,0,2,0,0,0,2,0,0,1,0,0,0,1,0,3,2,1,0,0,2,0,2,0,0,1,1,1,0,1,1,0,0,0,0,0,3,0,0,1,0,2,0,0,0,2,1,0,0,1,1,0,3,0,2,1,1,1,0,0,0,0,0,1,2,1,1,0,0,0,0,0,0,0,1,1,0,2,0,0,3,0,0,1,0,0,1,1,0,1,0,1,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,3,1,0,0,1,2,0,0,1,0,0,1,0,1,0,1,1,0,0,2,0,1,0,2,0,0,1,1,0,0,0,0,2,0,0,0,1,0,1,0,0,0,0,1,0,0,0,1,0,3,0,0,0,0,2,0,1,1,3,0,0,1,0,0,0,0,2,2,1,0,0,0,2,0,1,0,0,1,0,2,2,2,0,0,0,0,0,0,0,0,1,2,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,2,1,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,1,1,0,0,2,0,2,0,1,0,0,0,0,0,1,1,1,0,1,1,0,3,0,1,0,0,0,0,0,0,0,2,0,3,1,0,0,0,0,1,1,0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,0,1,0,3,0,0,2,0,0,0,2,1,1,0,0,0,0,0,2,0,0,0,0,0,0,3,0,0],[1,2,1,1,0,1,2,0,0,2,1,2,1,1,1,1,2,0,1,1,0,1,1,0,3,0,1,1,1,1,1,1,2,1,1,1,1,0,3,3,0,1,1,0,1,1,0,1,1,2,0,1,1,1,3,1,2,1,1,3,0,2,0,1,1,3,1,0,1,3,0,1,0,2,0,3,1,3,0,2,1,0,0,1,2,1,1,1,1,0,0,3,0,2,1,1,1,1,1,1,1,0,1,3,2,1,0,1,0,1,0,1,0,1,3,1,3,1,1,3,0,1,2,0,0,1,2,1,1,1,1,0,2,0,1,2,2,0,2,0,1,0,2,1,0,1,0,1,1,1,0,0,3,1,0,1,3,3,2,2,2,1,1,3,1,1,3,3,2,1,1,2,2,1,0,2,1,1,1,3,0,0,0,0,2,1,0,1,0,1,2,0,0,1,2,2,2,0,1,2,0,3,1,3,2,1,2,3,1,3,3,1,1,3,1,1,2,0,1,1,2,0,0,0,0,1,3,0,1,0,0,3,1,2,0,2,0,1,0,1,0,0,2,3,0,1,1,1,2,3,2,0,1,2,0,1,1,2,0,1,1,1,2,1,1,1,1,1,0,2,0,1,1,1,1,0,0,0,1,1,1,1,1,2,2,2,2,1,1,2,0,1,0,1,2,2,2,0,3,0,2,1,1,1,1,1,2,0,1,1,3,1,1,0,1,3,0,2,1,1,1,2,0,0,1,2,1,3,0,0,0,1,0,2,3,1,1,1,1,3,0,1,2,2,0,2,1,0,2,0,1,0,1,1,0,1,2,0,1,1,0,2,0,0,1,1,1,1,3,2,1,1,1,1,2,0,2,0,2,0,1,3,1,1,1,2,1,3,1,0,0,1,1,3,1,0,1,1,1,1,1,1,2],[0,3,1,0,0,0,1,0,0,1,0,1,2,0,0,0,0,1,1,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,2,0,1,3,2,0,1,2,0,1,1,0,0,0,0,0,0,1,0,3,1,0,0,0,3,0,1,0,0,0,3,2,0,0,1,0,0,1,0,0,2,3,0,0,1,2,0,1,0,2,0,1,1,1,2,0,1,0,2,0,0,0,0,3,0,0,2,0,0,2,0,0,0,0,0,0,2,0,2,3,0,2,0,0,3,0,1,1,0,0,1,0,0,1,0,1,0,2,0,0,1,2,0,0,1,0,0,0,1,0,0,0,1,0,1,0,0,1,1,0,0,3,2,0,0,2,0,0,2,0,0,3,1,2,0,0,1,0,0,0,1,0,1,0,0,0,1,2,1,0,0,0,0,0,0,2,0,0,0,1,3,0,0,2,0,0,3,0,0,0,0,2,0,1,0,0,0,0,0,3,0,2,0,1,3,2,0,0,0,1,3,2,0,0,0,1,1,0,1,0,1,0,1,0,0,0,1,1,3,0,0,1,0,2,1,1,0,0,0,1,1,0,0,0,0,0,0,2,0,0,1,0,0,1,0,0,1,0,0,0,0,0,1,1,0,1,0,1,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,3,0,3,1,2,1,0,0,1,0,1,0,0,0,2,0,0,3,0,2,0,1,2,0,0,0,0,1,0,1,0,0,0,0,2,2,3,0,0,1,1,1,0,1,2,0,1,2,0,0,1,0,0,0,1,3,0,1,0,0,1,0,1,0,0,0,0,0,0,0,2,0,1,1,1,1,0,0,1,0,1,0,0,0,0,0,1,1,1,2,1,0,0,0,1,0,0,0,0,0,0,0,2,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>PHQ1<\\/th>\\n      <th>PHQ2<\\/th>\\n      <th>PHQ3<\\/th>\\n      <th>PHQ4<\\/th>\\n      <th>PHQ5<\\/th>\\n      <th>PHQ6<\\/th>\\n      <th>PHQ7<\\/th>\\n      <th>PHQ8<\\/th>\\n      <th>PHQ9<\\/th>\\n      <th>GAD1<\\/th>\\n      <th>GAD2<\\/th>\\n      <th>GAD3<\\/th>\\n      <th>GAD4<\\/th>\\n      <th>GAD5<\\/th>\\n      <th>GAD6<\\/th>\\n      <th>GAD7<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"PHQ1\",\"targets\":1},{\"name\":\"PHQ2\",\"targets\":2},{\"name\":\"PHQ3\",\"targets\":3},{\"name\":\"PHQ4\",\"targets\":4},{\"name\":\"PHQ5\",\"targets\":5},{\"name\":\"PHQ6\",\"targets\":6},{\"name\":\"PHQ7\",\"targets\":7},{\"name\":\"PHQ8\",\"targets\":8},{\"name\":\"PHQ9\",\"targets\":9},{\"name\":\"GAD1\",\"targets\":10},{\"name\":\"GAD2\",\"targets\":11},{\"name\":\"GAD3\",\"targets\":12},{\"name\":\"GAD4\",\"targets\":13},{\"name\":\"GAD5\",\"targets\":14},{\"name\":\"GAD6\",\"targets\":15},{\"name\":\"GAD7\",\"targets\":16}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n::: panel-tabset\n### Model 1: EBICglasso\n\nModel 1 — The depression and anxiety symptom networks were estimated as Gaussian graphical models (GGM) separately at each wave using graphical LASSO regularization with EBIC.\nThe package is `bootnet::estimateNetwork` with \"EBICglasso\".\nThis is same as using `qgraph::EBICglasso()`.\nThe default setting of this function is converting input data into polychoric correlation matrix.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Visualize strength centrality for wave 1 and 2\"}\nlibrary(bootnet)\nlibrary(qgraph)\n\nmycolors = c(\"#4682B4\", \"#B4464B\", \"#752021\",  \n             \"#1B9E77\", \"#66A61E\", \"#D95F02\", \"#7570B3\",\n             \"#E7298A\", \"#E75981\", \"#B4AF46\", \"#B4726A\")\n\n##Estimate GGM networks\nnetwork1 <- estimateNetwork(time1data, default=\"EBICglasso\")\nnetwork2 <- estimateNetwork(time2data, default=\"EBICglasso\")\nlayout(t(1:1))\ncentw1w2 <- centralityPlot(list(Wave_1 = network1, Wave_2 = network2), \n                           labels=labels_time1and2data, verbose = FALSE, \n                           print = F) \ncentw1w2 + scale_color_manual(values = mycolors)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Visualize network structure for wave 1 and 2\"}\nL <- averageLayout(network1, network2)\n#Plot networks with average layout and edges comparable in weight\nmaxIsing<-max(c(network1$graph, network2$graph))\nlayout(t(1:2))\nnetwork1plot_average <- qgraph(network1$graph, layout=L, title=\"Wave 1 average layout\", maximum=maxIsing, groups = groups_time1and2data)\nnetwork2plot_average <- qgraph(network2$graph, layout=L, title=\"Wave 2 average layout\", maximum=maxIsing, groups = groups_time1and2data)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=864}\n:::\n:::\n\n\n\n\n### Model 2: FIML with prune\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Esimate the network with psychonetrics\"}\nlibrary(psychonetrics)\nnetwork1_mod2 <- ggm(time1data, estimator = \"FIML\", standardize = \"z\") %>% \n  prune(alpha = .01, recursive = FALSE) \nnetwork2_mod2 <- ggm(time2data, estimator = \"FIML\", standardize = \"z\") %>% \n  prune(alpha = .01, recursive = FALSE) \nnetwork1_mod2_graph <- getmatrix(network1_mod2, \"omega\")\nnetwork2_mod2_graph <- getmatrix(network2_mod2, \"omega\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Visualize strength centrality for wave 1 and 2\"}\ncentw1w2_mod2 <- centralityPlot(list(Wave_1 = network1_mod2_graph, Wave_2 = network2_mod2_graph), \n                           labels=labels_time1and2data, verbose = FALSE, \n                           print = F) \ncentw1w2_mod2 + scale_color_manual(values = mycolors)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Visualize network structure for wave 1 and 2\"}\nlayout(t(1:2))\nmaxIsing2<-max(c(network1_mod2_graph, network2_mod2_graph))\nnetwork1_mod2_plot_average <- qgraph(network1_mod2_graph, \n                                     layout=L, \n                                     title=\"Wave 1 average layout\", \n                                     labels=labels_time1and2data,\n                                     groups = groups_time1and2data,\n                                     maximum=maxIsing2)\nnetwork2_mod2_plot_average <- qgraph(network2_mod2_graph, \n                                     layout=L, \n                                     title=\"Wave 2 average layout\", \n                                     labels=labels_time1and2data,\n                                     groups = groups_time1and2data,\n                                     maximum=maxIsing2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=864}\n:::\n:::\n\n\n\n:::\n\n## Results\n\n## Discussion\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}